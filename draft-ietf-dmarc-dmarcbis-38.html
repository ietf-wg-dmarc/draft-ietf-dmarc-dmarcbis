<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Domain-based Message Authentication, Reporting, and Conformance (DMARC)</title>
<meta content="Todd M. Herr" name="author">
<meta content="John Levine" name="author">
<meta content="
       This document describes the Domain-based Message Authentication,
Reporting, and Conformance (DMARC) protocol. 
       DMARC permits the owner of an email's  Author Domain  to enable
validation of the domain's use, to indicate the  Domain Owner's 
or  Public Suffix Operator's  message handling
preference regarding failed validation, and to request reports about the
use of the domain name.  Mail receiving organizations can use this information
when evaluating handling choices for incoming mail. 
       This document obsoletes RFCs 7489 and 9091. 
    " name="description">
<meta content="xml2rfc 3.24.0" name="generator">
<meta content="draft-ietf-dmarc-dmarcbis-38" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.24.0
    Python 3.9.6
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 58.0.4
    wcwidth 0.2.13
-->
<link href="draft-ietf-dmarc-dmarcbis-38.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}
.xref {
  overflow-wrap: normal;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.refSubseries {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: upper-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code, dt tt, dt code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DMARCbis</td>
<td class="right">January 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Herr (ed) &amp; Levine (ed)</td>
<td class="center">Expires 11 July 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">DMARC</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-dmarc-dmarcbis-38</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc7489" class="eref">7489</a>, <a href="https://www.rfc-editor.org/rfc/rfc9091" class="eref">9091</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-01-07" class="published">7 January 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-07-11">11 July 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Herr (ed)</div>
<div class="org">Valimail</div>
</div>
<div class="author">
      <div class="author-name">J. Levine (ed)</div>
<div class="org">Standcore LLC</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Domain-based Message Authentication, Reporting, and Conformance (DMARC)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the Domain-based Message Authentication,
Reporting, and Conformance (DMARC) protocol.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">DMARC permits the owner of an email's <a href="#author-domain">Author Domain</a> to enable
validation of the domain's use, to indicate the <a href="#domain-owner">Domain Owner's</a>
or <a href="#public-suffix-operator">Public Suffix Operator's</a> message handling
preference regarding failed validation, and to request reports about the
use of the domain name.  Mail receiving organizations can use this information
when evaluating handling choices for incoming mail.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document obsoletes RFCs 7489 and 9091.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 11 July 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-requirements" class="internal xref">Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-high-level-goals" class="internal xref">High-Level Goals</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-anti-phishing" class="internal xref">Anti-Phishing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-scalability" class="internal xref">Scalability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-out-of-scope" class="internal xref">Out of Scope</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-terminology-and-definitions" class="internal xref">Terminology and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-conventions-used-in-this-do" class="internal xref">Conventions Used in This Document</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-definitions" class="internal xref">Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-authenticated-identifiers" class="internal xref">Authenticated Identifiers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-author-domain" class="internal xref">Author Domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="auto internal xref">3.2.3</a>.  <a href="#name-dkim-signing-domain" class="internal xref">DKIM Signing Domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="auto internal xref">3.2.4</a>.  <a href="#name-spf-domain" class="internal xref">SPF Domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.5">
                    <p id="section-toc.1-1.3.2.2.2.5.1"><a href="#section-3.2.5" class="auto internal xref">3.2.5</a>.  <a href="#name-dmarc-policy-domain" class="internal xref">DMARC Policy Domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.6">
                    <p id="section-toc.1-1.3.2.2.2.6.1"><a href="#section-3.2.6" class="auto internal xref">3.2.6</a>.  <a href="#name-dmarc-policy-record" class="internal xref">DMARC Policy Record</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.7">
                    <p id="section-toc.1-1.3.2.2.2.7.1"><a href="#section-3.2.7" class="auto internal xref">3.2.7</a>.  <a href="#name-domain-owner" class="internal xref">Domain Owner</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.8">
                    <p id="section-toc.1-1.3.2.2.2.8.1"><a href="#section-3.2.8" class="auto internal xref">3.2.8</a>.  <a href="#name-domain-owner-assessment-pol" class="internal xref">Domain Owner Assessment Policy</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.9">
                    <p id="section-toc.1-1.3.2.2.2.9.1"><a href="#section-3.2.9" class="auto internal xref">3.2.9</a>.  <a href="#name-enforcement" class="internal xref">Enforcement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.10">
                    <p id="section-toc.1-1.3.2.2.2.10.1"><a href="#section-3.2.10" class="auto internal xref">3.2.10</a>. <a href="#name-identifier-alignment" class="internal xref">Identifier Alignment</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.11">
                    <p id="section-toc.1-1.3.2.2.2.11.1"><a href="#section-3.2.11" class="auto internal xref">3.2.11</a>. <a href="#name-mail-receiver" class="internal xref">Mail Receiver</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.12">
                    <p id="section-toc.1-1.3.2.2.2.12.1"><a href="#section-3.2.12" class="auto internal xref">3.2.12</a>. <a href="#name-monitoring-mode" class="internal xref">Monitoring Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.13">
                    <p id="section-toc.1-1.3.2.2.2.13.1"><a href="#section-3.2.13" class="auto internal xref">3.2.13</a>. <a href="#name-non-existent-domains" class="internal xref">Non-existent Domains</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.14">
                    <p id="section-toc.1-1.3.2.2.2.14.1"><a href="#section-3.2.14" class="auto internal xref">3.2.14</a>. <a href="#name-organizational-domain" class="internal xref">Organizational Domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.15">
                    <p id="section-toc.1-1.3.2.2.2.15.1"><a href="#section-3.2.15" class="auto internal xref">3.2.15</a>. <a href="#name-public-suffix-domain-psd" class="internal xref">Public Suffix Domain (PSD)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.16">
                    <p id="section-toc.1-1.3.2.2.2.16.1"><a href="#section-3.2.16" class="auto internal xref">3.2.16</a>. <a href="#name-public-suffix-operator-pso" class="internal xref">Public Suffix Operator (PSO)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.17">
                    <p id="section-toc.1-1.3.2.2.2.17.1"><a href="#section-3.2.17" class="auto internal xref">3.2.17</a>. <a href="#name-pso-controlled-domain-names" class="internal xref">PSO Controlled Domain Names</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.18">
                    <p id="section-toc.1-1.3.2.2.2.18.1"><a href="#section-3.2.18" class="auto internal xref">3.2.18</a>. <a href="#name-report-consumer" class="internal xref">Report Consumer</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-overview-and-key-concepts" class="internal xref">Overview and Key Concepts</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-dmarc-basics" class="internal xref">DMARC Basics</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-use-of-rfc5322from" class="internal xref">Use of RFC5322.From</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-authentication-mechanisms" class="internal xref">Authentication Mechanisms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-identifier-alignment-explai" class="internal xref">Identifier Alignment Explained</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-dkim-authenticated-identifi" class="internal xref">DKIM-Authenticated Identifiers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-spf-authenticated-identifie" class="internal xref">SPF-Authenticated Identifiers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="auto internal xref">4.4.3</a>.  <a href="#name-alignment-and-extension-tec" class="internal xref">Alignment and Extension Technologies</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-dmarc-policy-record-explain" class="internal xref">DMARC Policy Record Explained</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-dmarc-reporting-uris" class="internal xref">DMARC Reporting URIs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-dmarc-policy-record-format" class="internal xref">DMARC Policy Record Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.8">
                <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-formal-definition" class="internal xref">Formal Definition</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.9">
                <p id="section-toc.1-1.4.2.9.1"><a href="#section-4.9" class="auto internal xref">4.9</a>.  <a href="#name-flow-diagram" class="internal xref">Flow Diagram</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10">
                <p id="section-toc.1-1.4.2.10.1"><a href="#section-4.10" class="auto internal xref">4.10</a>. <a href="#name-dns-tree-walk" class="internal xref">DNS Tree Walk</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10.2.1">
                    <p id="section-toc.1-1.4.2.10.2.1.1"><a href="#section-4.10.1" class="auto internal xref">4.10.1</a>.  <a href="#name-dmarc-policy-discovery" class="internal xref">DMARC Policy Discovery</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.10.2.2">
                    <p id="section-toc.1-1.4.2.10.2.2.1"><a href="#section-4.10.2" class="auto internal xref">4.10.2</a>.  <a href="#name-identifier-alignment-evalua" class="internal xref">Identifier Alignment Evaluation</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-dmarc-participation" class="internal xref">DMARC Participation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-domain-owner-actions" class="internal xref">Domain Owner Actions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-publish-an-spf-record-for-a" class="internal xref">Publish an SPF Record for an Aligned Domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-configure-sending-system-fo" class="internal xref">Configure Sending System for DKIM Signing Using an Aligned Domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-set-up-a-mailbox-to-receive" class="internal xref">Set Up a Mailbox to Receive Aggregate Reports</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="auto internal xref">5.1.4</a>.  <a href="#name-publish-a-dmarc-policy-reco" class="internal xref">Publish a DMARC Policy Record for the Author Domain and Organizational Domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.5">
                    <p id="section-toc.1-1.5.2.1.2.5.1"><a href="#section-5.1.5" class="auto internal xref">5.1.5</a>.  <a href="#name-collect-and-analyze-reports" class="internal xref">Collect and Analyze Reports</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.6">
                    <p id="section-toc.1-1.5.2.1.2.6.1"><a href="#section-5.1.6" class="auto internal xref">5.1.6</a>.  <a href="#name-remediate-unaligned-or-unau" class="internal xref">Remediate Unaligned or Unauthenticated Mail Streams</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.7">
                    <p id="section-toc.1-1.5.2.1.2.7.1"><a href="#section-5.1.7" class="auto internal xref">5.1.7</a>.  <a href="#name-decide-whether-to-update-do" class="internal xref">Decide Whether to Update Domain Owner Assessment Policy to Enforcement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.8">
                    <p id="section-toc.1-1.5.2.1.2.8.1"><a href="#section-5.1.8" class="auto internal xref">5.1.8</a>.  <a href="#name-a-note-on-large-complex-org" class="internal xref">A Note on Large, Complex Organizations and Decentralized DNS Management</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-pso-actions" class="internal xref">PSO Actions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-mail-receiver-actions" class="internal xref">Mail Receiver Actions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-extract-author-domain" class="internal xref">Extract Author Domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-determine-if-the-dmarc-mech" class="internal xref">Determine If The DMARC Mechanism Applies</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="auto internal xref">5.3.3</a>.  <a href="#name-determine-if-authenticated-" class="internal xref">Determine If Authenticated Identifiers Exist</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4">
                    <p id="section-toc.1-1.5.2.3.2.4.1"><a href="#section-5.3.4" class="auto internal xref">5.3.4</a>.  <a href="#name-conduct-identifier-alignmen" class="internal xref">Conduct Identifier Alignment Checks If Necessary</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.5">
                    <p id="section-toc.1-1.5.2.3.2.5.1"><a href="#section-5.3.5" class="auto internal xref">5.3.5</a>.  <a href="#name-determine-dmarc-pass-or-fai" class="internal xref">Determine DMARC "Pass" or "Fail"</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.6">
                    <p id="section-toc.1-1.5.2.3.2.6.1"><a href="#section-5.3.6" class="auto internal xref">5.3.6</a>.  <a href="#name-apply-policy-if-appropriate" class="internal xref">Apply Policy If Appropriate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.7">
                    <p id="section-toc.1-1.5.2.3.2.7.1"><a href="#section-5.3.7" class="auto internal xref">5.3.7</a>.  <a href="#name-store-results-of-dmarc-proc" class="internal xref">Store Results of DMARC Processing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.8">
                    <p id="section-toc.1-1.5.2.3.2.8.1"><a href="#section-5.3.8" class="auto internal xref">5.3.8</a>.  <a href="#name-send-aggregate-reports" class="internal xref">Send Aggregate Reports</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.9">
                    <p id="section-toc.1-1.5.2.3.2.9.1"><a href="#section-5.3.9" class="auto internal xref">5.3.9</a>.  <a href="#name-optionally-send-failure-rep" class="internal xref">Optionally Send Failure Reports</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-policy-enforcement-consider" class="internal xref">Policy Enforcement Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-dmarc-feedback" class="internal xref">DMARC Feedback</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-other-topics" class="internal xref">Other Topics</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-issues-specific-to-spf" class="internal xref">Issues Specific to SPF</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-rejecting-messages" class="internal xref">Rejecting Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-interoperability-issues" class="internal xref">Interoperability Issues</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-interoperability-considerat" class="internal xref">Interoperability Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-conformance-requirements-fo" class="internal xref">Conformance Requirements for Full DMARC Participation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-authentication-results-meth" class="internal xref">Authentication-Results Method Registry Update</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-authentication-results-resu" class="internal xref">Authentication-Results Result Registry Update</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-dmarc-tag-registry" class="internal xref">DMARC Tag Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-dmarc-report-format-registr" class="internal xref">DMARC Report Format Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-underscored-and-globally-sc" class="internal xref">Underscored and Globally Scoped DNS Node Names Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-aggregate-report-considerat" class="internal xref">Aggregate Report Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-failure-report-consideratio" class="internal xref">Failure Report Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-authentication-methods" class="internal xref">Authentication Methods</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-attacks-on-reporting-uris" class="internal xref">Attacks on Reporting URIs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-dns-security" class="internal xref">DNS Security</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-display-name-attacks" class="internal xref">Display Name Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="auto internal xref">11.5</a>.  <a href="#name-denial-of-dmarc-processing-" class="internal xref">Denial of DMARC Processing Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.6">
                <p id="section-toc.1-1.11.2.6.1"><a href="#section-11.6" class="auto internal xref">11.6</a>.  <a href="#name-external-reporting-addresse" class="internal xref">External Reporting Addresses</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.7">
                <p id="section-toc.1-1.11.2.7.1"><a href="#section-11.7" class="auto internal xref">11.7</a>.  <a href="#name-secure-protocols" class="internal xref">Secure Protocols</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.8">
                <p id="section-toc.1-1.11.2.8.1"><a href="#section-11.8" class="auto internal xref">11.8</a>.  <a href="#name-relaxed-alignment-considera" class="internal xref">Relaxed Alignment Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-technology-considerations" class="internal xref">Technology Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-s-mime" class="internal xref">S/MIME</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-method-exclusion" class="internal xref">Method Exclusion</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-sender-header-field" class="internal xref">Sender Header Field</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-domain-existence-test" class="internal xref">Domain Existence Test</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-organizational-domain-disco" class="internal xref">Organizational Domain Discovery Issues</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.6">
                <p id="section-toc.1-1.13.2.6.1"><a href="#appendix-A.6" class="auto internal xref">A.6</a>.  <a href="#name-removal-of-the-pct-tag" class="internal xref">Removal of the "pct" Tag</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-identifier-alignment-exampl" class="internal xref">Identifier Alignment Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1.2.1">
                    <p id="section-toc.1-1.14.2.1.2.1.1"><a href="#appendix-B.1.1" class="auto internal xref">B.1.1</a>.  <a href="#name-spf" class="internal xref">SPF</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1.2.2">
                    <p id="section-toc.1-1.14.2.1.2.2.1"><a href="#appendix-B.1.2" class="auto internal xref">B.1.2</a>.  <a href="#name-dkim" class="internal xref">DKIM</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-domain-owner-example" class="internal xref">Domain Owner Example</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.1">
                    <p id="section-toc.1-1.14.2.2.2.1.1"><a href="#appendix-B.2.1" class="auto internal xref">B.2.1</a>.  <a href="#name-entire-domain-monitoring-mo" class="internal xref">Entire Domain, Monitoring Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.2">
                    <p id="section-toc.1-1.14.2.2.2.2.1"><a href="#appendix-B.2.2" class="auto internal xref">B.2.2</a>.  <a href="#name-entire-domain-monitoring-mod" class="internal xref">Entire Domain, Monitoring Mode, Per-Message Failure Reports</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.3">
                    <p id="section-toc.1-1.14.2.2.2.3.1"><a href="#appendix-B.2.3" class="auto internal xref">B.2.3</a>.  <a href="#name-per-message-failure-reports" class="internal xref">Per-Message Failure Reports Directed to Third Party</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.4">
                    <p id="section-toc.1-1.14.2.2.2.4.1"><a href="#appendix-B.2.4" class="auto internal xref">B.2.4</a>.  <a href="#name-overriding-destination-addr" class="internal xref">Overriding destination addresses</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2.2.5">
                    <p id="section-toc.1-1.14.2.2.2.5.1"><a href="#appendix-B.2.5" class="auto internal xref">B.2.5</a>.  <a href="#name-subdomain-testing-and-multi" class="internal xref">Subdomain, Testing, and Multiple Aggregate Report URIs</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-mail-receiver-example" class="internal xref">Mail Receiver Example</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3.2.1">
                    <p id="section-toc.1-1.14.2.3.2.1.1"><a href="#appendix-B.3.1" class="auto internal xref">B.3.1</a>.  <a href="#name-smtp-session-example" class="internal xref">SMTP Session Example</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.  <a href="#name-organizational-and-policy-d" class="internal xref">Organizational and Policy Domain Tree Walk Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4.2.1">
                    <p id="section-toc.1-1.14.2.4.2.1.1"><a href="#appendix-B.4.1" class="auto internal xref">B.4.1</a>.  <a href="#name-simple-organizational-and-p" class="internal xref">Simple Organizational and Policy Example</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4.2.2">
                    <p id="section-toc.1-1.14.2.4.2.2.1"><a href="#appendix-B.4.2" class="auto internal xref">B.4.2</a>.  <a href="#name-deep-tree-walk-example" class="internal xref">Deep Tree Walk Example</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4.2.3">
                    <p id="section-toc.1-1.14.2.4.2.3.1"><a href="#appendix-B.4.3" class="auto internal xref">B.4.3</a>.  <a href="#name-example-with-a-psd-dmarc-po" class="internal xref">Example with a PSD DMARC Policy Record</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#appendix-B.5" class="auto internal xref">B.5</a>.  <a href="#name-utilization-of-aggregate-fe" class="internal xref">Utilization of Aggregate Feedback: Example</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-changes-from-rfc-7489" class="internal xref">Changes from RFC 7489</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-informational-vs-standards-" class="internal xref">Informational vs. Standards Track</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-changes-to-terminology-and-" class="internal xref">Changes to Terminology and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2.2.1">
                    <p id="section-toc.1-1.15.2.2.2.1.1"><a href="#appendix-C.2.1" class="auto internal xref">C.2.1</a>.  <a href="#name-terms-added" class="internal xref">Terms Added</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2.2.2">
                    <p id="section-toc.1-1.15.2.2.2.2.1"><a href="#appendix-C.2.2" class="auto internal xref">C.2.2</a>.  <a href="#name-definitions-updated" class="internal xref">Definitions Updated</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-policy-discovery-and-organi" class="internal xref">Policy Discovery and Organizational Domain Determination</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#appendix-C.4" class="auto internal xref">C.4</a>.  <a href="#name-reporting" class="internal xref">Reporting</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#appendix-C.5" class="auto internal xref">C.5</a>.  <a href="#name-tags" class="internal xref">Tags</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5.2.1">
                    <p id="section-toc.1-1.15.2.5.2.1.1"><a href="#appendix-C.5.1" class="auto internal xref">C.5.1</a>.  <a href="#name-tags-added" class="internal xref">Tags Added</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5.2.2">
                    <p id="section-toc.1-1.15.2.5.2.2.1"><a href="#appendix-C.5.2" class="auto internal xref">C.5.2</a>.  <a href="#name-tags-removed" class="internal xref">Tags Removed</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6">
                <p id="section-toc.1-1.15.2.6.1"><a href="#appendix-C.6" class="auto internal xref">C.6</a>.  <a href="#name-expansion-of-domain-owner-a" class="internal xref">Expansion of Domain Owner Actions Section</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.7">
                <p id="section-toc.1-1.15.2.7.1"><a href="#appendix-C.7" class="auto internal xref">C.7</a>.  <a href="#name-report-generator-recommenda" class="internal xref">Report Generator Recommendations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.8">
                <p id="section-toc.1-1.15.2.8.1"><a href="#appendix-C.8" class="auto internal xref">C.8</a>.  <a href="#name-removal-of-rfc-7489-appendi" class="internal xref">Removal of RFC 7489 Appendix A.5</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9">
                <p id="section-toc.1-1.15.2.9.1"><a href="#appendix-C.9" class="auto internal xref">C.9</a>.  <a href="#name-rfc-7489-errata-summary" class="internal xref">RFC 7489 Errata Summary</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.1">
                    <p id="section-toc.1-1.15.2.9.2.1.1"><a href="#appendix-C.9.1" class="auto internal xref">C.9.1</a>.  <a href="#name-rfc-errata-erratum-id-5365-" class="internal xref">RFC Errata, Erratum ID 5365, RFC 7489, Section 7.2.1.1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.2">
                    <p id="section-toc.1-1.15.2.9.2.2.1"><a href="#appendix-C.9.2" class="auto internal xref">C.9.2</a>.  <a href="#name-rfc-errata-erratum-id-5371-" class="internal xref">RFC Errata, Erratum ID 5371, RFC 7489, Section 7.2.1.1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.3">
                    <p id="section-toc.1-1.15.2.9.2.3.1"><a href="#appendix-C.9.3" class="auto internal xref">C.9.3</a>.  <a href="#name-rfc-errata-erratum-id-5440-" class="internal xref">RFC Errata, Erratum ID 5440, RFC 7489, Sections 7.1, B.2.1, B.2.3, and B.2.4</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.4">
                    <p id="section-toc.1-1.15.2.9.2.4.1"><a href="#appendix-C.9.4" class="auto internal xref">C.9.4</a>.  <a href="#name-rfc-errata-erratum-id-6439-" class="internal xref">RFC Errata, Erratum ID 6439, RFC 7489, Section 7.1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.5">
                    <p id="section-toc.1-1.15.2.9.2.5.1"><a href="#appendix-C.9.5" class="auto internal xref">C.9.5</a>.  <a href="#name-rfc-errata-erratum-id-5221-" class="internal xref">RFC Errata, Erratum ID 5221, RFC 7489, Appendix C</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.6">
                    <p id="section-toc.1-1.15.2.9.2.6.1"><a href="#appendix-C.9.6" class="auto internal xref">C.9.6</a>.  <a href="#name-rfc-errata-erratum-id-5229-" class="internal xref">RFC Errata, Erratum ID 5229, RFC 7489, Appendix C</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.7">
                    <p id="section-toc.1-1.15.2.9.2.7.1"><a href="#appendix-C.9.7" class="auto internal xref">C.9.7</a>.  <a href="#name-rfc-errata-erratum-5495-rfc" class="internal xref">RFC Errata, Erratum 5495, RFC 7489, Section 6.6.3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.8">
                    <p id="section-toc.1-1.15.2.9.2.8.1"><a href="#appendix-C.9.8" class="auto internal xref">C.9.8</a>.  <a href="#name-rfc-errata-erratum-id-6485-" class="internal xref">RFC Errata, Erratum ID 6485, RFC 7489, Section 7.2.1.1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.9">
                    <p id="section-toc.1-1.15.2.9.2.9.1"><a href="#appendix-C.9.9" class="auto internal xref">C.9.9</a>.  <a href="#name-rfc-errata-erratum-id-6729-" class="internal xref">RFC Errata, Erratum ID 6729, RFC 7489, Section 3.2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.10">
                    <p id="section-toc.1-1.15.2.9.2.10.1"><a href="#appendix-C.9.10" class="auto internal xref">C.9.10</a>. <a href="#name-rfc-errata-erratum-id-7099-" class="internal xref">RFC Errata, Erratum ID 7099, RFC 7489, Section 7.2.1.1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.11">
                    <p id="section-toc.1-1.15.2.9.2.11.1"><a href="#appendix-C.9.11" class="auto internal xref">C.9.11</a>. <a href="#name-rfc-errata-erratum-id-7100-" class="internal xref">RFC Errata, Erratum ID 7100, RFC 7489, Section 7.2.1.1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.12">
                    <p id="section-toc.1-1.15.2.9.2.12.1"><a href="#appendix-C.9.12" class="auto internal xref">C.9.12</a>. <a href="#name-rfc-errata-erratum-id-7835-" class="internal xref">RFC Errata, Erratum ID 7835, RFC 7489, Section 6.6.3</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.13">
                    <p id="section-toc.1-1.15.2.9.2.13.1"><a href="#appendix-C.9.13" class="auto internal xref">C.9.13</a>. <a href="#name-rfc-errata-erratum-id-7865-" class="internal xref">RFC Errata, Erratum ID 7865, RFC 7489, Appendix C</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.14">
                    <p id="section-toc.1-1.15.2.9.2.14.1"><a href="#appendix-C.9.14" class="auto internal xref">C.9.14</a>. <a href="#name-rfc-errata-erratum-id-5151-" class="internal xref">RFC Errata, Erratum ID 5151, RFC 7489, Section 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.9.2.15">
                    <p id="section-toc.1-1.15.2.9.2.15.1"><a href="#appendix-C.9.15" class="auto internal xref">C.9.15</a>. <a href="#name-rfc-errata-erratum-id-5774-" class="internal xref">RFC Errata, Erratum ID 5774, RFC 7489, Appendix C</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.10">
                <p id="section-toc.1-1.15.2.10.1"><a href="#appendix-C.10" class="auto internal xref">C.10</a>. <a href="#name-general-editing-and-formatt" class="internal xref">General Editing and Formatting</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-acknowledgements-rfc-7489" class="internal xref">Acknowledgements - RFC 7489</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">RFC EDITOR: PLEASE REMOVE THE FOLLOWING PARAGRAPH BEFORE PUBLISHING:
The source for this draft is maintained on GitHub at:
<a href="https://github.com/ietf-wg-dmarc/draft-ietf-dmarc-dmarcbis">https://github.com/ietf-wg-dmarc/draft-ietf-dmarc-dmarcbis</a><a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Abusive email often includes unauthorized and deceptive use of a
domain name in the "From" header field defined in section 3.6.2 of <span>[<a href="#RFC5322" class="cite xref">RFC5322</a>]</span>
and referred to as RFC5322.From. The domain typically belongs to an organization
expected to be known to - and presumably trusted by - the recipient. The Sender
Policy Framework (SPF) <span>[<a href="#RFC7208" class="cite xref">RFC7208</a>]</span> and DomainKeys Identified Mail (DKIM) <span>[<a href="#RFC6376" class="cite xref">RFC6376</a>]</span>
protocols provide domain-level authentication but are not directly associated
with the RFC5322.From domain, also known as the <a href="#author-domain">Author Domain</a>.
DMARC leverages these two protocols, providing a method for Domain Owners to publish
a DNS TXT record describing the email authentication policies for the Author Domain
and to request specific handling for messages using that domain that fail validation
checks. These DNS records are called <a href="#dmarc-policy-record">DMARC Policy Records</a>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">As with SPF and DKIM, DMARC validation results in a verdict of either "pass" or
"fail". A DMARC result of "pass" requires not only an SPF or DKIM pass verdict for
the email message, but also and more importantly that the domain associated with
the SPF or DKIM pass be "aligned" with the Author Domain in one of two
modes - "relaxed" or "strict". Domains are said to be in "relaxed alignment"
if they have the same <a href="#organizational-domain">Organizational Domain</a>; a
domain's Organizational Domain is the domain at the top of the namespace
hierarchy for that domain while having the same administrative authority as
that domain. On the other hand, domains are in "strict alignment" if and only
if they are identical. The choice of required alignment mode is left to the
<a href="#domain-owner">Domain Owner</a> that publishes a DMARC Policy Record.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">A DMARC pass for a message indicates only that the use of the Author Domain has been
validated for that message as authorized by the Domain Owner.  Such authorization
does not carry an explicit or implicit value assertion about that message or about
the Domain Owner, and so a DMARC pass by itself does not guarantee that delivery to
the recipient's Inbox would be safe or desirable.  For a mail-receiving organization
participating in DMARC, a message that passes DMARC validation is part of a message
stream reliably associated with the Author Domain. Therefore, reputation assessment
of that stream by the mail-receiving organization can assume the use of that Author
Domain is authorized by the Domain Owner.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">On the other hand, a message that fails this validation is not necessarily associated
with the Author Domain and so should not affect the Author Domain's reputation. The phrase
"not necessarily associated" was purposely chosen here, as it is importatnt to understand
that some messages making authorized use of the Author Domain can still fail DMARC validation
checks.  <span>[<a href="#RFC7960" class="cite xref">RFC7960</a>]</span> and <a href="#other-topics" class="auto internal xref">Section 7</a> of this document both discuss reasons
why such failures may happen.  Because of this, a mail-receiving organization that performs
DMARC validation can choose to honor the Domain Owner's requested message handling for validation
failures, but it is not required to do so. DMARC is commonly used as one input to more complex
filtering decisions, and so the mail-receiving organization might choose different actions entirely.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">DMARC, in the associated <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span> and <span>[<a href="#I-D.ietf-dmarc-failure-reporting" class="cite xref">I-D.ietf-dmarc-failure-reporting</a>]</span>
documents, also specifies a reporting framework. Using it, a mail-receiving
organization can generate regular reports about messages that use Author
Domains for which a DMARC Policy Record exists; those reports are sent to the
address(es) specified by the Domain Owner in the DMARC Policy Record. Domain Owners
can use these reports, especially the aggregate reports, not only to identify
sources of mail attempting to fraudulently use their domain, but also (and perhaps
more importantly) to flag and fix gaps in their own authentication practices.  However,
as with honoring the Domain Owner's stated mail handling preference, a mail-receiving
organization supporting DMARC is under no obligation to send requested reports, although
it is recommended that they do send aggregate reports.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">The use of DMARC creates some interoperability challenges that require due
consideration before deployment, particularly with configurations that
can cause mail to be rejected. These are discussed in <a href="#other-topics" class="auto internal xref">Section 7</a>.<a href="#section-1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requirements">
<section id="section-2">
      <h2 id="name-requirements">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<p id="section-2-1">The following sections describe topics that guide the specification of DMARC.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="high-level-goals">
<section id="section-2.1">
        <h3 id="name-high-level-goals">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-high-level-goals" class="section-name selfRef">High-Level Goals</a>
        </h3>
<p id="section-2.1-1">DMARC has the following high-level goals:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1">Allow <a href="#domain-owner">Domain Owners</a> and <a href="#public-suffix-operator">Public Suffix Operators (PSOs)</a> to validate their email authentication deployments.<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">Allow Domain Owners and PSOs to assert their desired message handling
for validation failures on messages purporting to have authorship
within the domain.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.3">
            <p id="section-2.1-2.3.1">Minimize implementation complexity for both senders and receivers.<a href="#section-2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">Reduce the amount of successfully delivered spoofed emails.<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.5">
            <p id="section-2.1-2.5.1">Work at Internet scale.<a href="#section-2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="anti-phishing">
<section id="section-2.2">
        <h3 id="name-anti-phishing">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-anti-phishing" class="section-name selfRef">Anti-Phishing</a>
        </h3>
<p id="section-2.2-1">DMARC is designed to prevent the unauthorized use of the <a href="#author-domain">Author Domain</a>
of an email message, a technique known as "spoofing". Such unauthorized usage can
frequently be found in messages impersonating a domain belonging to a business entity,
messages that are meant to entice the recipient to provide sensitive information, such
as usernames, passwords, and financial account information. These spoofed messages are
commonly referred to as "phishing".<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">DMARC can only be used to combat specific forms of exact-domain spoofing directly. DMARC
does not attempt to solve all problems with spoofed or otherwise fraudulent emails. In
particular, it does not address the use of visually similar domain names or abuse of the
RFC5322.From human-readable display-name, as defined in <span><a href="https://rfc-editor.org/rfc/rfc5322#section-3.4" class="relref">Section 3.4</a> of [<a href="#RFC5322" class="cite xref">RFC5322</a>]</span>.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scalability">
<section id="section-2.3">
        <h3 id="name-scalability">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-scalability" class="section-name selfRef">Scalability</a>
        </h3>
<p id="section-2.3-1">Scalability is a significant issue for systems that need to operate in
an environment as widely deployed as current SMTP email. For this reason,
DMARC seeks to avoid the need for third parties or pre-sending
agreements between senders and receivers. This preserves the
positive aspects of the current email infrastructure.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">Although DMARC does not introduce third-party senders (namely
external agents authorized to send on behalf of an operator) to the
email-handling flow, it also does not preclude them.  Such third
parties are free to provide services in conjunction with DMARC.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="out-of-scope">
<section id="section-2.4">
        <h3 id="name-out-of-scope">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-out-of-scope" class="section-name selfRef">Out of Scope</a>
        </h3>
<p id="section-2.4-1">Several topics and issues are specifically out of scope of this
work. These include the following:<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-2.1">
            <p id="section-2.4-2.1.1">Different treatment of messages that are not authenticated (e.g.,
those that have no DKIM signature or those sent using an <a href="#author-domain">Author
Domain</a> for which no <a href="#dmarc-policy-record">DMARC Policy Record</a>
exists) versus those that fail validation;<a href="#section-2.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-2.2">
            <p id="section-2.4-2.2.1">Evaluation of anything other than RFC5322.From header field;<a href="#section-2.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-2.3">
            <p id="section-2.4-2.3.1">Multiple reporting formats;<a href="#section-2.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-2.4">
            <p id="section-2.4-2.4.1">Publishing policy other than via the DNS;<a href="#section-2.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-2.5">
            <p id="section-2.4-2.5.1">Reporting or otherwise evaluating other than the last-hop IP
address;<a href="#section-2.4-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-2.6">
            <p id="section-2.4-2.6.1">Attacks in the display-name portions of the RFC5322.From header field,
also known as "display name" attacks;<a href="#section-2.4-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-2.7">
            <p id="section-2.4-2.7.1">Authentication of entities other than domains, since DMARC is
built upon SPF and DKIM, which authenticate domains; and<a href="#section-2.4-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.4-2.8">
            <p id="section-2.4-2.8.1">Content analysis.<a href="#section-2.4-2.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology-and-definitions">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology-and-definitions" class="section-name selfRef">Terminology and Definitions</a>
      </h2>
<p id="section-3-1">This section defines terms used in the rest of the document.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="conventions-used-in-this-document">
<section id="section-3.1">
        <h3 id="name-conventions-used-in-this-do">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-conventions-used-in-this-do" class="section-name selfRef">Conventions Used in This Document</a>
        </h3>
<p id="section-3.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Readers are encouraged to be familiar with the contents of
<span>[<a href="#RFC5598" class="cite xref">RFC5598</a>]</span>.  In particular, that document
defines various roles in the messaging infrastructure that can appear the same
or separate in various contexts. For example, a <a href="#domain-owner">Domain Owner</a> could,
via the messaging security mechanisms on which DMARC is based, delegate the
ability to send mail as the Domain Owner to a third party with
another role. This document does not address the distinctions among
such roles; the reader is encouraged to become familiar with that
material before continuing.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definitions">
<section id="section-3.2">
        <h3 id="name-definitions">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
        </h3>
<p id="section-3.2-1">The following sections define the terms used in this document.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div id="authenticated-identifiers">
<section id="section-3.2.1">
          <h4 id="name-authenticated-identifiers">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-authenticated-identifiers" class="section-name selfRef">Authenticated Identifiers</a>
          </h4>
<p id="section-3.2.1-1">Authenticated Identifiers are those domain-level identifiers for which authorized
use is validated using a supported <a href="#authentication-mechanisms">authentication mechanism</a>.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="author-domain">
<section id="section-3.2.2">
          <h4 id="name-author-domain">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-author-domain" class="section-name selfRef">Author Domain</a>
          </h4>
<p id="section-3.2.2-1">The domain name of the apparent author as extracted from the RFC5322.From header field.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dkim-signing-domain">
<section id="section-3.2.3">
          <h4 id="name-dkim-signing-domain">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-dkim-signing-domain" class="section-name selfRef">DKIM Signing Domain</a>
          </h4>
<p id="section-3.2.3-1">The domain name that is the value of the "d" tag in a validated DKIM-Signature header
field in an email message.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spf-domain">
<section id="section-3.2.4">
          <h4 id="name-spf-domain">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-spf-domain" class="section-name selfRef">SPF Domain</a>
          </h4>
<p id="section-3.2.4-1">SPF, <span>[<a href="#RFC7208" class="cite xref">RFC7208</a>]</span>, can validate the uses of both the domain found in an SMTP <span>[<a href="#RFC5321" class="cite xref">RFC5321</a>]</span>
HELO/EHLO command (the HELO identity) and the domain found in an SMTP MAIL command (the
MAIL FROM identity).  DMARC relies solely on SPF validation of the MAIL FROM identity.
Section 2.4 of <span>[<a href="#RFC7208" class="cite xref">RFC7208</a>]</span> describes the determination of the MAIL FROM identity for
cases in which the SMTP MAIL command has a null path, i.e., the mailbox composed of
the local-part "postmaster" and the HELO identity.<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
<p id="section-3.2.4-2">The term "SPF Domain" when used in this document refers to an SPF validated MAIL FROM
identity.<a href="#section-3.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dmarc-policy-domain">
<section id="section-3.2.5">
          <h4 id="name-dmarc-policy-domain">
<a href="#section-3.2.5" class="section-number selfRef">3.2.5. </a><a href="#name-dmarc-policy-domain" class="section-name selfRef">DMARC Policy Domain</a>
          </h4>
<p id="section-3.2.5-1">The domain name at which an applicable <a href="#dmarc-policy-record">DMARC Policy Record</a> is discovered
for the <a href="#author-domain">Author Domain</a> of an email message.<a href="#section-3.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dmarc-policy-record">
<section id="section-3.2.6">
          <h4 id="name-dmarc-policy-record">
<a href="#section-3.2.6" class="section-number selfRef">3.2.6. </a><a href="#name-dmarc-policy-record" class="section-name selfRef">DMARC Policy Record</a>
          </h4>
<p id="section-3.2.6-1">A DNS TXT record published by a <a href="#domain-owner">Domain Owner</a> or <a href="#public-suffix-operator">Public Suffix
Operator (PSO)</a> to enable validation of an <a href="#author-domain">Author
Domain's</a> use, to indicate the Domain Owner's or PSO's message
handling preference regarding failed validation, and optionally to request reports
about the use of the Author Domain.<a href="#section-3.2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="domain-owner">
<section id="section-3.2.7">
          <h4 id="name-domain-owner">
<a href="#section-3.2.7" class="section-number selfRef">3.2.7. </a><a href="#name-domain-owner" class="section-name selfRef">Domain Owner</a>
          </h4>
<p id="section-3.2.7-1">An entity or organization that has control of a given DNS domain,
usually by holding its registration.  Domain Owners range from complex,
globally distributed organizations to service providers working on
behalf of non-technical clients to individuals responsible for maintaining
personal domains. This specification uses this term as analogous to an
Administrative Management Domain as defined in <span>[<a href="#RFC5598" class="cite xref">RFC5598</a>]</span>. It can also
refer to delegates, such as Report Consumers when those are outside of
their immediate management domain.<a href="#section-3.2.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="domain-owner-policy">
<section id="section-3.2.8">
          <h4 id="name-domain-owner-assessment-pol">
<a href="#section-3.2.8" class="section-number selfRef">3.2.8. </a><a href="#name-domain-owner-assessment-pol" class="section-name selfRef">Domain Owner Assessment Policy</a>
          </h4>
<p id="section-3.2.8-1">The message handling preference expressed in a <a href="#dmarc-policy-record">DMARC Policy Record</a>
by the <a href="#domain-owner">Domain Owner</a> regarding failed validation of the <a href="#author-domain">Author Domain</a> is called the "Domain Owner Assessment Policy". Possible values are described in
<a href="#policy-record-format" class="auto internal xref">Section 4.7</a>.<a href="#section-3.2.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="enforcement">
<section id="section-3.2.9">
          <h4 id="name-enforcement">
<a href="#section-3.2.9" class="section-number selfRef">3.2.9. </a><a href="#name-enforcement" class="section-name selfRef">Enforcement</a>
          </h4>
<p id="section-3.2.9-1">Enforcement describes a state where the existing <a href="#domain-owner-policy">Domain Owner Assessment Policy</a>
for an <a href="#organizational-domain">Organizational Domain</a> and all subdomains below it
is not "p=none". This state means that the Organizational Domain and its subdomains
can only be used as <a href="#author-domain">Author Domains</a> if they are properly validated
using the DMARC mechanism.<a href="#section-3.2.9-1" class="pilcrow">¶</a></p>
<p id="section-3.2.9-2">Historically, Domain Owner Assessment Policies of "p=quarantine" or "p=reject"
have been higher value signals to <a href="#mail-receiver">Mail Receivers</a>. Messages with Author
Domains for which such policies exist that are not validated using the DMARC mechanism
will not reach the inbox at Mail Receivers that participate in DMARC and honor the
Domain Owner's expressed handling preference.<a href="#section-3.2.9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identifier-alignment">
<section id="section-3.2.10">
          <h4 id="name-identifier-alignment">
<a href="#section-3.2.10" class="section-number selfRef">3.2.10. </a><a href="#name-identifier-alignment" class="section-name selfRef">Identifier Alignment</a>
          </h4>
<p id="section-3.2.10-1">DMARC describes the concept of alignment between the <a href="#author-domain">Author Domain</a>
and an <a href="#authenticated-identifiers">Authenticated Identifier</a>, and requires
such Identifier Alignment between the two for a message to achieve a DMARC pass. DMARC
defines two states for alignment.<a href="#section-3.2.10-1" class="pilcrow">¶</a></p>
<div id="relaxed-alignment">
<section id="section-3.2.10.1">
            <h5 id="name-relaxed-alignment">
<a href="#section-3.2.10.1" class="section-number selfRef">3.2.10.1. </a><a href="#name-relaxed-alignment" class="section-name selfRef">Relaxed Alignment</a>
            </h5>
<p id="section-3.2.10.1-1">When the <a href="#author-domain">Author Domain</a> has the same <a href="#organizational-domain">Organizational Domain</a>
as an <a href="#authenticated-identifier">Authenticated Identifier</a>, the two are said to be
in relaxed alignment.<a href="#section-3.2.10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="strict-alignment">
<section id="section-3.2.10.2">
            <h5 id="name-strict-alignment">
<a href="#section-3.2.10.2" class="section-number selfRef">3.2.10.2. </a><a href="#name-strict-alignment" class="section-name selfRef">Strict Alignment</a>
            </h5>
<p id="section-3.2.10.2-1">When the <a href="#author-domain">Author Domain</a> is identical to an <a href="#authenticated-identifier">Authenticated Identifier</a>, the two are said to be in strict alignment.<a href="#section-3.2.10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="mail-receiver">
<section id="section-3.2.11">
          <h4 id="name-mail-receiver">
<a href="#section-3.2.11" class="section-number selfRef">3.2.11. </a><a href="#name-mail-receiver" class="section-name selfRef">Mail Receiver</a>
          </h4>
<p id="section-3.2.11-1">The entity or organization that receives and processes email. Mail
Receivers operate one or more Internet-facing Message Transfer Agents (MTAs).<a href="#section-3.2.11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="monitoring-mode">
<section id="section-3.2.12">
          <h4 id="name-monitoring-mode">
<a href="#section-3.2.12" class="section-number selfRef">3.2.12. </a><a href="#name-monitoring-mode" class="section-name selfRef">Monitoring Mode</a>
          </h4>
<p id="section-3.2.12-1">Monitoring Mode describes a state where the existing <a href="#domain-owner-policy">Domain Owner Assessment Policy</a> for an
<a href="#organizational-domain">Organizational Domain</a> and all subdomains below it
is "p=none", and the <a href="#domain-owner">Domain Owner</a> is receiving aggregate reports
for the Organizational Domain.  While the use of the Organizational Domain and all
its subdomains as <a href="#author-domain">Author Domains</a> can still be validated by a <a href="#mail-receiver">Mail Receiver</a> deploying the DMARC mechanism, the Domain Owner expresses no handling
preference for messages that fail DMARC validation.  The Domain Owner is, however, using
the content of the DMARC aggregate reports to make any needed adjustments to
the authentication practices for its mail streams.<a href="#section-3.2.12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="non-existent-domains">
<section id="section-3.2.13">
          <h4 id="name-non-existent-domains">
<a href="#section-3.2.13" class="section-number selfRef">3.2.13. </a><a href="#name-non-existent-domains" class="section-name selfRef">Non-existent Domains</a>
          </h4>
<p id="section-3.2.13-1">For DMARC purposes, a non-existent domain is consistent with the term's meaning
as described in <span>[<a href="#RFC8020" class="cite xref">RFC8020</a>]</span>. That is, if the response code received for a query
for a domain name is NXDOMAIN, then the domain name and any possible subdomains
do not exist.<a href="#section-3.2.13-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="organizational-domain">
<section id="section-3.2.14">
          <h4 id="name-organizational-domain">
<a href="#section-3.2.14" class="section-number selfRef">3.2.14. </a><a href="#name-organizational-domain" class="section-name selfRef">Organizational Domain</a>
          </h4>
<p id="section-3.2.14-1">The Organizational Domain for any domain is akin to the ADMD described in
<span>[<a href="#RFC5598" class="cite xref">RFC5598</a>]</span>. A domain's Organizational Domain is the domain at the top of
the namespace hierarchy for that domain while having the same administrative
authority as the domain. An Organizational Domain is determined by applying
the algorithm found in <a href="#dns-tree-walk" class="auto internal xref">Section 4.10</a>.<a href="#section-3.2.14-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="public-suffix-domain">
<section id="section-3.2.15">
          <h4 id="name-public-suffix-domain-psd">
<a href="#section-3.2.15" class="section-number selfRef">3.2.15. </a><a href="#name-public-suffix-domain-psd" class="section-name selfRef">Public Suffix Domain (PSD)</a>
          </h4>
<p id="section-3.2.15-1">Some domains allow the registration of subdomains that are
"owned" by independent organizations.  Real-world examples of
these domains are ".com", ".org", ".us", and ".co.uk", to name just a few.
These domains are called "Public Suffix Domains" (PSDs).
For example, "ietf.org" is a registered domain name, and ".org" is its PSD.<a href="#section-3.2.15-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="public-suffix-operator">
<section id="section-3.2.16">
          <h4 id="name-public-suffix-operator-pso">
<a href="#section-3.2.16" class="section-number selfRef">3.2.16. </a><a href="#name-public-suffix-operator-pso" class="section-name selfRef">Public Suffix Operator (PSO)</a>
          </h4>
<p id="section-3.2.16-1">A Public Suffix Operator is an organization that manages operations
within a PSD, particularly the DNS records published for names at and
under that domain name.<a href="#section-3.2.16-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pso-controlled-domain-names">
<section id="section-3.2.17">
          <h4 id="name-pso-controlled-domain-names">
<a href="#section-3.2.17" class="section-number selfRef">3.2.17. </a><a href="#name-pso-controlled-domain-names" class="section-name selfRef">PSO Controlled Domain Names</a>
          </h4>
<p id="section-3.2.17-1">PSO-Controlled Domain Names are names in the DNS that are managed by
a PSO. PSO-controlled Domain Names may have one label (e.g., ".com") or more
(e.g., ".co.uk"), depending on the PSD's policy.<a href="#section-3.2.17-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="report-consumer">
<section id="section-3.2.18">
          <h4 id="name-report-consumer">
<a href="#section-3.2.18" class="section-number selfRef">3.2.18. </a><a href="#name-report-consumer" class="section-name selfRef">Report Consumer</a>
          </h4>
<p id="section-3.2.18-1">A Report Consumer is an operator that receives reports from another operator
implementing the reporting mechanisms described in the documents
<span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span> and <span>[<a href="#I-D.ietf-dmarc-failure-reporting" class="cite xref">I-D.ietf-dmarc-failure-reporting</a>]</span>.
This term applies collectively to the system components that receive and process
these reports and the organizations that operate those components.<a href="#section-3.2.18-1" class="pilcrow">¶</a></p>
<p id="section-3.2.18-2">Report Consumers can receive reports concerning domains for which the Report
Consumer is also the <a href="#domain-owner">Domain Owner</a> or <a href="#public-suffix-operator">PSO</a>,
or concerning domains that belong to another operator entirely. The DMARC mechanism
permits a Domain Owner to act as a Report Consumer for its domain(s) and/or to
designate third parties to so act. See <a href="#external-report-addresses" class="auto internal xref">Section 11.6</a> for further
discussion of such designation.<a href="#section-3.2.18-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="overview-and-key-concepts">
<section id="section-4">
      <h2 id="name-overview-and-key-concepts">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-overview-and-key-concepts" class="section-name selfRef">Overview and Key Concepts</a>
      </h2>
<p id="section-4-1">This section provides a general overview of the design and operation
of the DMARC environment.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="dmarc-basics">
<section id="section-4.1">
        <h3 id="name-dmarc-basics">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-dmarc-basics" class="section-name selfRef">DMARC Basics</a>
        </h3>
<p id="section-4.1-1">DMARC permits a <a href="#domain-owner">Domain Owner</a> or <a href="#public-suffix-operator">PSO</a> to enable
validation of an <a href="#author-domain">Author Domain's</a> use in an email message, to indicate
the Domain Owner's or PSO's message handling preference regarding failed validation, and
to request reports about use of the Author Domain. A domain's <a href="#dmarc-policy-record">DMARC Policy Record</a> is published in the DNS as a TXT record at the name created by prepending
the label "_dmarc" to the domain name and is retrieved through normal DNS queries.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">DMARC's validation mechanism produces a "pass" result if a DMARC Policy Record exists for
the Author Domain of an email message and the Author Domain is <a href="#identifier-alignment">aligned</a>
with an <a href="#authenticated-identifiers">Authenticated Identifier</a> from that message.
When a DMARC Policy Record exists for the Author Domain and the DMARC mechanism does not
produce a "pass" result, the <a href="#mail-receiver">Mail Receiver's</a> handling of that message
can be influenced by the <a href="#domain-owner-policy">Domain Owner Assessment Policy</a> expressed
in the DMARC Policy Record.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">It is important to note that the authentication mechanisms employed
by DMARC only validate the usage of a DNS domain in an email message.
They do not validate the local-part of any email address identifier
found in that message, nor do such validations carry an explicit or
implicit value assertion about that message or about the Domain Owner.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">DMARC's reporting component involves the collection of information
about received messages using the Author Domain for periodic aggregate reports
to the Domain Owner or PSO. The parameters and format for such reports are
discussed in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">A Mail Receiver participating in DMARC might also generate per-message failure
reports that contain information related to individual messages that fail DMARC
validation checks. Per-message failure reports are a useful source of
information when debugging deployments (if messages can be determined
to be legitimate even though failing validation) or in analyzing
attacks.  The capability for such services is enabled by DMARC but
defined in other referenced material such as
<span>[<a href="#RFC6591" class="cite xref">RFC6591</a>]</span> and <span>[<a href="#I-D.ietf-dmarc-failure-reporting" class="cite xref">I-D.ietf-dmarc-failure-reporting</a>]</span><a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-rfc5322-from">
<section id="section-4.2">
        <h3 id="name-use-of-rfc5322from">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-use-of-rfc5322from" class="section-name selfRef">Use of RFC5322.From</a>
        </h3>
<p id="section-4.2-1">One of the most obvious points of security scrutiny for DMARC is the
choice to focus on an identifier, namely the RFC5322.From address,
which is part of a body of data that has been trivially forged
throughout the history of email. This field is the one used by end
users to identify the source of the message, and so it has always
been a prime target for abuse through such forgery and other means.
That said, of all the identifiers that are part of the message itself,
this is the only one required to be present. A message without a single,
properly formed RFC5322.From header field does not comply with
<span>[<a href="#RFC5322" class="cite xref">RFC5322</a>]</span>, and handling such a message is outside of the scope of this specification.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-mechanisms">
<section id="section-4.3">
        <h3 id="name-authentication-mechanisms">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-authentication-mechanisms" class="section-name selfRef">Authentication Mechanisms</a>
        </h3>
<p id="section-4.3-1">The following mechanisms for determining <a href="#authenticated-identifiers">Authenticated Identifiers</a> are supported in this version of DMARC:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.1">
            <p id="section-4.3-2.1.1">DKIM, <span>[<a href="#RFC6376" class="cite xref">RFC6376</a>]</span>. The <a href="#dkim-signing-domain">DKIM Signing Domain</a>
from a validated DKIM-Signature header field is an Authenticated Identifier.<a href="#section-4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.3-2.2">
            <p id="section-4.3-2.2.1">SPF, <span>[<a href="#RFC7208" class="cite xref">RFC7208</a>]</span>. The validated <a href="#spf-domain">SPF Domain</a> from the email
message is the Authenticated Identifier.<a href="#section-4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="identifier-alignment-explained">
<section id="section-4.4">
        <h3 id="name-identifier-alignment-explai">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-identifier-alignment-explai" class="section-name selfRef">Identifier Alignment Explained</a>
        </h3>
<p id="section-4.4-1">DMARC validates the authorized use of the <a href="#author-domain">Author Domain</a> by requiring
either that it have the same <a href="#organizational-domain">Organizational Domain</a> as an
<a href="#authenticated-identifier">Authenticated Identifier</a> (a condition known as "<a href="#relaxed-alignment">Relaxed
Alignment</a>") or that it be identical to the Authenticated Identifier
 (a condition known as "<a href="#strict-alignment">Strict Alignment</a>"). The choice of relaxed
or strict alignment is left to the <a href="#domain-owner">Domain Owner</a> and is expressed in
the domain's <a href="#dmarc-policy-record">DMARC Policy Record</a>. In practice, nearly all Domain
Owners have found relaxed alignment sufficient to meet their needs. Domain name comparisons
in this context are case-insensitive, per <span>[<a href="#RFC4343" class="cite xref">RFC4343</a>]</span>.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">The following table is meant to illustrate possible alignment conditions.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<span id="name-alignment-examples"></span><table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-alignment-examples" class="selfRef">"Alignment Examples"</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Authenticated Identifier</th>
              <th class="text-left" rowspan="1" colspan="1">Author Domain</th>
              <th class="text-left" rowspan="1" colspan="1">Identifier Alignment</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">foo.example.com</td>
              <td class="text-left" rowspan="1" colspan="1">news.example.com</td>
              <td class="text-left" rowspan="1" colspan="1">relaxed; the two have the same Organizational Domain, example.com</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">news.example.com</td>
              <td class="text-left" rowspan="1" colspan="1">news.example.com</td>
              <td class="text-left" rowspan="1" colspan="1">strict; the two are identical</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">foo.example.net</td>
              <td class="text-left" rowspan="1" colspan="1">news.example.com</td>
              <td class="text-left" rowspan="1" colspan="1">none; the two do not share a common Organizational Domain</td>
            </tr>
          </tbody>
        </table>
<p id="section-4.4-4">It is important to note that Identifier Alignment cannot occur with a
message that is not valid per <span>[<a href="#RFC5322" class="cite xref">RFC5322</a>]</span>, particularly one with a
malformed, absent, or repeated RFC5322.From header field, since in that case
there is no reliable way to determine a <a href="#dmarc-policy-record">DMARC Policy Record</a>
that applies to the message. Accordingly, DMARC operation is predicated on the input
being a valid RFC5322 message object. For non-compliant cases, handling
is outside of the scope of this specification. Further discussion of this
can be found in <a href="#denial-of-dmarc-attacks" class="auto internal xref">Section 11.5</a>.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<div id="dkim-identifiers">
<section id="section-4.4.1">
          <h4 id="name-dkim-authenticated-identifi">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-dkim-authenticated-identifi" class="section-name selfRef">DKIM-Authenticated Identifiers</a>
          </h4>
<p id="section-4.4.1-1">DKIM permits a Domain Owner to claim some responsibility for a message by
associating the domain to the message. This association is done by inserting
the domain as the value of the "d" tag in a DKIM-Signature header field, and the
assertion of responsibility is validated through a cryptographic signature in
the header field. If the cryptographic signature validates, then the DKIM Signing
Domain is the DKIM-Authenticated Identifier.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">There is currently no generally accepted mechanism by which a Domain Owner may
assert a list of third-party DKIM Signing Domains that are authorized to sign on
behalf of a given Author Domain. Therefore, DMARC requires that Identifier
Alignment is applied to the DKIM-Authenticated Identifier because a message can
bear a valid signature from any domain, even one used by a bad actor. A DKIM-Authenticated
Identifier that does not have Identifier Alignment with the Author Domain is not enough
to validate whether the use of the Author Domain has been authorized by its Domain Owner.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.4.1-3">A single email can contain multiple DKIM signatures, and it is considered to
produce a DMARC "pass" result if any DKIM-Authenticated Identifier aligns with
the Author Domain.<a href="#section-4.4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spf-identifiers">
<section id="section-4.4.2">
          <h4 id="name-spf-authenticated-identifie">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-spf-authenticated-identifie" class="section-name selfRef">SPF-Authenticated Identifiers</a>
          </h4>
<p id="section-4.4.2-1">SPF can validate the uses of both the domain found in an SMTP HELO/EHLO command
(the HELO identity) and the domain found in an SMTP MAIL command (the MAIL FROM
identity). DMARC relies solely on SPF validation of the MAIL FROM identity.  If
the use of the domain in the MAIL FROM identity is validated by SPF, then that
domain is the SPF-Authenticated Identifier.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2-2">There is currently no generally accepted mechanism by which a Domain Owner may
assert a list of third-party domains that are authorized for use as the MAIL FROM
identity for mail using a given Author Domain. Therefore, DMARC requires that Identifier Alignment
is applied to the SPF-Authenticated Identifier because any Domain Owner, even a bad
actor, can publish an SPF record for its domain and send email that will obtain an
SPF pass result. An SPF-Authenticated Identifier that does not have Identifier
Alignment with the Author Domain is not enough to validate whether the use of the Author
Domain has been authorized by its Domain Owner.<a href="#section-4.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="alignment-and-extension-technologies">
<section id="section-4.4.3">
          <h4 id="name-alignment-and-extension-tec">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-alignment-and-extension-tec" class="section-name selfRef">Alignment and Extension Technologies</a>
          </h4>
<p id="section-4.4.3-1">If in the future DMARC is extended to include the use of other authentication
mechanisms, the extensions <span class="bcp14">MUST</span> allow for the assignment of a domain
as an Authenticated Identifier so that alignment with the Author Domain
can be validated.<a href="#section-4.4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dmarc-policy-record-explained">
<section id="section-4.5">
        <h3 id="name-dmarc-policy-record-explain">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-dmarc-policy-record-explain" class="section-name selfRef">DMARC Policy Record Explained</a>
        </h3>
<p id="section-4.5-1">A <a href="#domain-owner">Domain Owner</a> or <a href="#public-suffix-operator">PSO</a> advertises
DMARC participation of one or more of its domains by publishing <a href="#dmarc-policy-record">DMARC Policy Records</a> that will apply to those domains. In doing so, Domain Owners
and PSOs indicate their handling preference regarding failed validation for email
messages using their domain in the RFC5322.From header field as well as their
desire (if any) to receive feedback about such messages in the form of aggregate and/or
failure reports.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">DMARC Policy Records are stored as DNS TXT records with names starting with
the label "_dmarc".  For example, the Domain Owner of "example.com" would publish
a DMARC Policy Record at the name "_dmarc.example.com", and a <a href="#mail-receiver">Mail Receiver</a>
wishing to find the DMARC Policy Record for mail with an <a href="#author-domain">Author Domain</a>
of "example.com" would issue a TXT query to the DNS for the name "_dmarc.example.com".
A Domain Owner or PSO may choose not to participate in DMARC validation by Mail Receivers
simply by not publishing a DMARC Policy Record for its Author Domain(s).<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">DMARC Policy Records can also apply to subdomains of the name at which they
are published in the DNS, if the record is published at an <a href="#organizational-domain">Organizational
Domain</a> for the subdomains. The <a href="#domain-owner-policy">Domain Owner Assessment Policy</a> that applies to the subdomains can be identical to the Domain
Owner Assessment Policy that applies to the Organizational Domain or different, depending
on the presence or absence of certain values in the DMARC Policy Record. See <a href="#policy-record-format" class="auto internal xref">Section 4.7</a>
for more details.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">DMARC's use of the Domain Name Service is driven by DMARC's use of domain
names and the nature of the query it performs. The query requirement matches
with the DNS for obtaining simple parametric information. It uses an established
method of storing the information associated with the domain name targeted by
a DNS query, specifically an isolated TXT record that is restricted to the
DMARC context.  Using the DNS as the query service has the benefit of reusing
an extremely well-established operations, administration, and management
infrastructure, rather than creating a new one.<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<p id="section-4.5-5">Per <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>, a TXT record can comprise multiple "character-string" objects.
Where this is the case, the module performing DMARC evaluation <span class="bcp14">MUST</span> concatenate
these strings by joining together the objects in order and parsing the result as a single string.<a href="#section-4.5-5" class="pilcrow">¶</a></p>
<p id="section-4.5-6">A Domain Owner can choose not to have some underlying authentication mechanisms
apply to DMARC evaluation of its Author Domain(s). For example, if a Domain Owner
only wants to use DKIM as the underlying authentication mechanism, then the Domain
Owner does not publish an SPF record that can produce Identifier Alignment
between an SPF-Authenticated Identifier and the Author Domain. Alternatively, if
the Domain Owner wishes to rely solely on SPF, then it can send email messages that
have no DKIM-Signature header field that would produce Identifier Alignment between
a DKIM-Authenticated Identifier and the Author Domain. Neither approach is recommended,
however.<a href="#section-4.5-6" class="pilcrow">¶</a></p>
<p id="section-4.5-7">A Mail Receiver implementing the DMARC mechanism gets the Domain Owner's or
PSO's published Domain Owner Assessment Policy and can use it to inform its handling decisions
for messages that undergo DMARC validation checks and do not produce a result of
pass.  Mail handling considerations based on Domain Owner Assessment Policy enforcement
are discussed below in <a href="#policy-enforcement-considerations" class="auto internal xref">Section 5.4</a>.<a href="#section-4.5-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dmarc-uris">
<section id="section-4.6">
        <h3 id="name-dmarc-reporting-uris">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-dmarc-reporting-uris" class="section-name selfRef">DMARC Reporting URIs</a>
        </h3>
<p id="section-4.6-1"><span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> defines a syntax for identifying a resource. The DMARC
mechanism uses this as the format by which a <a href="#domain-owner">Domain Owner</a>
or <a href="#public-suffix-organization">PSO</a> specifies the destination(s) for the two
report types that are supported. The <a href="#policy-record-format">DMARC Policy Record format</a>
allows for a list of these URIs to be provided, with each URI separated by commas (ASCII 0x2c).<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">A formal definition is provided in <a href="#formal-definition" class="auto internal xref">Section 4.8</a>.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="policy-record-format">
<section id="section-4.7">
        <h3 id="name-dmarc-policy-record-format">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-dmarc-policy-record-format" class="section-name selfRef">DMARC Policy Record Format</a>
        </h3>
<p id="section-4.7-1">DMARC Policy Records follow the extensible "tag-value" syntax for DNS-based
key records defined in DKIM <span>[<a href="#RFC6376" class="cite xref">RFC6376</a>]</span>.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2"><a href="#iana-considerations" class="auto internal xref">Section 9</a> creates a registry for known DMARC tags and
registers the initial set defined in this document. Only tags defined
in that registry are to be processed; unknown tags <span class="bcp14">MUST</span> be ignored.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">The following tags are valid DMARC tags:<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.7-4">
          <dt id="section-4.7-4.1">adkim:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-4.2">
            <p id="section-4.7-4.2.1">(plain-text; <span class="bcp14">OPTIONAL</span>; default is "r".) Indicates whether
the <a href="#domain-owner">Domain Owner</a> or <a href="#public-suffix-organization">PSO</a> requires
strict or relaxed DKIM Identifier Alignment mode. See <a href="#dkim-identifiers" class="auto internal xref">Section 4.4.1</a> for details.
Valid values are as follows:<a href="#section-4.7-4.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.7-4.2.2">
              <dt id="section-4.7-4.2.2.1">r:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.2.2.2">relaxed mode<a href="#section-4.7-4.2.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.7-4.2.2.3">s:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.2.2.4">strict mode<a href="#section-4.7-4.2.2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-4.3">aspf:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-4.4">
            <p id="section-4.7-4.4.1">(plain-text; <span class="bcp14">OPTIONAL</span>; default is "r".)  Indicates whether
the Domain Owner or PSO requires strict or relaxed SPF Identifier Alignment
mode. See <a href="#spf-identifiers" class="auto internal xref">Section 4.4.2</a> for details. Valid values are as follows:<a href="#section-4.7-4.4.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.7-4.4.2">
              <dt id="section-4.7-4.4.2.1">r:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.4.2.2">relaxed mode<a href="#section-4.7-4.4.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.7-4.4.2.3">s:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.4.2.4">strict mode<a href="#section-4.7-4.4.2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-4.5">fo:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-4.6">
            <p id="section-4.7-4.6.1">Failure reporting options (plain-text; <span class="bcp14">OPTIONAL</span>; default is "0") Provides
requested options for the generation of failure reports.  Report generators
may choose to adhere to the requested options.  This tag's content <span class="bcp14">MUST</span>
be ignored if a "ruf" tag (below) is not also specified. This tag can include
one or more of the values shown here, with the exception that "0" and "1" are
mutually exclusive. If more than one value is assigned to the tag, the list of
values should be separated by colons (e.g., fo=0:d), and the values may appear
in the list in any order. Valid values and their meanings are:<a href="#section-4.7-4.6.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.7-4.6.2">
              <dt id="section-4.7-4.6.2.1">0:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.6.2.2">Generate a DMARC failure report if all underlying authentication
mechanisms fail to produce an aligned "pass" result.<a href="#section-4.7-4.6.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.7-4.6.2.3">1:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.6.2.4">Generate a DMARC failure report if any underlying authentication
mechanism fails to produce an aligned "pass" result.<a href="#section-4.7-4.6.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.7-4.6.2.5">d:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.6.2.6">Generate a DKIM failure report if the message had a signature
that failed evaluation, regardless of its alignment. DKIM-specific
reporting is described in <span>[<a href="#RFC6651" class="cite xref">RFC6651</a>]</span>.<a href="#section-4.7-4.6.2.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.7-4.6.2.7">s:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.6.2.8">Generate an SPF failure report if the message failed SPF
evaluation, regardless of its alignment. SPF-specific
reporting is described in <span>[<a href="#RFC6652" class="cite xref">RFC6652</a>]</span>.<a href="#section-4.7-4.6.2.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-4.7">np:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-4.8">
            <p id="section-4.7-4.8.1"><a href="#domain-owner-policy">Domain Owner Assessment Policy</a> for non-existent subdomains
of the given Organizational Domain (plain-text; <span class="bcp14">OPTIONAL</span>). For this tag, the definition
of "non-existent subdomain" is the same as that used for "Non-existent Domains" in <a href="#non-existent-domains" class="auto internal xref">Section 3.2.13</a>.
The policy expressed by this tag indicates the message handling preference of the Domain Owner
or PSO for mail using non-existent subdomains
of the prevailing Organizational Domain and not passing DMARC validation. It applies
only to non-existent subdomains of the Organizational Domain queried and not to either
existing subdomains or the domain itself. Its syntax is identical to that of the "p"
tag defined below. If the "np" tag is absent, the policy specified by the "sp" tag (if
the "sp" tag is present) or the policy specified by the "p" tag, if the "sp"
tag is not present, <span class="bcp14">MUST</span> be applied for non-existent subdomains.<a href="#section-4.7-4.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-4.9">p:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-4.10">
            <p id="section-4.7-4.10.1"><a href="#domain-owner-policy">Domain Owner Assessment Policy</a> (plain-text; <span class="bcp14">RECOMMENDED</span>
for DMARC Policy Records). Indicates the message handling preference of the Domain Owner
or PSO for mail using its domain but not passing DMARC validation.
The policy applies to the domain queried and to subdomains, unless the
subdomain policy is explicitly described using the "sp" or "np" tags.
If this tag is not present in an otherwise syntactically valid DMARC
Policy Record, then the record is treated as if it included "p=none" (see
<a href="#dmarc-policy-discovery" class="auto internal xref">Section 4.10.1</a>). This tag is not applicable for third-party
reporting records (see <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span> and <span>[<a href="#I-D.ietf-dmarc-failure-reporting" class="cite xref">I-D.ietf-dmarc-failure-reporting</a>]</span>).
Possible values are as follows:<a href="#section-4.7-4.10.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.7-4.10.2">
              <dt id="section-4.7-4.10.2.1">none:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.10.2.2">The Domain Owner offers no expression of preference.<a href="#section-4.7-4.10.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.7-4.10.2.3">quarantine:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.10.2.4">The Domain Owner considers such mail to be suspicious. It is possible
the mail is valid, although the failure creates a significant concern.<a href="#section-4.7-4.10.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.7-4.10.2.5">reject:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.10.2.6">The Domain Owner considers all such failures to be a clear indication
that the use of the domain name is not valid. See <a href="#rejecting-messages" class="auto internal xref">Section 7.2</a>
for some discussion of SMTP rejection methods and their implications.<a href="#section-4.7-4.10.2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-4.11">psd:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-4.12">
            <p id="section-4.7-4.12.1">A flag indicating whether the domain is a PSD. (plain-text; <span class="bcp14">OPTIONAL</span>;
default is "u"). Possible values are:<a href="#section-4.7-4.12.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.7-4.12.2">
              <dt id="section-4.7-4.12.2.1">y:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.12.2.2">PSOs include this tag with a value of "y" to indicate that the domain
is a PSD. If a record containing this tag with a value of "y" is found during
policy discovery, this information will be used to determine the Organizational
Domain and DMARC Policy Domain applicable to the message in question.<a href="#section-4.7-4.12.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.7-4.12.2.3">n:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.12.2.4">The DMARC Policy Record is published for a domain that is not a PSD, but it is
the Organizational Domain for itself and its subdomains.<a href="#section-4.7-4.12.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.7-4.12.2.5">u:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.12.2.6">The default indicates that the DMARC Policy Record is published for a domain
that is not a PSD, and may or may not be an Organizational Domain for itself and
its subdomains. Use the mechanism described in <a href="#dns-tree-walk" class="auto internal xref">Section 4.10</a> for determining
the Organizational Domain for this domain.<a href="#section-4.7-4.12.2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-4.13">rua:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-4.14">
            <p id="section-4.7-4.14.1">Addresses to which aggregate feedback reports are to be sent (comma-separated plain-text
list of DMARC Reporting URIs; <span class="bcp14">OPTIONAL</span>). If present, the Domain Owner is requesting
Mail Receivers to send aggregate feedback reports as defined in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>
to the URIs listed.  Any valid URI can be specified. A Mail Receiver that sends aggregate
feedback reports  <span class="bcp14">MUST</span> implement support for a "mailto:" URI, i.e., the ability to send a DMARC
report via electronic mail. If the tag is not provided, Mail Receivers <span class="bcp14">MUST NOT</span> generate
aggregate feedback reports for the domain.  URIs involving schemes not supported by Mail Receivers
<span class="bcp14">MUST</span> be ignored.  <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span> also discusses considerations that
apply when the domain name of a URI differs from the domain publishing the DMARC Policy Record. See
<a href="#external-report-addresses" class="auto internal xref">Section 11.6</a> for additional considerations.<a href="#section-4.7-4.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-4.15">ruf:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-4.16">
            <p id="section-4.7-4.16.1">Addresses to which message-specific failure information is to be reported
(comma-separated plain-text list of DMARC URIs; <span class="bcp14">OPTIONAL</span>). If present, the
Domain Owner is requesting Mail Receivers to send detailed failure reports about
messages that fail the DMARC evaluation in specific ways (see the "fo" tag above) to
the URIs listed.  Depending on the value of the "fo" tag, the format for such reports
is described in <span>[<a href="#I-D.ietf-dmarc-failure-reporting" class="cite xref">I-D.ietf-dmarc-failure-reporting</a>]</span>, <span>[<a href="#RFC6651" class="cite xref">RFC6651</a>]</span>, or <span>[<a href="#RFC6652" class="cite xref">RFC6652</a>]</span>. Any
valid URI can be specified. A Mail Receiver sending failure reports <span class="bcp14">MUST</span> implement
support for a "mailto:" URI, i.e., the ability to send message-specific failure information
via electronic mail. If the tag is not provided, Mail Receivers <span class="bcp14">MUST NOT</span> generate
failure reports for the domain. URIs involving schemes not supported by Mail Receivers
<span class="bcp14">MUST</span> be ignored.  <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span> discusses considerations
that apply when the domain name of a URI differs from that of the domain advertising the
policy.  See <a href="#external-report-addresses" class="auto internal xref">Section 11.6</a> for additional considerations.<a href="#section-4.7-4.16.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-4.17">sp:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-4.18">
            <p id="section-4.7-4.18.1">Domain Owner Assessment Policy for all subdomains of the given Organizational Domain
(plain-text; <span class="bcp14">OPTIONAL</span>). Indicates the message handling preference of the Domain Owner
or PSO for mail using an existing subdomain of the prevailing Organizational Domain for
and not passing DMARC validation. It applies only to existing subdomains of the message's
Organizational Domain in the DNS hierarchy and not to the Organizational Domain itself.
Its syntax is identical to that of the "p" tag defined above. If both the "sp" tag is
absent, and the "np" tag is either absent or not applicable, the policy specified by
the "p" tag <span class="bcp14">MUST</span> be applied for subdomains.  Note that "sp" will be ignored for
DMARC Policy Records published on subdomains of Organizational Domains and PSDs due
to the effect of the <a href="#dmarc-policy-discovery">DMARC Policy Discovery</a>.<a href="#section-4.7-4.18.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-4.19">t:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-4.20">
            <p id="section-4.7-4.20.1">DMARC policy test mode (plain-text; <span class="bcp14">OPTIONAL</span>; default is "n"). For
the Author Domain to which the DMARC Policy Record applies, the "t" tag serves
as a signal to the actor performing DMARC validation checks as to whether or not
the Domain Owner wishes the Domain Owner Assessment Policy declared in the "p",
"sp", and/or "np" tags to actually be applied. This tag does not affect the
generation of DMARC reports, and it has no effect on any policy ("p", "sp", or "np")
that is "none".  See <a href="#removal-of-the-pct-tag" class="auto internal xref">Appendix A.6</a> for further discussion of the use
of this tag.  Possible values are as follows:<a href="#section-4.7-4.20.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-4.7-4.20.2">
              <dt id="section-4.7-4.20.2.1">y:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.20.2.2">A request that the actor performing the DMARC validation check not
apply the policy, but instead apply any special handling rules it might have
in place, such as rewriting the RFC5322.From header field (see <a href="#removal-of-the-pct-tag" class="auto internal xref">Appendix A.6</a>).
The Domain Owner is currently testing its specified DMARC assessment policy, and has
an expectation that the policy applied to any failing messages will be one level below the
specified policy. That is, if the policy is "quarantine" and the value of the "t"
tag is "y", a policy of "none" will be applied to failing messages; if the policy
is "reject" and the value of the "t" tag is "y", a policy of "quarantine" will be
applied to failing messages, irrespective of any other special handling rules that
might be triggered by the "t" tag having a value of "y".<a href="#section-4.7-4.20.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.7-4.20.2.3">n:</dt>
              <dd style="margin-left: 1.5em" id="section-4.7-4.20.2.4">The default is a request to apply the Domain Owner Assessment Policy as specified
to any message that produces a DMARC "fail" result.<a href="#section-4.7-4.20.2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.7-4.21">v:</dt>
          <dd style="margin-left: 1.5em" id="section-4.7-4.22">
            <p id="section-4.7-4.22.1">Version (plain-text; <span class="bcp14">REQUIRED</span>).  Identifies the record retrieved
as a DMARC Policy Record. It <span class="bcp14">MUST</span> have the value of "DMARC1". The value
of this tag <span class="bcp14">MUST</span> match precisely; if it does not or it is absent,
the entire record <span class="bcp14">MUST</span> be ignored. It <span class="bcp14">MUST</span> be the first tag in the
list.<a href="#section-4.7-4.22.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.7-5">A DMARC Policy Record <span class="bcp14">MUST</span> comply with the formal specification found
in <a href="#formal-definition" class="auto internal xref">Section 4.8</a> in that the "v" tag <span class="bcp14">MUST</span> be present and <span class="bcp14">MUST</span>
appear first. Unknown tags <span class="bcp14">MUST</span> be ignored. Syntax errors
in the remainder of the record <span class="bcp14">MUST</span> be discarded in favor of
default values (if any) or ignored outright.<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<p id="section-4.7-6">Note that given the rules of the previous paragraph, the addition of a
new tag into the registered list of tags does not itself require a
new version of DMARC to be generated (with a corresponding change to
the "v" tag's value), but a change to any existing tags does require
a new version of DMARC.<a href="#section-4.7-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="formal-definition">
<section id="section-4.8">
        <h3 id="name-formal-definition">
<a href="#section-4.8" class="section-number selfRef">4.8. </a><a href="#name-formal-definition" class="section-name selfRef">Formal Definition</a>
        </h3>
<p id="section-4.8-1">The formal definition of the DMARC Policy Record format, using <span>[<a href="#RFC5234" class="cite xref">RFC5234</a>]</span>
and <span>[<a href="#RFC7405" class="cite xref">RFC7405</a>]</span>, is as follows:<a href="#section-4.8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.8-2">
<pre>  dmarc-uri     = URI
                ; "URI" is imported from [RFC3986];
                ; commas (ASCII 0x2C) and exclamation
                ; points (ASCII 0x21) MUST be
                ; encoded

  obs-dmarc-uri = dmarc-uri "!" 1*DIGIT [ "k" / "m" / "g" / "t" ]
                ; Obsolete syntax, reporters should ignore the
                ; size if it is found in a DMARC Policy Record.

  dmarc-sep     = *WSP ";" *WSP

  equals        = *WSP "=" *WSP

  dmarc-record  = dmarc-version *(dmarc-sep dmarc-tag) [dmarc-sep]

  dmarc-tag     = 1*ALPHA equals 1*dmarc-value

  ; any printing characters but semicolon
  dmarc-value   = %x20-3A / %x3C-7E

  dmarc-version = "v" equals %s"DMARC1" ; case sensitive

  ; specialized syntax of DMARC values
  dmarc-request = "none" / "quarantine" / "reject"

  dmarc-yorn    = "y" / "n"

  dmarc-psd     = "y" / "n" / "u"

  dmarc-rors    = "r" / "s"

  dmarc-urilist = dmarc-uri / obs-dmarc-uri *(*WSP "," *WSP dmarc-uri / obs-dmarc-uri)

  dmarc-fo      = ("0" / "1") *(":" dmarc-afrf)
                / dmarc-afrf [":" ("0" / "1")] [":" dmarc-afrf]
                / *(dmarc-afrf ":") ("0" / "1")

  dmarc-afrf    = "d" / "s"
                ; each may appear at most once in dmarc-fo
</pre><a href="#section-4.8-2" class="pilcrow">¶</a>
</div>
<p id="section-4.8-3">In each dmarc-tag, the dmarc-value has a syntax that depends on the tag name.
The ABNF rule for each dmarc-value is specified in the following table:<a href="#section-4.8-3" class="pilcrow">¶</a></p>
<span id="name-tag-names-and-values"></span><table class="left" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-tag-names-and-values" class="selfRef">"Tag Names and Values"</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Tag Name</th>
              <th class="text-left" rowspan="1" colspan="1">Value Rule</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">p</td>
              <td class="text-left" rowspan="1" colspan="1">dmarc-request</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">t</td>
              <td class="text-left" rowspan="1" colspan="1">dmarc-yorn</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">psd</td>
              <td class="text-left" rowspan="1" colspan="1">dmarc-psd</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">np</td>
              <td class="text-left" rowspan="1" colspan="1">dmarc-request</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">sp</td>
              <td class="text-left" rowspan="1" colspan="1">dmarc-request</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">adkim</td>
              <td class="text-left" rowspan="1" colspan="1">dmarc-rors</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">aspf</td>
              <td class="text-left" rowspan="1" colspan="1">dmarc-rors</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">rua</td>
              <td class="text-left" rowspan="1" colspan="1">dmarc-urilist</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ruf</td>
              <td class="text-left" rowspan="1" colspan="1">dmarc-urilist</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fo</td>
              <td class="text-left" rowspan="1" colspan="1">dmarc-fo</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="flow-diagram">
<section id="section-4.9">
        <h3 id="name-flow-diagram">
<a href="#section-4.9" class="section-number selfRef">4.9. </a><a href="#name-flow-diagram" class="section-name selfRef">Flow Diagram</a>
        </h3>
<div class="lang-ascii-art sourcecode" id="section-4.9-1">
<pre> +---------------+                             +--------------------+
 | Author Domain |&lt; . . . . . . . . . . . .    | Return-Path Domain |
 +---------------+                        .    +--------------------+
     |                                    .               ^
     V                                    V               .
 +-----------+     +--------+       +----------+          v
 |   MSA     |&lt;***&gt;|  DKIM  |       |   DMARC  |     +----------+
 |  Service  |     | Signer |       | Validator|&lt;***&gt;|    SPF   |
 +-----------+     +--------+       +----------+  *  | Validator|
     |                                    ^       *  +----------+
     |                                    *       *
     V                                    v       *
  +------+        (~~~~~~~~~~~~)      +------+    *  +----------+
  | sMTA |-------&gt;( other MTAs )-----&gt;| rMTA |    **&gt;|   DKIM   |
  +------+        (~~~~~~~~~~~~)      +------+       | Validator|
                                         |           +----------+
                                         |                ^
                                         V                .
                                  +-----------+           .
                    +---------+   |    MDA    |           v
                    |  User   |&lt;--| Filtering |      +-----------+
                    | Mailbox |   |  Engine   |      |   DKIM    |
                    +---------+   +-----------+      |  Signing  |
                                                     | Domain(s) |
                                                     +-----------+

  MSA = Mail Submission Agent
  MDA = Mail Delivery Agent
</pre><a href="#section-4.9-1" class="pilcrow">¶</a>
</div>
<p id="section-4.9-2">The above diagram shows a typical flow of messages through a
DMARC-aware system. Dashed lines (e.g., --&gt;) denote the actual message
flow, dotted lines (e.g., &lt; . . &gt;) represent DNS queries used to retrieve
message policy related to the supported message authentication schemes,
and starred lines (e.g., &lt;**&gt;) indicate data exchange between message-handling
modules and message authentication modules. "sMTA" is the sending MTA, and
"rMTA" is the receiving MTA.<a href="#section-4.9-2" class="pilcrow">¶</a></p>
<p id="section-4.9-3">Put simply, when a message reaches a DMARC-aware rMTA, a DNS query
will be initiated to determine if a DMARC Policy Record exists that applies
to the Author Domain. If a DMARC Policy Record is found, the rMTA will use
the results of SPF and DKIM validation checks to determine DMARC validation
status. The DMARC validation status can then factor into the message handling
decision made by the recipient's mail system.<a href="#section-4.9-3" class="pilcrow">¶</a></p>
<p id="section-4.9-4">More details on specific actions for the parties involved can be
found in <a href="#domain-owner-actions" class="auto internal xref">Section 5.1</a> and <a href="#mail-receiver-actions" class="auto internal xref">Section 5.3</a>.<a href="#section-4.9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dns-tree-walk">
<section id="section-4.10">
        <h3 id="name-dns-tree-walk">
<a href="#section-4.10" class="section-number selfRef">4.10. </a><a href="#name-dns-tree-walk" class="section-name selfRef">DNS Tree Walk</a>
        </h3>
<p id="section-4.10-1">An <a href="#organizational-domain">Organizational Domain</a> serves two different purposes,
depending on the context:<a href="#section-4.10-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.10-2.1">
            <p id="section-4.10-2.1.1">The Organizational Domain of the <a href="#author-domain">Author Domain</a> establishes
the <a href="#dmarc-policy-record">DMARC Policy Record</a> for that domain when no DMARC Policy
Record is published specifically for the Author Domain. (see <a href="#dmarc-policy-discovery" class="auto internal xref">Section 4.10.1</a>)<a href="#section-4.10-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-4.10-2.2">
            <p id="section-4.10-2.2.1">The Organizational Domains of an <a href="#authenticated-identifiers">Authenticated Identifier</a>
and the Author Domain are used in determining Identifier Alignment between the two. (see
<a href="#identifier-alignment-evaluation" class="auto internal xref">Section 4.10.2</a>).<a href="#section-4.10-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.10-3"><span>[<a href="#RFC7489" class="cite xref">RFC7489</a>]</span> defined an Organizational Domain as "The domain that was registered with a domain
name registrar." RFC 7489 discussed using a "public suffix" list (PSL) as the authoritative
list of the parent domains for Organizational Domains, and further described a method for
determining the Organizational Domain of an Author Domain or an Authenticated Identifier.
However, RFC 7489 mandated no requirement for a specific PSL for Mail Receivers to use
(though it did suggest the one found at <a href="https://publicsuffix.org/">https://publicsuffix.org/</a>) nor did it provide
any guidance for the frequency of regular retrieval of the PSL by Mail Receivers participating
in DMARC. RFC 7489 acknowledged the possibility of interoperability issues caused by Mail
Receivers choosing different PSLs, and even suggested that if a more reliable and secure
method for determining the Organizational Domain could be created, that method should
replace reliance on a public suffix list.<a href="#section-4.10-3" class="pilcrow">¶</a></p>
<p id="section-4.10-4">This update to DMARC offers more flexibility to Domain Owners, especially those with large,
complex organizations that might want to apply decentralized management to their DNS and their
DMARC Policy Records. Rather than just using a public suffix list to help identify
an Organizational Domain, this update defines a discovery technique known colloquially as
the "DNS Tree Walk". The target of any DNS Tree Walk is discovery of a valid DMARC Policy Record,
and its use in determining an Organizational Domain allows for publishing DMARC Policy Records
at multiple points in the namespace.<a href="#section-4.10-4" class="pilcrow">¶</a></p>
<p id="section-4.10-5">This flexibility comes at a possible cost, however. Since the DNS Tree Walk
relies on the Mail Receiver making a series of DNS queries, the potential
exists for an ill-intentioned Domain Owner to send mail with Author Domains
with tens or even hundreds of labels for the purpose of executing a Denial
of Service Attack on the Mail Receiver.  To guard against such abuse of the
DNS, a shortcut is built into the process so that Author Domains with more
than eight labels do not result in more than eight DNS queries. Observed data
at the time of publication showed that Author Domains with up to seven labels
were in usage, and so eight was chosen as the query limit to allow for some
future expansion of the name space that did not require updating this document.<a href="#section-4.10-5" class="pilcrow">¶</a></p>
<p id="section-4.10-6">The generic steps for a DNS Tree Walk are as follows:<a href="#section-4.10-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.10-7">
<li id="section-4.10-7.1">
            <p id="section-4.10-7.1.1">Query the DNS for a TXT record that matches the format of a DMARC Policy Record at
the starting point for the Tree Walk.  The starting point for the DNS Tree Walk will
depend on the ultimate target of the DNS Tree Walk. <a href="#dmarc-policy-discovery" class="auto internal xref">Section 4.10.1</a> and
<a href="#identifier-alignment-evaluation" class="auto internal xref">Section 4.10.2</a> describe the possible starting points. A possibly
empty set of records is returned.<a href="#section-4.10-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.10-7.2">
            <p id="section-4.10-7.2.1">Records that do not start with a "v" tag that identifies the current
version of DMARC are discarded. If multiple DMARC Policy Records are
returned for a single target, they are all discarded. If a single record
remains and it contains a "psd=n" or "psd=y" tag, stop.<a href="#section-4.10-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.10-7.3">
            <p id="section-4.10-7.3.1">Break the subject DNS domain name into a set of ordered labels. Assign
the count of labels to "x", and number the labels from right to left; e.g.,
for "a.mail.example.com", "x" would be assigned the value 4, "com" would be
label 1, "example" would be label 2, "mail" would be label 3, and so forth.<a href="#section-4.10-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.10-7.4">
            <p id="section-4.10-7.4.1">If x &lt; 8, remove the left-most (highest-numbered) label from the subject
domain. If x &gt;= 8, remove the left-most (highest-numbered) labels from the
subject domain until 7 labels remain. The resulting DNS domain name is the
new target for the next lookup.<a href="#section-4.10-7.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.10-7.5">
            <p id="section-4.10-7.5.1">Query the DNS for a DMARC Policy Record at the DNS domain name matching this
new target. A possibly empty set of records is returned.<a href="#section-4.10-7.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.10-7.6">
            <p id="section-4.10-7.6.1">Records that do not start with a "v" tag that identifies the current
version of DMARC are discarded. If multiple DMARC Policy Records are returned for
a single target, they are all discarded. If a single record remains and it
contains a "psd=n" or "psd=y" tag, stop.<a href="#section-4.10-7.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.10-7.7">
            <p id="section-4.10-7.7.1">Determine the target for the next query by removing the left-most label
from the target of the previous query. Repeat steps 5, 6, and 7 until the
process stops or there are no more labels remaining.<a href="#section-4.10-7.7.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.10-8">To illustrate, for a message with the arbitrary Author Domain of
"a.b.c.d.e.f.g.h.i.j.mail.example.com", a full DNS Tree Walk would require the following
eight queries to potentially locate the DMARC Policy Record or Organizational Domain:<a href="#section-4.10-8" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.10-9.1">_dmarc.a.b.c.d.e.f.g.h.i.j.mail.example.com<a href="#section-4.10-9.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.10-9.2">_dmarc.g.h.i.j.mail.example.com<a href="#section-4.10-9.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.10-9.3">_dmarc.h.i.j.mail.example.com<a href="#section-4.10-9.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.10-9.4">_dmarc.i.j.mail.example.com<a href="#section-4.10-9.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.10-9.5">_dmarc.j.mail.example.com<a href="#section-4.10-9.5" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.10-9.6">_dmarc.mail.example.com<a href="#section-4.10-9.6" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.10-9.7">_dmarc.example.com<a href="#section-4.10-9.7" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-4.10-9.8">_dmarc.com<a href="#section-4.10-9.8" class="pilcrow">¶</a>
</li>
        </ul>
<div id="dmarc-policy-discovery">
<section id="section-4.10.1">
          <h4 id="name-dmarc-policy-discovery">
<a href="#section-4.10.1" class="section-number selfRef">4.10.1. </a><a href="#name-dmarc-policy-discovery" class="section-name selfRef">DMARC Policy Discovery</a>
          </h4>
<p id="section-4.10.1-1">The DMARC Policy Record to be applied to an email message will be the record found at any
of the following locations, listed from highest preference to lowest:<a href="#section-4.10.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.10.1-2.1">The Author Domain<a href="#section-4.10.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.10.1-2.2">The Organizational Domain of the Author Domain<a href="#section-4.10.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.10.1-2.3">The Public Suffix Domain of the Author Domain<a href="#section-4.10.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.10.1-3">Policy discovery starts first with a query for a valid DMARC Policy Record at the
name created by prepending the label "_dmarc" to the Author Domain of the
message being evaluated. If a valid DMARC Policy Record is found there, then this is the
DMARC Policy Record to be applied to the message; however, this does not necessarily mean
that the Author Domain is the Organizational Domain to be used in Identifier
Alignment checks. Whether this is also the Organizational Domain is dependent
on the value of the "psd" tag, if present, or some conditions described in
<a href="#identifier-alignment-evaluation" class="auto internal xref">Section 4.10.2</a>.<a href="#section-4.10.1-3" class="pilcrow">¶</a></p>
<p id="section-4.10.1-4">If no valid DMARC Policy Record is found by the first query, then perform a DNS
Tree Walk to find the Author Domain's Organizational Domain or its Public
Suffix Domain. The starting point for this DNS Tree Walk is determined as
follows:<a href="#section-4.10.1-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.10.1-5.1">If the Author Domain has eight or fewer labels, the starting point will be
the immediate parent domain of the Author Domain.<a href="#section-4.10.1-5.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.10.1-5.2">Otherwise, the starting point will be the name produced by shortening the Author
Domain as described starting in step 3 of <a href="#dns-tree-walk" class="auto internal xref">Section 4.10</a>.<a href="#section-4.10.1-5.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.10.1-6">If the DMARC Policy Record to be applied is that of the Author Domain, then the
Domain Owner Assessment Policy is taken from the "p" tag of the record.<a href="#section-4.10.1-6" class="pilcrow">¶</a></p>
<p id="section-4.10.1-7">If the DMARC Policy Record to be applied is that of either the Organizational Domain or the
Public Suffix Domain and the Author Domain is a subdomain of that domain, then the Domain
Owner Assessment Policy is taken from the "sp" tag (if any) if the Author Domain exists,
or the "np" tag (if any) if the Author Domain does not exist. In the absence of
applicable "sp" or "np" tags, the "p" tag policy is used for subdomains.<a href="#section-4.10.1-7" class="pilcrow">¶</a></p>
<p id="section-4.10.1-8">If a retrieved DMARC Policy Record does not contain a valid "p" tag, or contains an "sp" or
"np" tag that is not valid, then:<a href="#section-4.10.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.10.1-9.1">
              <p id="section-4.10.1-9.1.1">If a "rua" tag is present and contains at least one syntactically valid reporting
URI, the Mail Receiver <span class="bcp14">MUST</span> act as if a record containing "p=none" was
retrieved and continue processing;<a href="#section-4.10.1-9.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.10.1-9.2">
              <p id="section-4.10.1-9.2.1">Otherwise, the Mail Receiver applies no DMARC processing to this message.<a href="#section-4.10.1-9.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.10.1-10">If the set produced by the DNS Tree Walk contains no DMARC Policy Record (i.e.,
any indication that there is no such record as opposed to a transient DNS error),
Mail Receivers <span class="bcp14">MUST NOT</span> apply the DMARC mechanism to the message.<a href="#section-4.10.1-10" class="pilcrow">¶</a></p>
<p id="section-4.10.1-11">Handling of DNS errors when querying for the DMARC Policy Record is
left to the discretion of the Mail Receiver. For example, to ensure
minimal disruption of mail flow, transient errors could result in
delivery of the message ("fail open"), or they could result in the
message being temporarily rejected (i.e., an SMTP 4yx reply), which
invites the sending MTA to try again after the condition has possibly
cleared, allowing a definite DMARC conclusion to be reached ("fail
closed").<a href="#section-4.10.1-11" class="pilcrow">¶</a></p>
<p id="section-4.10.1-12">Note: PSD policy is not used for Organizational Domains that have
published a DMARC Policy Record. Specifically, this is not a mechanism to
provide feedback addresses (rua/ruf) when an Organizational Domain has
declined to do so.<a href="#section-4.10.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identifier-alignment-evaluation">
<section id="section-4.10.2">
          <h4 id="name-identifier-alignment-evalua">
<a href="#section-4.10.2" class="section-number selfRef">4.10.2. </a><a href="#name-identifier-alignment-evalua" class="section-name selfRef">Identifier Alignment Evaluation</a>
          </h4>
<p id="section-4.10.2-1">It may be necessary to perform multiple DNS Tree Walks to determine if an
Authenticated Identifier and an Author Domain are in alignment, meaning
that they have either the same Organizational Domain (relaxed alignment) or
that they're identical (strict alignment). DNS Tree Walks done to discover an
Organizational Domain for use in Identifier Alignment Evaluation might start
at any of the following locations:<a href="#section-4.10.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.10.2-2.1">The Author Domain of the message being evaluated.<a href="#section-4.10.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.10.2-2.2">The SPF-Authenticated Identifier if there is an SPF pass result for the message
being evaluated.<a href="#section-4.10.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.10.2-2.3">Any DKIM-Authenticated Identifier if one or more DKIM pass results exist for
the message being evaluated.<a href="#section-4.10.2-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.10.2-3">Note: There is no need to perform Identifier Alignment Evaluations under any of
the following conditions:<a href="#section-4.10.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.10.2-4.1">The Author Domain and the Authenticated Identifier(s) are all the
same domain, and there is a DMARC Policy Record published for that domain.
In this case, this common domain is treated as the Organizational Domain.
For example, if the common domain in question is "mail.example.com", and
there is a valid DMARC Policy Record published at "_dmarc.mail.example.com",
then "mail.example.com" is the Organizational Domain.<a href="#section-4.10.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.10.2-4.2">No applicable DMARC Policy Record is discovered for the Author Domain. In
this case, the DMARC mechanism does not apply to the message in question.<a href="#section-4.10.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-4.10.2-4.3">The DMARC Policy Record for the Author Domain indicates strict alignment. In
this case, a simple string comparison of the Author Domain and the Authenticated
Identifier(s) is all that is required.<a href="#section-4.10.2-4.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.10.2-5">To discover the Organizational Domain for a domain, perform the DNS Tree Walk
described in <a href="#dns-tree-walk" class="auto internal xref">Section 4.10</a> as needed for any of the domains in question.<a href="#section-4.10.2-5" class="pilcrow">¶</a></p>
<p id="section-4.10.2-6">For each Tree Walk that retrieved valid DMARC Policy Records, select the Organizational
Domain from the domains for which valid DMARC Policy Records were retrieved from the longest
to the shortest:<a href="#section-4.10.2-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.10.2-7">
<li id="section-4.10.2-7.1">
              <p id="section-4.10.2-7.1.1">If a valid DMARC Policy Record contains the "psd" tag set to "n" ("psd=n"), this is the
Organizational Domain, and the selection process is complete.<a href="#section-4.10.2-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.10.2-7.2">
              <p id="section-4.10.2-7.2.1">If a valid DMARC Policy Record, other than the one for the domain where the tree
walk started, contains the "psd" tag set to "y" ("psd=y"), the Organizational
Domain is the domain one label below this one in the DNS hierarchy, and the
selection process is complete. For example, if in the course of a tree walk a DMARC
Policy Record is queried for at first "_dmarc.mail.example.com" and then "_dmarc.example.com",
and a valid DMARC Policy Record containing the "psd" tag set to "y" is found at
"_dmarc.example.com", then "mail.example.com" is the domain one label below "example.com"
in the DNS hierarchy and is thus the Organizational Domain.<a href="#section-4.10.2-7.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.10.2-7.3">
              <p id="section-4.10.2-7.3.1">Otherwise, select the DMARC Policy Record found at the name with the fewest number
of labels.  This is the Organizational Domain and the selection process is complete.<a href="#section-4.10.2-7.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-4.10.2-8">If this process does not determine the Organizational Domain, then the initial target
domain is the Organizational Domain.<a href="#section-4.10.2-8" class="pilcrow">¶</a></p>
<p id="section-4.10.2-9">For example, given the starting domain "a.mail.example.com", a search
for the Organizational Domain would require a series of DNS queries for DMARC Policy
Records starting with "_dmarc.a.mail.example.com" and finishing with "_dmarc.com".
If there are DMARC Policy Records published at "_dmarc.mail.example.com" and
"_dmarc.example.com", but not at "_dmarc.a.mail.example.com" or
"_dmarc.com", then the Organizational Domain for this domain would be
"example.com".<a href="#section-4.10.2-9" class="pilcrow">¶</a></p>
<p id="section-4.10.2-10">As another example, given the starting domain "a.mail.example.com", if a
search for the Organizational Domain yields a DMARC Policy Record at "_dmarc.mail.example.com"
with the "psd" tag set to "n", then the Organizational Domain for this domain would
be "mail.example.com".<a href="#section-4.10.2-10" class="pilcrow">¶</a></p>
<p id="section-4.10.2-11">As a last example, given the starting domain "a.mail.example.com", if a
search for the Organizational Domain only yields a DMARC Policy Record at "_dmarc.com"
and that record contains the tag "psd=y", then the Organizational Domain for
this domain would be "example.com".<a href="#section-4.10.2-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="dmarc-participation">
<section id="section-5">
      <h2 id="name-dmarc-participation">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-dmarc-participation" class="section-name selfRef">DMARC Participation</a>
      </h2>
<p id="section-5-1">This section describes the actions for participating in DMARC for each of
three unique entities - Domain Owners, PSOs, and Mail Receivers.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="domain-owner-actions">
<section id="section-5.1">
        <h3 id="name-domain-owner-actions">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-domain-owner-actions" class="section-name selfRef">Domain Owner Actions</a>
        </h3>
<p id="section-5.1-1">A <a href="#domain-owner">Domain Owner</a> wishing to fully participate in DMARC will
publish a <a href="#dmarc-policy-record">DMARC Policy Record</a> to cover each <a href="#author-domain">Author Domain</a> and corresponding <a href="#organizational-domain">Organizational Domain</a>
to which DMARC validation should apply, send email that produces at least one, and
preferably two, <a href="#authenticated-identifiers">Authenticated Identifiers</a> that align
with the Author Domain, will receive and monitor the content of DMARC aggregate
reports, and will correct any authentication shortcomings in mail making authorized
use of its domains.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The following sections describe how to achieve this.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div id="publish-an-spf-record-for-an-aligned-domain">
<section id="section-5.1.1">
          <h4 id="name-publish-an-spf-record-for-a">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-publish-an-spf-record-for-a" class="section-name selfRef">Publish an SPF Record for an Aligned Domain</a>
          </h4>
<p id="section-5.1.1-1">To configure SPF for DMARC, the Domain Owner <span class="bcp14">MUST</span> send mail that has
an RFC5321.MailFrom domain that will produce an <a href="#spf-identifiers">SPF-Authenticated
Identifier</a> that has <a href="#identifier-alignment-explained">Identifier Alignment</a>
with the Author Domain.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="configure-sending-system-for-dkim-signing-using-an-aligned-domain">
<section id="section-5.1.2">
          <h4 id="name-configure-sending-system-fo">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-configure-sending-system-fo" class="section-name selfRef">Configure Sending System for DKIM Signing Using an Aligned Domain</a>
          </h4>
<p id="section-5.1.2-1">To configure DKIM for DMARC, the Domain Owner <span class="bcp14">MUST</span> send mail that
has a <a href="#dkim-signing-domain">DKIM Signing Domain</a> that will produce a
<a href="#dkim-identifiers">DKIM-Authenticated Identifier</a> that
has <a href="#identifier-alignment-explained">Identifier Alignment</a> with the Author Domain.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="set-up-a-mailbox-to-receive-aggregate-reports">
<section id="section-5.1.3">
          <h4 id="name-set-up-a-mailbox-to-receive">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-set-up-a-mailbox-to-receive" class="section-name selfRef">Set Up a Mailbox to Receive Aggregate Reports</a>
          </h4>
<p id="section-5.1.3-1">Proper consumption and analysis of DMARC aggregate reports are essential
to any successful DMARC deployment for a Domain Owner. DMARC aggregate
reports, which are defined in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>,
contain valuable data for the Domain Owner, showing sources of mail
using the Author Domain.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="publish-a-dmarc-policy-record-for-the-author-domain-and-organizational-domain">
<section id="section-5.1.4">
          <h4 id="name-publish-a-dmarc-policy-reco">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-publish-a-dmarc-policy-reco" class="section-name selfRef">Publish a DMARC Policy Record for the Author Domain and Organizational Domain</a>
          </h4>
<p id="section-5.1.4-1">Once SPF, DKIM, and the aggregate reports mailbox are all in place,
it's time to publish a DMARC Policy Record. For best results, Domain Owners
usually start with "p=none", (see <a href="#collect-and-analyze" class="auto internal xref">Section 5.1.5</a>)
with the "rua" tag containing a URI that references the mailbox created
in the previous step. This is commonly referred to as putting the Author
Domain into <a href="#monitoring-mode">Monitoring Mode</a>. If the Organizational Domain
is different from the Author Domain, a record also needs to be published for the
Organizational Domain.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="collect-and-analyze">
<section id="section-5.1.5">
          <h4 id="name-collect-and-analyze-reports">
<a href="#section-5.1.5" class="section-number selfRef">5.1.5. </a><a href="#name-collect-and-analyze-reports" class="section-name selfRef">Collect and Analyze Reports</a>
          </h4>
<p id="section-5.1.5-1">The reason for starting at "p=none" is to ensure that nothing's been
missed in the initial SPF and DKIM deployments. In all but the most
trivial setups, a Domain Owner can overlook a server here or be unaware
of a third party sending agreement there.  Starting at "p=none", therefore,
takes advantage of DMARC's aggregate reporting function, with the Domain
Owner using the reports to audit its own mail streams' authentication
configurations.<a href="#section-5.1.5-1" class="pilcrow">¶</a></p>
<p id="section-5.1.5-2">While it is possible for a human to read aggregate reports, they are
formatted in such a way that it is recommended that they be machine-parsed,
so setting up a mailbox involves more than just the physical creation
of that mailbox. Many third-party services exist that will process DMARC
aggregate reports or the Domain Owner can create its own set of tools.
No matter which method is chosen, the ability to consume these reports and
parse the data contained in them will go a long way to ensuring a
successful deployment.<a href="#section-5.1.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="remediate-unaligned-or-unauthenticated-mail-streams">
<section id="section-5.1.6">
          <h4 id="name-remediate-unaligned-or-unau">
<a href="#section-5.1.6" class="section-number selfRef">5.1.6. </a><a href="#name-remediate-unaligned-or-unau" class="section-name selfRef">Remediate Unaligned or Unauthenticated Mail Streams</a>
          </h4>
<p id="section-5.1.6-1">DMARC aggregate reports can reveal to the Domain Owner mail streams using the
Author Domain but not passing DMARC validation checks. These mail streams may
be a combination of illegitimate uses of the domain, such as spoofing or other
attempted abuse, and legitimate uses, as in the case of a mail stream created
by an agent of the Domain Owner but one with is not passing is due to Authenticated
Identifiers being unaligned or missing entirely. For such legitimate uses, these
shortcomings <span class="bcp14">MUST</span> be addressed prior to any attempt by the Domain Owner to
publish a <a href="#domain-owner-policy">Domain Owner Assessment Policy</a> of
<a href="#enforcement">Enforcement</a> for the Author Domain.<a href="#section-5.1.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="decide-whether-to-update-domain-owner-assessment-policy-to-enforcement">
<section id="section-5.1.7">
          <h4 id="name-decide-whether-to-update-do">
<a href="#section-5.1.7" class="section-number selfRef">5.1.7. </a><a href="#name-decide-whether-to-update-do" class="section-name selfRef">Decide Whether to Update Domain Owner Assessment Policy to Enforcement</a>
          </h4>
<p id="section-5.1.7-1">Once the Domain Owner is satisfied that it is properly authenticating
all of its mail, then it is time to decide if it is appropriate to
change its Domain Owner Assessment Policy to <a href="#enforcement">Enforcement</a>.
Depending on its cadence for sending mail, it may take many months
of consuming DMARC aggregate reports before a Domain Owner reaches
the point where it is sure that it is properly authenticating all
of its mail, and the decision on which "p" value to use will depend
on its needs.<a href="#section-5.1.7-1" class="pilcrow">¶</a></p>
<p id="section-5.1.7-2">In making this decision it is important to understand the
interoperability issues involved and problems that can result for
mailing lists and for delivery of legitimate mail. Those
issues are discussed in detail in <a href="#interoperability-considerations" class="auto internal xref">Section 7.4</a><a href="#section-5.1.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="a-note-on-large-complex-organizations-and-decentralized-dns-management">
<section id="section-5.1.8">
          <h4 id="name-a-note-on-large-complex-org">
<a href="#section-5.1.8" class="section-number selfRef">5.1.8. </a><a href="#name-a-note-on-large-complex-org" class="section-name selfRef">A Note on Large, Complex Organizations and Decentralized DNS Management</a>
          </h4>
<p id="section-5.1.8-1">Large, complex organizations frequently adopt a decentralized model for
DNS management, whereby management of a subtree of the name space is delegated
to a local department by the central IT organization. In such situations, the
"psd" tag makes it possible for those local departments to declare any arbitrary
node in their subtree as an Organizational Domain. This would be accomplished by
publishing a DMARC Policy Record at that node with the "psd" tag set to "n". The
reasons that departments might declare their own Organizational Domains include a
desire to have different policy settings or reporting URIs than the DMARC Policy Record
published for the apex domain.<a href="#section-5.1.8-1" class="pilcrow">¶</a></p>
<p id="section-5.1.8-2">Such configurations would work in theory, and they might involve domain names with
many labels, reflecting the structure of the organization, for example:<a href="#section-5.1.8-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1.8-3.1">Apex domain (DMARC Policy Record published here): example.com<a href="#section-5.1.8-3.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.8-3.2">Zone cut domain (DMARC Policy Record with "psd=n" published here): b.c.d.e.f.g.example.com<a href="#section-5.1.8-3.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.8-3.3">Author Domain: mail.a.b.c.d.e.f.g.example.com<a href="#section-5.1.8-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.1.8-4">However, Domain Owners should be aware that due to the anti-abuse protections
built into the <a href="#dns-tree-walk">DNS Tree Walk</a>, the DMARC Policy Record published
at the zone cut domain in this example will never be discovered. A Mail Receiver
performing a Tree Walk would only perform queries for these names:<a href="#section-5.1.8-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.1.8-5.1">_dmarc.mail.a.b.c.d.e.f.g.example.com<a href="#section-5.1.8-5.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.8-5.2">_dmarc.c.d.e.f.g.example.com<a href="#section-5.1.8-5.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.8-5.3">_dmarc.d.e.f.g.example.com<a href="#section-5.1.8-5.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.8-5.4">_dmarc.e.f.g.example.com<a href="#section-5.1.8-5.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.8-5.5">_dmarc.f.g.example.com<a href="#section-5.1.8-5.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.8-5.6">_dmarc.g.example.com<a href="#section-5.1.8-5.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.8-5.7">_dmarc.example.com<a href="#section-5.1.8-5.7" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.1.8-5.8">_dmarc.com<a href="#section-5.1.8-5.8" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.1.8-6">To avoid this circumstance, Domain Owners wishing to have a specific DMARC Policy
Record applied to a given [Author Domain]{#author-domain) longer than eight labels
<span class="bcp14">MUST</span> publish a DMARC Policy Record at that domain's location in the DNS namespace,
as such records are always queried by Mail Receivers that participate in DMARC before
the Tree Walk begins.  In the above example, this would mean publishing a DMARC Policy
Record at the name "_dmarc.mail.a.b.c.d.e.f.g.example.com.".<a href="#section-5.1.8-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pso-actions">
<section id="section-5.2">
        <h3 id="name-pso-actions">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-pso-actions" class="section-name selfRef">PSO Actions</a>
        </h3>
<p id="section-5.2-1">In addition to the DMARC Domain Owner actions, if a <a href="#public-suffix-operator">PSO</a>
publishes a DMARC Policy Record it <span class="bcp14">MUST</span> include the "psd" tag (see <a href="#policy-record-format" class="auto internal xref">Section 4.7</a>)
with a value of "y" ("psd=y").<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mail-receiver-actions">
<section id="section-5.3">
        <h3 id="name-mail-receiver-actions">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-mail-receiver-actions" class="section-name selfRef">Mail Receiver Actions</a>
        </h3>
<p id="section-5.3-1"><a href="#mail-receiver">Mail Receivers</a> wishing to fully participate in DMARC
will apply the DMARC mechanism to inbound email messages when a <a href="#dmarc-policy-record">DMARC
Policy Record</a> exists that applies to the <a href="#author-domain">Author
Domain</a>, and will send aggregate feedback reports to Domain
Owners that request them. Mail Receivers might also send failure reports
to Domain Owners that request them. The following sections describe how
to achieve this.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">The steps for applying the DMARC mechanism to an email message can take
place during the SMTP transaction, and should do so if the Mail Receiver
plans to honor <a href="#domain-owner-policy">Domain Owner Assessment Policies</a> that
are at the <a href="#enforcement">Enforcement</a> state.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">Many Mail Receivers perform one or both of the underlying <a href="#authentication-mechanisms">Authentication
Mechanisms</a> on inbound messages even in cases
where no DMARC Policy Record exists for the Author Domain of a given message,
or where the Mail Receiver is not participating in DMARC. Nothing in this
section is intended to imply that the underlying Authentication Mechanisms
should only be performed by Mail Receivers participating in DMARC.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<div id="extract-author-domain">
<section id="section-5.3.1">
          <h4 id="name-extract-author-domain">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-extract-author-domain" class="section-name selfRef">Extract Author Domain</a>
          </h4>
<p id="section-5.3.1-1">Once the email message has been transmitted to the Mail Receiver, the Mail
Receiver extracts the domain in the RFC5322.From header field as the Author
Domain. If the domain is a U-label, the domain <span class="bcp14">MUST</span> be converted to an
A-label, as described in Section 2.3 of <span>[<a href="#RFC5890" class="cite xref">RFC5890</a>]</span>, for further processing.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">If zero or more than one domain is extracted from the RFC5322.From header
field, then DMARC validation is not possible and the process terminates.
In the case where more than one domain is retrieved, the Mail Receiver
<span class="bcp14">MAY</span> choose to go forward with DMARC validation anyway. See
<a href="#denial-of-dmarc-attacks" class="auto internal xref">Section 11.5</a> for further discussion.<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="determine-mechanism-applies">
<section id="section-5.3.2">
          <h4 id="name-determine-if-the-dmarc-mech">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-determine-if-the-dmarc-mech" class="section-name selfRef">Determine If The DMARC Mechanism Applies</a>
          </h4>
<p id="section-5.3.2-1">If precisely one Author Domain exists for the message, then perform the
step described in <a href="#dmarc-policy-discovery">DMARC Policy Discovery</a> to determine
if the DMARC mechanism applies. If a <a href="#dmarc-policy-record">DMARC Policy Record</a> is not
discovered during this step, then the DMARC mechanism does not apply and
DMARC validation terminates for the message.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="determine-authenticated-identifiers">
<section id="section-5.3.3">
          <h4 id="name-determine-if-authenticated-">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-determine-if-authenticated-" class="section-name selfRef">Determine If Authenticated Identifiers Exist</a>
          </h4>
<p id="section-5.3.3-1">For each Authentication Mechanism underlying DMARC, perform the required
check to determine if an <a href="#authenticated-identifier">Authenticated Identifier</a>
exists for the message if such check has not already been performed. Results from
each check must be preserved for later use as follows:<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5.3.3-2.1">For SPF, the preserved results <span class="bcp14">MUST</span> include "pass" or "fail", and if "fail", <span class="bcp14">SHOULD</span>
include information about the reasons for failure if available. The results <span class="bcp14">MUST</span> further
include the domain name used to complete the SPF check.<a href="#section-5.3.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5.3.3-2.2">For DKIM signature validation checks, for each signature checked, the
results <span class="bcp14">MUST</span> include "pass" or "fail", and if "fail", <span class="bcp14">SHOULD</span> include
information about the reasons for failure. The results <span class="bcp14">MUST</span> further include
the value of the "d" and "s" tags from each checked DKIM signature.<a href="#section-5.3.3-2.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="conduct-alignment-checks">
<section id="section-5.3.4">
          <h4 id="name-conduct-identifier-alignmen">
<a href="#section-5.3.4" class="section-number selfRef">5.3.4. </a><a href="#name-conduct-identifier-alignmen" class="section-name selfRef">Conduct Identifier Alignment Checks If Necessary</a>
          </h4>
<p id="section-5.3.4-1">For each Authenticated Identifier found in the message, the Mail Receiver checks
to see if the Authenticated Identifier is <a href="#identifier-alignment-evaluation">aligned</a>
with the Author Domain.<a href="#section-5.3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pass-or-fail">
<section id="section-5.3.5">
          <h4 id="name-determine-dmarc-pass-or-fai">
<a href="#section-5.3.5" class="section-number selfRef">5.3.5. </a><a href="#name-determine-dmarc-pass-or-fai" class="section-name selfRef">Determine DMARC "Pass" or "Fail"</a>
          </h4>
<p id="section-5.3.5-1">If one or more of the Authenticated Identifiers align with the Author Domain, the
message is considered to pass the DMARC mechanism check.<a href="#section-5.3.5-1" class="pilcrow">¶</a></p>
<p id="section-5.3.5-2">If no Authenticated Identifiers exist for the domain, or none of the Authenticated
Identifiers align with the Author Domain, the message is considered to fail the
DMARC mechanism check.<a href="#section-5.3.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="apply-policy">
<section id="section-5.3.6">
          <h4 id="name-apply-policy-if-appropriate">
<a href="#section-5.3.6" class="section-number selfRef">5.3.6. </a><a href="#name-apply-policy-if-appropriate" class="section-name selfRef">Apply Policy If Appropriate</a>
          </h4>
<p id="section-5.3.6-1">Email messages that fail the DMARC mechanism check are handled in accordance with
the Mail Receiver's local policies. These local policies may take into account the Domain
Owner Assessment Policy for the Author Domain at the Mail Receiver's discretion.<a href="#section-5.3.6-1" class="pilcrow">¶</a></p>
<p id="section-5.3.6-2">If one or more DNS queries required to perform DMARC validation on the message
do not complete due to temporary or permanent DNS errors, the message cannot be
considered to pass or fail the DMARC mechanism check. In such cases, the Domain
Owner Assessment Policy cannot be applied to the message, and any other handling
decisions for the message are left to the discretion of the Mail Receiver.<a href="#section-5.3.6-2" class="pilcrow">¶</a></p>
<p id="section-5.3.6-3">See <a href="#rejecting-messages" class="auto internal xref">Section 7.2</a> for further discussion of topics regarding rejecting messages.<a href="#section-5.3.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="store-results-of-dmarc-processing">
<section id="section-5.3.7">
          <h4 id="name-store-results-of-dmarc-proc">
<a href="#section-5.3.7" class="section-number selfRef">5.3.7. </a><a href="#name-store-results-of-dmarc-proc" class="section-name selfRef">Store Results of DMARC Processing</a>
          </h4>
<p id="section-5.3.7-1">If the Mail Receiver intends to send aggregate feedback reports and/or failure reports,
then results obtained from the application of the DMARC mechanism by the Mail Receiver
<span class="bcp14">MUST</span> be preserved for eventual presentation back to the Domain Owner in the form
of such reports. <a href="#policy-record-format" class="auto internal xref">Section 4.7</a> and <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>
discuss aggregate feedback reports.<a href="#section-5.3.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="send-aggregate-reports">
<section id="section-5.3.8">
          <h4 id="name-send-aggregate-reports">
<a href="#section-5.3.8" class="section-number selfRef">5.3.8. </a><a href="#name-send-aggregate-reports" class="section-name selfRef">Send Aggregate Reports</a>
          </h4>
<p id="section-5.3.8-1">To ensure maximum usefulness for DMARC across the email ecosystem, Mail
Receivers <span class="bcp14">SHOULD</span> generate and send aggregate reports with a frequency
of at least once every 24 hours. Such reports provide Domain Owners with
insight into all mail streams using Author Domains under the Domain Owner's
control, and aid the Domain Owner in determining whether and when to transition
from <a href="#monitoring-mode">Monitoring Mode</a> to <a href="#enforcement">Enforcement</a>.<a href="#section-5.3.8-1" class="pilcrow">¶</a></p>
<p id="section-5.3.8-2">The most common reasons for a Mail Receiver to opt out of sending aggregate
reports include resource constraints, local policy against sharing data, and
concerns about user privacy.<a href="#section-5.3.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="send-failure-reports">
<section id="section-5.3.9">
          <h4 id="name-optionally-send-failure-rep">
<a href="#section-5.3.9" class="section-number selfRef">5.3.9. </a><a href="#name-optionally-send-failure-rep" class="section-name selfRef">Optionally Send Failure Reports</a>
          </h4>
<p id="section-5.3.9-1">Per-message failure reports can be a useful source of information for a Domain
Owner, either for debugging deployments or in analyzing attacks, and so Mail
Receivers <span class="bcp14">MAY</span> choose to send them.  Experience has shown, however, that Mail
Receivers rightly concerned about protecting user privacy have either chosen to
heavily redact the information in such reports (which can hinder their usefulness)
or not send them at all.  See <span>[<a href="#I-D.ietf-dmarc-failure-reporting" class="cite xref">I-D.ietf-dmarc-failure-reporting</a>]</span> for further information.<a href="#section-5.3.9-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="policy-enforcement-considerations">
<section id="section-5.4">
        <h3 id="name-policy-enforcement-consider">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-policy-enforcement-consider" class="section-name selfRef">Policy Enforcement Considerations</a>
        </h3>
<p id="section-5.4-1">The final handling of any message is always a matter of local policy and is
left to the discretion of the Mail Receiver.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">A DMARC pass for a message indicates only that the use of the <a href="#author-domain">Author Domain</a>
has been validated for that message as authorized by the <a href="#domain-owner">Domain Owner</a>.
Such authorization does not carry an explicit or implicit value assertion about
that message or the Domain Owner, and Mail Receivers <span class="bcp14">MAY</span> choose to reject or
quarantine a message even if it passes the DMARC validation check.  Mail Receivers
are encouraged to maintain anti-abuse technologies to combat the possibility of
DMARC-enabled criminal campaigns.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">Mail Receivers <span class="bcp14">MAY</span> choose to accept email that fails the DMARC
validation check even if the published Domain Owner Assessment Policy
is "reject". In particular, because of the considerations discussed
in <span>[<a href="#RFC7960" class="cite xref">RFC7960</a>]</span> and in <a href="#interoperability-considerations" class="auto internal xref">Section 7.4</a> of this document, it is important that Mail
Receivers <span class="bcp14">SHOULD NOT</span> reject messages solely because of a published policy of "reject",
but that they apply other knowledge and analysis to avoid situations such as rejection
of legitimate messages sent in ways that DMARC cannot describe, harm to the operation of
mailing lists, and similar.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">If a Mail Receiver chooses not to honor the published Domain Owner
Assessment Policy to improve interoperability among mail systems, it may
increase the likelihood of accepting abusive mail.  At a minimum, Mail
Receivers <span class="bcp14">SHOULD</span> add the Authentication-Results header field (see
<span>[<a href="#RFC8601" class="cite xref">RFC8601</a>]</span>), and it is <span class="bcp14">RECOMMENDED</span> when delivering messages that fail the DMARC validation check.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5">When Mail Receivers deviate from a published Domain Owner
Assessment Policy during message processing they <span class="bcp14">SHOULD</span> make
available the fact of and reason for the deviation to the Domain
Owner via feedback reporting, specifically using the
"PolicyOverride" feature of the aggregate report defined in
<span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<p id="section-5.4-6">To enable Domain Owners to receive DMARC feedback without impacting
existing mail processing, discovered policies of "p=none" <span class="bcp14">MUST NOT</span>
modify existing mail handling processes.<a href="#section-5.4-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dmarc-feedback">
<section id="section-6">
      <h2 id="name-dmarc-feedback">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-dmarc-feedback" class="section-name selfRef">DMARC Feedback</a>
      </h2>
<p id="section-6-1">DMARC Feedback is described in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span><a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">As an operational note for Public Suffix Operators, feedback for non-existent
domains can be desirable and useful, just as it can be for Organizational
Domains. Therefore, both such entities should consider including "rua=" tags
in any DMARC Policy Records they publish for themselves. See <a href="#privacy-considerations" class="auto internal xref">Section 10</a>
for discussion of Privacy Considerations.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-topics">
<section id="section-7">
      <h2 id="name-other-topics">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-other-topics" class="section-name selfRef">Other Topics</a>
      </h2>
<p id="section-7-1">This section discusses some topics regarding choices made in the
development of DMARC, largely to commit the history to record.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="issues-specific-to-spf">
<section id="section-7.1">
        <h3 id="name-issues-specific-to-spf">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-issues-specific-to-spf" class="section-name selfRef">Issues Specific to SPF</a>
        </h3>
<p id="section-7.1-1">Though DMARC does not inherently change the semantics of an SPF
policy record, historically lax enforcement of such policies has led
many to publish extremely broad records containing many extensive network
ranges. <a href="#domain-owner">Domain Owners</a> are strongly encouraged to carefully review
their SPF records to understand which networks are authorized to send
on behalf of the Domain Owner before publishing a DMARC Policy Record. Furthermore,
Domain Owners should periodically review their SPF records to ensure that
the authorization conveyed by the records matches the domain's current needs.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">SPF was intended to be implemented early in the SMTP transaction, meaning it's
possible for a message to fail SPF validation prior to any message content being
transmitted, and so some Mail Receiver architectures might implement SPF in
advance of any DMARC operations. This means that an SPF hard fail ("-") prefix
on a sender's SPF mechanism, such as "-all", could cause a message to be rejected early in
the SMTP transaction, before any DMARC processing takes place, if the message
fails SPF authentication checks.  Domain Owners choosing to use "-all" to terminate
SPF records should be aware of this, and should understand that messages that
might otherwise pass DMARC due to an aligned <a href="#dkim-identifiers">DKIM-Authenticated Identifier</a> could be rejected solely due to an SPF fail.
Moreover, messages rejected early in the SMTP transaction will never appear in
aggregate DMARC reports, as the transaction will never proceed to the DATA phase
and so the RFC5322.From domain will never be revealed and its DMARC policy will
never be discovered.  Domain Owners and <a href="#mail-receiver">Mail Receivers</a> can consult
<span>[<a href="#M3SPF" class="cite xref">M3SPF</a>]</span> and <span>[<a href="#M3AUTH" class="cite xref">M3AUTH</a>]</span> for more discussion of the topic and best practices
regarding publishing SPF records and when to reject based solely on SPF failure:<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rejecting-messages">
<section id="section-7.2">
        <h3 id="name-rejecting-messages">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-rejecting-messages" class="section-name selfRef">Rejecting Messages</a>
        </h3>
<p id="section-7.2-1">The DMARC mechanism calls for rejection of a message during the SMTP
session under certain circumstances. This is preferable to
generation of a Delivery Status Notification
<span>[<a href="#RFC3464" class="cite xref">RFC3464</a>]</span>, since fraudulent messages caught and rejected using the DMARC
mechanism would then result in the annoying generation of such failure reports
that go back to the RFC5321.MailFrom address.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">This synchronous rejection is typically done in one of two ways:<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-3.1">
            <p id="section-7.2-3.1.1">Full rejection, wherein the SMTP server issues a 5xy reply code to the
DATA command as an indication to the SMTP client that the transaction failed;
the SMTP client is then responsible for generating a notification that
delivery failed (see <span><a href="https://rfc-editor.org/rfc/rfc5321#section-4.2.5" class="relref">Section 4.2.5</a> of [<a href="#RFC5321" class="cite xref">RFC5321</a>]</span>).<a href="#section-7.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.2-3.2">
            <p id="section-7.2-3.2.1">A "silent discard", wherein the SMTP server returns a 2xy reply
code implying to the client that delivery (or, at least, relay)
was successfully completed, but then simply discards the message
with no further action.<a href="#section-7.2-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.2-4">Each of these has a cost. For instance, a silent discard can help to
prevent backscatter, but it also effectively means that the SMTP
server has to be programmed to give a false result, which can
confound external debugging efforts.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">Similarly, the text portion of the SMTP reply may be important to
consider. For example, when rejecting a message, revealing the
reason for the rejection might give an attacker enough information to
bypass those efforts on a later attempt, though it might also assist
a legitimate client to determine the source of some local issue that
caused the rejection.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">In the latter case, when doing an SMTP rejection, providing a clear
hint can be useful in resolving issues. A <a href="#mail-receiver">Mail Receiver</a>
might indicate in plain text the reason for the rejection by using the
word "DMARC" somewhere in the reply text. For example:<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-7">
<pre>550 5.7.1 Email rejected per DMARC policy for example.com
</pre><a href="#section-7.2-7" class="pilcrow">¶</a>
</div>
<p id="section-7.2-8">Many systems are able to scan the SMTP reply text to determine the nature
of the rejection. Thus, providing a machine-detectable reason for rejection
allows the problems causing rejections to be properly addressed by automated systems.<a href="#section-7.2-8" class="pilcrow">¶</a></p>
<p id="section-7.2-9">If a Mail Receiver elects to defer delivery due to the inability to
retrieve or apply DMARC policy, this is best done with a 4xy SMTP
reply code.<a href="#section-7.2-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interoperability-issues">
<section id="section-7.3">
        <h3 id="name-interoperability-issues">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-interoperability-issues" class="section-name selfRef">Interoperability Issues</a>
        </h3>
<p id="section-7.3-1">DMARC limits which end-to-end scenarios can achieve a "pass" result.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">Because DMARC relies on SPF <span>[<a href="#RFC7208" class="cite xref">RFC7208</a>]</span> and/or DKIM <span>[<a href="#RFC6376" class="cite xref">RFC6376</a>]</span> to achieve
a "pass", their limitations also apply.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">Issues specific to the use of policy mechanisms alongside DKIM are
further discussed in <span>[<a href="#RFC6377" class="cite xref">RFC6377</a>]</span>, particularly Section 5.2.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">Mail that is sent by authorized, independent third parties might not be
sent with Identifier Alignment, also preventing a "pass" result. A Domain
Owner can use DMARC aggregate reports to identify this mail and take steps
to address authentication shortcomings.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interoperability-considerations">
<section id="section-7.4">
        <h3 id="name-interoperability-considerat">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-interoperability-considerat" class="section-name selfRef">Interoperability Considerations</a>
        </h3>
<p id="section-7.4-1">As discussed in "Interoperability Issues between DMARC and Indirect
Email Flows" <span>[<a href="#RFC7960" class="cite xref">RFC7960</a>]</span>, use of "p=reject" can be incompatible with and
cause interoperability problems to indirect message flows such as
"alumni forwarders", role-based email aliases, and mailing lists
across the Internet.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">As an example of this, a bank might send only targeted messages to
account holders. Those account holders might have given their bank
addresses such as "jones@alumni.example.edu" (an address that relays
the messages to another address with a real mailbox) or
"finance@association.example" (a role-based address that does similar
relaying for the current head of finance at the association).  When
such mail is delivered to the actual recipient mailbox, it will
most likely fail SPF checks unless the RFC5321.MailFrom address is
rewritten by the relaying MTA, as the incoming IP address will be that
of "example.edu" or "association.example", and not an IP address authorized
by the originating RFC5321.MailFrom domain. DKIM signatures will generally
remain valid in these relay situations.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<blockquote id="section-7.4-3">
          <p id="section-7.4-3.1">It is therefore critical that domains that publish "p=reject"
<span class="bcp14">MUST NOT</span> rely solely on SPF to secure a DMARC pass, and
<span class="bcp14">MUST</span> apply valid DKIM signatures to their messages.<a href="#section-7.4-3.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-7.4-4">In the case of domains that have general users who send routine email,
those that publish a <a href="#domain-owner-policy">Domain Owner Assessment Policy</a>
of "p=reject" are likely to create significant interoperability
issues. In particular, if users in such domains post messages to mailing
lists on the Internet, those messages can cause significant operational problems
for the mailing lists and for the subscribers to those lists, as explained below and
in <span>[<a href="#RFC7960" class="cite xref">RFC7960</a>]</span>.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
<blockquote id="section-7.4-5">
          <p id="section-7.4-5.1">It is therefore critical that domains that host users who might
post messages to mailing lists <span class="bcp14">SHOULD NOT</span> publish Domain Owner Assessment Policies
of "p=reject". Any such domains wishing to publish "p=reject" <span class="bcp14">SHOULD</span> first
take advantage of DMARC aggregate report data for their domain to
determine the possible impact to their users, first by publishing
"p=none" for at least a month, followed by publishing "p=quarantine" for
an equally long period of time, and comparing the message disposition
results. Domains that choose to publish "p=reject" <span class="bcp14">SHOULD</span> either
implement policies that their users not post to Internet mailing lists
and/or inform their users that their participation in mailing lists may
be hindered.<a href="#section-7.4-5.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-7.4-6">As noted in <a href="#policy-enforcement-considerations" class="auto internal xref">Section 5.4</a>, <a href="#mail-receivers">Mail Receivers</a>
need to apply more analysis than just DMARC validation in their
disposition of incoming messages.  An example of the consequences of
honoring a Domain Owner Assessment Policy of "p=reject" without further analysis
is that rejecting messages that have been relayed by a mailing list can cause
the Mail Receiver's users to have their subscriptions to that mailing list canceled
by the list software's automated handling of such rejections - it looks
to the list manager as though the recipient's email address is no
longer working, so the address is automatically unsubscribed. An example of this
scenario, albeit with DKIM Author Domain Signing Practices (ADSP) rather than DMARC,
can be found in <span><a href="https://rfc-editor.org/rfc/rfc6377#section-5.2" class="relref">Section 5.2</a> of [<a href="#RFC6377" class="cite xref">RFC6377</a>]</span>.<a href="#section-7.4-6" class="pilcrow">¶</a></p>
<blockquote id="section-7.4-7">
          <p id="section-7.4-7.1">It is therefore critical that Mail Receivers <span class="bcp14">MUST NOT</span> reject
incoming messages solely on the basis of a "p=reject" policy by
the sending domain.  Mail Receivers must use the DMARC
policy as part of their disposition decision, along with other
knowledge and analysis. "Other knowledge and analysis" here might
refer to observed sending patterns for properly-authenticated mail
using the sending domain, content filtering, etc. In the absence of
other knowledge and analysis, Mail Receivers <span class="bcp14">MUST</span> treat such failing
mail as if the policy were "p=quarantine" rather than "p=reject".<a href="#section-7.4-7.1" class="pilcrow">¶</a></p>
</blockquote>
<p id="section-7.4-8">Failure to understand and abide by these considerations can cause
legitimate, sometimes important email to be rejected, can cause
operational damage to mailing lists throughout the Internet, and
can result in trouble-desk calls and complaints from the Mail Receiver's
employees, customers, and clients.<a href="#section-7.4-8" class="pilcrow">¶</a></p>
<p id="section-7.4-9">In practice, despite this advice, few Mail Receivers apply any mitigation
techniques when receiving indirect mail flows, few organizations consider
the effect of DMARC policies on their users' indirect mail, and it is unlikely
that any advice in this document will change that. As a result, mail forwarded
through mailing lists with unmodified From: header lines is frequently rejected
due to a p=reject policy.<a href="#section-7.4-9" class="pilcrow">¶</a></p>
<p id="section-7.4-10">In the ten years since large consumer mail systems started publishing p=reject
policies, mailing list software has all adopted workarounds to make the From:
header line DMARC aligned. Some simply use the list's address, while others do
per-address modifications intended to be reversible or to allow mail to be
forwarded back to the original author, e.g., bob@example.com turned into
bob=example.com@user.somelist.example. While these workarounds are far from
ideal, they are firmly established and list operators treat them as a fact of life.<a href="#section-7.4-10" class="pilcrow">¶</a></p>
<p id="section-7.4-11">Mail developers have been trying for a decade to invent technical methods
to allow mailing lists to continue to work without modifying the From: header
line, with a prominent example being the Authenticated Received Chain (ARC)
protocol described in <span>[<a href="#RFC8617" class="cite xref">RFC8617</a>]</span>.  While work continues, as of this document's
publication, none of the methods have become widely used. Should such a technical
method achieve widespread adoption in the future, this document can be updated to
reflect that.<a href="#section-7.4-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conformance-requirements">
<section id="section-8">
      <h2 id="name-conformance-requirements-fo">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-conformance-requirements-fo" class="section-name selfRef">Conformance Requirements for Full DMARC Participation</a>
      </h2>
<p id="section-8-1">This document describes the DMARC mechanism, and allows Domain Owners and Mail Receivers
some leeway in deciding which parts of the mechanism to implement. This section summarizes
the requirements for full participation in DMARC, either by Domain Owners or by Mail Receivers.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">In order to fully participate in DMARC, Domain Owners:<a href="#section-8-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8-3.1">
          <span class="bcp14">MUST</span> send mail so it produces an SPF-Authenticated identifier that has Identifier
Alignment with the Author Domain<a href="#section-8-3.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-3.2">
          <span class="bcp14">MUST</span> send mail that has a DKIM Signing Domain that will produce a DKIM-Authenticated
Identifier that has Identifier Alignment with the Author Domain<a href="#section-8-3.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-3.3">
          <span class="bcp14">MUST</span> set up a mailbox to receive aggregate reports and collect and analyze those reports<a href="#section-8-3.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-3.4">
          <span class="bcp14">MUST</span> publish a DMARC Policy Record for the Author Domain and the Organizational Domain,
if it differs from the Author Domain<a href="#section-8-3.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-3.5">
          <span class="bcp14">MUST NOT</span> rely solely on SPF for a DMARC pass if the DMARC policy for the Author Domain
is "p=reject"<a href="#section-8-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-4">In order to fully participate in DMARC, Mail Receivers<a href="#section-8-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-8-5.1">
          <span class="bcp14">MUST</span> check for the existence of a DMARC Policy Record for the Author Domain of an inbound
mail message to determine if the DMARC mechanism applies to that message.<a href="#section-8-5.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-5.2">
          <span class="bcp14">MUST</span> determine if Authenticated Identifiers exist for the message and preserve the results of those
checks for future use in reportging if the DMARC mechanism applies to the message<a href="#section-8-5.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-5.3">
          <span class="bcp14">MUST</span> conduct necessary Identifier Alignmeent checks if the DMARC mechanism applies for the message and
Authenticated Identifiers exist<a href="#section-8-5.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-5.4">
          <span class="bcp14">MUST</span> use the information from the checks for Authenticated Identifiers to determine if the DMARC
validation result is "pass" or "fail" for the message.<a href="#section-8-5.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-5.5">
          <span class="bcp14">MUST</span> support the "mailto:" URI for sending requested reports<a href="#section-8-5.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-5.6">
          <span class="bcp14">SHOULD</span> send aggregate reports on at least a daily basis<a href="#section-8-5.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-8-5.7">
          <span class="bcp14">MUST NOT</span> reject messages solely on the basis of a "p=reject" policy for the Author Domain<a href="#section-8-5.7" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This section describes actions completed by IANA.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="authentication-results-method-registry-update">
<section id="section-9.1">
        <h3 id="name-authentication-results-meth">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-authentication-results-meth" class="section-name selfRef">Authentication-Results Method Registry Update</a>
        </h3>
<p id="section-9.1-1">IANA has added the following to the "Email Authentication Methods"
registry:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<span id="name-authentication-results-metho"></span><table class="left" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-authentication-results-metho" class="selfRef">"Authentication-Results Method Registry Update"</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Method</th>
              <th class="text-left" rowspan="1" colspan="1">Defined</th>
              <th class="text-left" rowspan="1" colspan="1">ptype</th>
              <th class="text-left" rowspan="1" colspan="1">Property</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Status</th>
              <th class="text-left" rowspan="1" colspan="1">Version</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dmarc</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">header</td>
              <td class="text-left" rowspan="1" colspan="1">from</td>
              <td class="text-left" rowspan="1" colspan="1">the domain portion of the RFC5322.From header field</td>
              <td class="text-left" rowspan="1" colspan="1">active</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dmarc</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">policy</td>
              <td class="text-left" rowspan="1" colspan="1">dmarc</td>
              <td class="text-left" rowspan="1" colspan="1">Evaluated DMARC policy applied/to be applied after policy options have been processed. Must be none, quarantine, or reject.</td>
              <td class="text-left" rowspan="1" colspan="1">active</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="authentication-results-result-registry-update">
<section id="section-9.2">
        <h3 id="name-authentication-results-resu">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-authentication-results-resu" class="section-name selfRef">Authentication-Results Result Registry Update</a>
        </h3>
<p id="section-9.2-1">IANA has added the following in the "Email Authentication Result
Names" registry:<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<span id="name-authentication-results-resul"></span><table class="left" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-authentication-results-resul" class="selfRef">"Authentication-Results Result Registry Update"</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Auth Method(s)</th>
              <th class="text-left" rowspan="1" colspan="1">Code</th>
              <th class="text-left" rowspan="1" colspan="1">Specification</th>
              <th class="text-left" rowspan="1" colspan="1">Status</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dmarc</td>
              <td class="text-left" rowspan="1" colspan="1">fail</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">active</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dmarc</td>
              <td class="text-left" rowspan="1" colspan="1">none</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">active</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dmarc</td>
              <td class="text-left" rowspan="1" colspan="1">pass</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">active</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dmarc</td>
              <td class="text-left" rowspan="1" colspan="1">permerror</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">active</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">dmarc</td>
              <td class="text-left" rowspan="1" colspan="1">temperror</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">active</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="dmarc-tag-registry">
<section id="section-9.3">
        <h3 id="name-dmarc-tag-registry">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-dmarc-tag-registry" class="section-name selfRef">DMARC Tag Registry</a>
        </h3>
<p id="section-9.3-1">A registry tree called "Domain-based Message Authentication,
Reporting, and Conformance (DMARC) Parameters" exists, and it
and any sub-registries thereunder should be updated to reference
this document.  Within it, a new sub-registry called the "DMARC
Tag Registry" exists.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">Names of DMARC tags are registered with IANA in this sub-registry. Entries
are assigned only for values that have been documented in a manner that
satisfies the terms of Specification Required, per <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Each
registration includes the tag name; the specification that defines it;
a brief description; and its status, which is one of "current", "experimental",
or "historic". The Designated Expert needs to confirm that the provided
specification adequately describes the new tag and clearly presents
how it would be used within the DMARC context by Domain Owners and
Mail Receivers.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
<p id="section-9.3-3">To avoid version compatibility issues, tags added to the DMARC
specification are to avoid changing the semantics of existing records
when processed by implementations conforming to prior specifications.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
<p id="section-9.3-4">The set of entries to be defined in this registry is as follows:<a href="#section-9.3-4" class="pilcrow">¶</a></p>
<span id="name-dmarc-tag-registry-2"></span><table class="left" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-dmarc-tag-registry-2" class="selfRef">"DMARC Tag Registry"</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Tag Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Status</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">adkim</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">DKIM alignment mode</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">aspf</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">SPF alignment mode</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">fo</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Failure reporting options</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">np</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Requested handling policy for non-existent subdomains</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">p</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Requested handling policy</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">pct</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">historic</td>
              <td class="text-left" rowspan="1" colspan="1">Sampling rate</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">psd</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Indicates whether policy record is published by a Public Suffix Domain</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">rf</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">historic</td>
              <td class="text-left" rowspan="1" colspan="1">Failure reporting format(s)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ri</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">historic</td>
              <td class="text-left" rowspan="1" colspan="1">Aggregate Reporting interval</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">rua</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Reporting URI(s) for aggregate data</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ruf</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Reporting URI(s) for failure data</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">sp</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Requested handling policy for subdomains</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">t</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Test mode for the specified policy</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">v</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Specification version</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="dmarc-report-format-registry">
<section id="section-9.4">
        <h3 id="name-dmarc-report-format-registr">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-dmarc-report-format-registr" class="section-name selfRef">DMARC Report Format Registry</a>
        </h3>
<p id="section-9.4-1">Also, within "Domain-based Message Authentication, Reporting, and
Conformance (DMARC) Parameters", a new sub-registry called "DMARC
Report Format Registry" exists and should be updated to reference
this document.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">Names of DMARC failure reporting formats are registered with IANA
in this registry. New entries are assigned only for values that
satisfy the definition of Specification Required, per
<span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.  In addition to a reference to a permanent
specification, each registration includes the format name, a
brief description, and its status, which must be one of "current",
"experimental", or "historic". The Designated Expert needs to
confirm that the provided specification adequately describes the
report format and clearly presents how it would be used within the
DMARC context by Domain Owners and Mail Receivers.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">The entry in this registry is as follows:<a href="#section-9.4-3" class="pilcrow">¶</a></p>
<span id="name-dmarc-report-format-registry"></span><table class="left" id="table-6">
          <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-dmarc-report-format-registry" class="selfRef">"DMARC Report Format Registry"</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Format Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Status</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">afrf</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
              <td class="text-left" rowspan="1" colspan="1">current</td>
              <td class="text-left" rowspan="1" colspan="1">Authentication Failure Reporting Format (see <span>[<a href="#RFC6591" class="cite xref">RFC6591</a>]</span>)</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="underscored-and-globally-scoped-dns-node-names-registry">
<section id="section-9.5">
        <h3 id="name-underscored-and-globally-sc">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-underscored-and-globally-sc" class="section-name selfRef">Underscored and Globally Scoped DNS Node Names Registry</a>
        </h3>
<p id="section-9.5-1">Per <span>[<a href="#RFC8552" class="cite xref">RFC8552</a>]</span>, please update the following entry to the "Underscored and Globally Scoped DNS Node Names" registry:<a href="#section-9.5-1" class="pilcrow">¶</a></p>
<span id="name-underscored-and-globally-sco"></span><table class="left" id="table-7">
          <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-underscored-and-globally-sco" class="selfRef">"Underscored and Globally Scoped DNS Node Names" registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">RR Type</th>
              <th class="text-left" rowspan="1" colspan="1">_NODE NAME</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TXT</td>
              <td class="text-left" rowspan="1" colspan="1">_dmarc</td>
              <td class="text-left" rowspan="1" colspan="1">[this document]</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-10">
      <h2 id="name-privacy-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-10-1">This section discusses issues specific to private data that may be
included if DMARC reports are requested.  Issues associated with
sending aggregate reports and failure reports are addressed in
<span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span> and
<span>[<a href="#I-D.ietf-dmarc-failure-reporting" class="cite xref">I-D.ietf-dmarc-failure-reporting</a>]</span> respectively.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="aggregate-report-considerations">
<section id="section-10.1">
        <h3 id="name-aggregate-report-considerat">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-aggregate-report-considerat" class="section-name selfRef">Aggregate Report Considerations</a>
        </h3>
<p id="section-10.1-1">Aggregate reports may, particularly for small organizations, provide some
limited insight into email sending patterns.  As an example, in a small
organization, an aggregate report from a particular domain may be sufficient
to make the Report Consumer aware of sensitive personal or business
information.  If setting an "rua" tag in a DMARC Policy Record, the reporting
address needs controls appropriate to the organizational requirements to
mitigate any risk associated with receiving and handling reports.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">In the case of "rua" requests for multi-organizational PSDs, additional
information leakage considerations exist.  Multi-organizational PSDs that
do not mandate DMARC use by registrants risk exposure of private data of
registrant domains if they include the "rua" tag in their DMARC Policy Record.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="failure-report-considerations">
<section id="section-10.2">
        <h3 id="name-failure-report-consideratio">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-failure-report-consideratio" class="section-name selfRef">Failure Report Considerations</a>
        </h3>
<p id="section-10.2-1">Failure reports do provide insight into email sending patterns, including
specific users.  If requesting failure reports, data management controls
are needed to support appropriate management of this information.  The
additional detail available through failure reports (relative to aggregate
reports) can drive a need for additional controls.  As an example, a
company may be legally restricted from receiving data related to a specific
subsidiary.  Before requesting failure reports, any such data spillage risks
have to be addressed through data management controls or publishing DMARC
Policy Records for relevant subdomains to prevent reporting on data related to
their emails.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">Due to the nature of the email contents which may be shared through Failure
Reports, most Mail Receivers refuse to send them out of privacy concerns. Out
of band agreements between Report Consumers and Mail Receivers may be required
to address these concerns.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3">DMARC Policy Records for multi-organizational PSDs <span class="bcp14">MUST NOT</span> include the "ruf" tag.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-11">
      <h2 id="name-security-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-11-1">This section discusses security issues and possible remediations
(where available) for DMARC.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="authentication-methods">
<section id="section-11.1">
        <h3 id="name-authentication-methods">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-authentication-methods" class="section-name selfRef">Authentication Methods</a>
        </h3>
<p id="section-11.1-1">Security considerations from the authentication methods used by DMARC
are incorporated here by reference.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">Both of the email authentication methods that underlie DMARC provide some
assurance that an email was transmitted by an MTA which is authorized to
do so. SPF policies map domain names to sets of authorized MTAs (see <span><a href="https://rfc-editor.org/rfc/rfc7208#section-11.4" class="relref">Section 11.4</a> of [<a href="#RFC7208" class="cite xref">RFC7208</a>]</span>).
Validated DKIM signatures indicate that an email was transmitted by an MTA with
access to a private key that matches the published DKIM key record.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<p id="section-11.1-3">Whenever mail is sent, there is a risk that an overly permissive source
may send mail that will receive a DMARC pass result that was not, in fact,
intended by the Domain Owner. These results may lead to issues when
systems interpret DMARC pass results to indicate a message is in some way
authentic. They also allow such unauthorized senders to evade the Domain
Owner's intended message handling for DMARC validation failures.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<p id="section-11.1-4">To avoid this risk one must ensure that no unauthorized source can add
DKIM signatures to the domain's mail or transmit mail which will evaluate
as SPF pass. If, nonetheless, a Domain Owner wishes to include a
permissive source in a domain's SPF record, the source can be excluded
from DMARC consideration by using the "?" qualifier on the SPF record
mechanism associated with that source. The DMARC working group had a
lively discussion about possibly eliminating SPF entirely as an underlying
Authentication Mechanism for DMARC, but consensus was not reached, and
the suggestion to use the "?" qualifier for permissive sources is presented
here instead.<a href="#section-11.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attacks-on-reporting-uris">
<section id="section-11.2">
        <h3 id="name-attacks-on-reporting-uris">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-attacks-on-reporting-uris" class="section-name selfRef">Attacks on Reporting URIs</a>
        </h3>
<p id="section-11.2-1">URIs published in DNS TXT records are well-understood possible
targets for attack.  Specifications such as <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span> and
<span>[<a href="#RFC2142" class="cite xref">RFC2142</a>]</span> either expose or cause the exposure of email addresses that
could be flooded by an attacker, for example. Records found in the DNS such as MX, NS,
and others advertise potential attack destinations. Common DNS names such
as "www" plainly identify the locations at which particular services can
be found, providing destinations for targeted denial-of-service or
penetration attacks.  This all means that Domain Owners will need to harden
these addresses against various attacks, including but not limited to:<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2-2.1">
            <p id="section-11.2-2.1.1">high-volume denial-of-service attacks;<a href="#section-11.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-2.2">
            <p id="section-11.2-2.2.1">deliberate construction of malformed reports intended to identify
or exploit parsing or processing vulnerabilities;<a href="#section-11.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.2-2.3">
            <p id="section-11.2-2.3.1">deliberate construction of reports containing false claims for the
Submitter or Reported-Domain fields, including the possibility of
false data from compromised but known Mail Receivers.<a href="#section-11.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="dns-security">
<section id="section-11.3">
        <h3 id="name-dns-security">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-dns-security" class="section-name selfRef">DNS Security</a>
        </h3>
<p id="section-11.3-1">The DMARC mechanism and its underlying Authentication Mechanisms (SPF and DKIM)
depend on the security of the DNS. Examples of how hostile parties can
have an adverse impact on DNS traffic include:<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3-2.1">
            <p id="section-11.3-2.1.1">If they can snoop on DNS traffic, they can get an idea of who is
receiving mail using the domain(s) in question.<a href="#section-11.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.3-2.2">
            <p id="section-11.3-2.2.1">If they can block outgoing or reply DNS messages, they can prevent
systems from discovering senders' DMARC policies.<a href="#section-11.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.3-2.3">
            <p id="section-11.3-2.3.1">If they can send forged response packets, they can make aligned mail
appear unaligned or vice-versa.<a href="#section-11.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.3-3">None of these threats are unique to DMARC, and they can be addressed using
a variety of techniques, including, but not limited to:<a href="#section-11.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.3-4.1">
            <p id="section-11.3-4.1.1">Signing DNS records with Domain Name System Security Extensions (DNSSEC) <span>[<a href="#RFC4033" class="cite xref">RFC4033</a>]</span>,
which enables recipients to validate the integrity of DNS data and detect and discard
forged responses.<a href="#section-11.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.3-4.2">
            <p id="section-11.3-4.2.1">DNS over TLS <span>[<a href="#RFC7858" class="cite xref">RFC7858</a>]</span> or DNS over HTTPS <span>[<a href="#RFC8484" class="cite xref">RFC8484</a>]</span> can mitigate snooping
and forged responses.<a href="#section-11.3-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="display-name-attacks">
<section id="section-11.4">
        <h3 id="name-display-name-attacks">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-display-name-attacks" class="section-name selfRef">Display Name Attacks</a>
        </h3>
<p id="section-11.4-1">An increasingly common attack in messaging abuse is the presentation of false
information in the display-name portion of the RFC5322.From header field.
For example, it is possible for the email address in that field to be
an arbitrary address or domain name while containing a well-known
name (a person, brand, role, etc.) in the display name, intending to
fool the end user into believing that the name is used legitimately.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<p id="section-11.4-2">Such attacks, known as display name attacks, are out of scope for DMARC.<a href="#section-11.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="denial-of-dmarc-attacks">
<section id="section-11.5">
        <h3 id="name-denial-of-dmarc-processing-">
<a href="#section-11.5" class="section-number selfRef">11.5. </a><a href="#name-denial-of-dmarc-processing-" class="section-name selfRef">Denial of DMARC Processing Attacks</a>
        </h3>
<p id="section-11.5-1">The declaration in <a href="#extract-author-domain" class="auto internal xref">Section 5.3.1</a> and elsewhere in this document
that messages that do not contain precisely one RFC5322.From domain are
outside the scope of this document exposes an attack vector that must be
taken into consideration.<a href="#section-11.5-1" class="pilcrow">¶</a></p>
<p id="section-11.5-2">Because such messages are outside the scope of this document, an attacker
can craft messages with multiple RFC5322.From domains, including the spoofed
domain, in an effort to bypass DMARC validation and get the fraudulent message
to be displayed by the victim's MUA with the spoofed domain successfully shown
to the victim. In those cases where such messages are not rejected due to other
reasons (for example, many such messages would violate RFC5322's requirement that
there be precisely one From: header field), care must be taken by the Mail Receiver
to recognize such messages as the threats they might be and handle them
appropriately.<a href="#section-11.5-2" class="pilcrow">¶</a></p>
<p id="section-11.5-3">The case of a syntactically valid multi-valued RFC5322.From field presents a
particular challenge. Experience has shown that most such messages are abusive
and/or unwanted by their recipients, and given this fact, a Mail Receiver may make a
negative disposition decision for the message prior to and instead of its being
subjected to DMARC processing. However, in a case where a Mail Receiver requires
that the message be subject to DMARC validation, a recommended approach as per
<span>[<a href="#RFC7489" class="cite xref">RFC7489</a>]</span> is to apply the DMARC mechanism to each domain found in the RFC5322.From
field as the Author Domain and apply the most strict policy selected among the
checks that fail. Such an approach might prove useful for a small number of
Author Domains, but it is possible that applying such logic to messages with
a large number of domains (where "large" is defined by each Mail Receiver) will
expose the Mail Receiver to a form of denial of service attack. Limiting the number of
Author Domains processed will avoid this risk. If not all Author Domains are
processed, then the DMARC evaluation is incomplete.<a href="#section-11.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="external-report-addresses">
<section id="section-11.6">
        <h3 id="name-external-reporting-addresse">
<a href="#section-11.6" class="section-number selfRef">11.6. </a><a href="#name-external-reporting-addresse" class="section-name selfRef">External Reporting Addresses</a>
        </h3>
<p id="section-11.6-1">To avoid abuse by bad actors, reporting addresses generally have to
be inside the domains about which reports are requested.  To
accommodate special cases such as a need to get reports about domains
that cannot actually receive mail, <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-dmarc-aggregate-reporting-24#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span> describes
a DNS-based mechanism for validating approved external reporting.<a href="#section-11.6-1" class="pilcrow">¶</a></p>
<p id="section-11.6-2">The obvious consideration here is an increased DNS load against
domains that are claimed as external recipients. Negative caching
will mitigate this problem, but only to a limited extent, mostly
dependent on the default TTL in the domain's SOA record.<a href="#section-11.6-2" class="pilcrow">¶</a></p>
<p id="section-11.6-3">Where possible, external reporting is best achieved by having the
report be directed to domains that can receive mail and simply having
it automatically forwarded to the desired external destination.<a href="#section-11.6-3" class="pilcrow">¶</a></p>
<p id="section-11.6-4">Note that the addresses shown in the "ruf" tag receive more
information that might be considered private data since it is
possible for actual email content to appear in the failure reports.
The URIs identified there are thus more attractive targets for
intrusion attempts than those found in the "rua" tag. Moreover,
attacking the DNS of the subject domain to cause failure data to be
routed fraudulently to an attacker's systems may be an attractive
prospect. Deployment of DNSSEC <span>[<a href="#RFC4033" class="cite xref">RFC4033</a>]</span> is advisable if this is a concern.<a href="#section-11.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="secure-protocols">
<section id="section-11.7">
        <h3 id="name-secure-protocols">
<a href="#section-11.7" class="section-number selfRef">11.7. </a><a href="#name-secure-protocols" class="section-name selfRef">Secure Protocols</a>
        </h3>
<p id="section-11.7-1">This document encourages the use of secure transport mechanisms to
prevent the loss of private data to third parties that may be able to
monitor such transmissions. Unencrypted mechanisms should be
avoided.<a href="#section-11.7-1" class="pilcrow">¶</a></p>
<p id="section-11.7-2">In particular, a message that was originally encrypted or otherwise
secured might appear in a report that is not sent securely, which
could reveal private information.<a href="#section-11.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="relaxed-alignment-considerations">
<section id="section-11.8">
        <h3 id="name-relaxed-alignment-considera">
<a href="#section-11.8" class="section-number selfRef">11.8. </a><a href="#name-relaxed-alignment-considera" class="section-name selfRef">Relaxed Alignment Considerations</a>
        </h3>
<p id="section-11.8-1">The DMARC mechanism allows both <a href="#identifier-alignment-explained">DKIM- and SPF-Authenticated Identifiers</a>
to validate authorized use of an <a href="#author-domain">Author Domain</a> on behalf of a <a href="#domain-owner">Domain Owner</a>.  If malicious or unaware users can gain control of the SPF record or DKIM selector
records for a subdomain of the Organizational Domain, the subdomain can be used to generate email
that achieves a DMARC pass on behalf of the Organizational Domain.<a href="#section-11.8-1" class="pilcrow">¶</a></p>
<p id="section-11.8-2">A scenario such as this could occur under the following conditions:<a href="#section-11.8-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-11.8-3.1">A DMARC Policy Record exists for the domain "example.com", such that "example.com" is an Organizational Domain<a href="#section-11.8-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-11.8-3.2">An attacker controls DNS for the domain "evil.example.com" and publishes an SPF record for that domain<a href="#section-11.8-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-11.8-3.3">The attacker sends email with RFC5322.From header field containing "foo@example.com" and an SPF-Authenticated Identifier of "evil.example.com"<a href="#section-11.8-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.8-4">Although this email was not authorized by the Domain Owner, it can produce a DMARC pass because the SPF-Authenticated Identifier
("evil.example.com") has Identifier Alignment with the Author Domain ("example.com").<a href="#section-11.8-4" class="pilcrow">¶</a></p>
<p id="section-11.8-5">The Organizational Domain Owner should be careful not to delegate control of subdomains if this is an
issue, and consider using the <a href="#strict-alignment">Strict Alignment</a> option if appropriate.<a href="#section-11.8-5" class="pilcrow">¶</a></p>
<p id="section-11.8-6">DMARC evaluation for relaxed alignment is also highly sensitive to errors in
determining the Organizational Domain if the Author Domain does not have a published
<a href="#dmarc-policy-record">DMARC Policy Record</a>. If an incorrectly selected Organizational
Domain is a parent of the correct Organizational Domain, then relaxed alignment could
potentially allow a malicious sender to send mail that achieves a DMARC pass verdict.
This potential exists for both the legacy <span>[<a href="#RFC7489" class="cite xref">RFC7489</a>]</span> and current methods for determining
the organizational domain, the latter described in <a href="#identifier-alignment-evaluation" class="auto internal xref">Section 4.10.2</a>.<a href="#section-11.8-6" class="pilcrow">¶</a></p>
<p id="section-11.8-7">The following example illustrates this possibility:<a href="#section-11.8-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-11.8-8.1">Mail is sent with an Author Domain of "a.mail.example.com" and Authenticated Identifiers of "mail.example.com"<a href="#section-11.8-8.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-11.8-8.2">There is no DMARC Policy Record published at "_dmarc.a.mail.example.com"<a href="#section-11.8-8.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-11.8-8.3">There is one published at "_dmarc.mail.example.com" and this is intended to be the Organizational Domain for this message<a href="#section-11.8-8.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-11.8-8.4">There is also a DMARC Policy Record published at "_dmarc.example.com", with default alignment (relaxed)<a href="#section-11.8-8.4" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-11.8-8.5">An is able to send mail with the Author Domain of "evil.example.com" and an Authenticated Identifier of "mail.example.com"<a href="#section-11.8-8.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.8-9">In this scenario, if a Mail Receiver incorrectly determines the Organizational Domain to be "example.com",
then the attacker's mail will pass DMARC validation checks.<a href="#section-11.8-9" class="pilcrow">¶</a></p>
<p id="section-11.8-10">This issue is entirely avoided by the use of Strict Alignment and publishing explicit
DMARC Policy Records for all Author Domains used in an organization's email.<a href="#section-11.8-10" class="pilcrow">¶</a></p>
<p id="section-11.8-11">For cases where Strict Alignment is not appropriate, this issue can be mitigated by the Domain
Owner periodically (perhaps weekly, or whatever frequency might be appropriate for a given organization's
operational needs) checking the DMARC Policy Records, if any, of <a href="#public-suffix-domain">PSDs</a>
above the Organizational Domain in the DNS tree and (for legacy <span>[<a href="#RFC7489" class="cite xref">RFC7489</a>]</span> checking that
appropriate PSL entries remain present). If a PSD publishes a DMARC Policy Record without
the appropriate "psd=y" tag, Organizational Domain owners can add "psd=n" to their Organizational
Domain's DMARC Policy Record so that the PSD's DMARC Policy Record will not be incorrectly
interpreted to indicate that the PSD is the Organizational Domain.<a href="#section-11.8-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-dmarc-aggregate-reporting">[I-D.ietf-dmarc-aggregate-reporting]</dt>
        <dd>
<span class="refAuthor">Brotman, A.</span>, <span class="refTitle">"Domain-based Message Authentication, Reporting, and Conformance (DMARC) Aggregate Reporting"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dmarc-aggregate-reporting-24</span>, <time datetime="2024-12-16" class="refDate">16 December 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-dmarc-aggregate-reporting-24">https://datatracker.ietf.org/doc/html/draft-ietf-dmarc-aggregate-reporting-24</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dmarc-failure-reporting">[I-D.ietf-dmarc-failure-reporting]</dt>
        <dd>
<span class="refAuthor">Jones, S. M.</span> and <span class="refAuthor">A. Vesely</span>, <span class="refTitle">"Domain-based Message Authentication, Reporting, and Conformance (DMARC) Failure Reporting"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dmarc-failure-reporting-11</span>, <time datetime="2024-09-10" class="refDate">10 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-dmarc-failure-reporting-11">https://datatracker.ietf.org/doc/html/draft-ietf-dmarc-failure-reporting-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3986">[RFC3986]</dt>
        <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4343">[RFC4343]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refTitle">"Domain Name System (DNS) Case Insensitivity Clarification"</span>, <span class="seriesInfo">RFC 4343</span>, <span class="seriesInfo">DOI 10.17487/RFC4343</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4343">https://www.rfc-editor.org/info/rfc4343</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5321">[RFC5321]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Simple Mail Transfer Protocol"</span>, <span class="seriesInfo">RFC 5321</span>, <span class="seriesInfo">DOI 10.17487/RFC5321</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5321">https://www.rfc-editor.org/info/rfc5321</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5322">[RFC5322]</dt>
        <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 5322</span>, <span class="seriesInfo">DOI 10.17487/RFC5322</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5322">https://www.rfc-editor.org/info/rfc5322</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5890">[RFC5890]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"</span>, <span class="seriesInfo">RFC 5890</span>, <span class="seriesInfo">DOI 10.17487/RFC5890</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5890">https://www.rfc-editor.org/info/rfc5890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6376">[RFC6376]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span>, <span class="refAuthor">Hansen, T., Ed.</span>, and <span class="refAuthor">M. Kucherawy, Ed.</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) Signatures"</span>, <span class="seriesInfo">STD 76</span>, <span class="seriesInfo">RFC 6376</span>, <span class="seriesInfo">DOI 10.17487/RFC6376</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6376">https://www.rfc-editor.org/info/rfc6376</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6377">[RFC6377]</dt>
        <dd>
<span class="refAuthor">Kucherawy, M.</span>, <span class="refTitle">"DomainKeys Identified Mail (DKIM) and Mailing Lists"</span>, <span class="seriesInfo">BCP 167</span>, <span class="seriesInfo">RFC 6377</span>, <span class="seriesInfo">DOI 10.17487/RFC6377</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6377">https://www.rfc-editor.org/info/rfc6377</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6591">[RFC6591]</dt>
        <dd>
<span class="refAuthor">Fontana, H.</span>, <span class="refTitle">"Authentication Failure Reporting Using the Abuse Reporting Format"</span>, <span class="seriesInfo">RFC 6591</span>, <span class="seriesInfo">DOI 10.17487/RFC6591</span>, <time datetime="2012-04" class="refDate">April 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6591">https://www.rfc-editor.org/info/rfc6591</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6651">[RFC6651]</dt>
        <dd>
<span class="refAuthor">Kucherawy, M.</span>, <span class="refTitle">"Extensions to DomainKeys Identified Mail (DKIM) for Failure Reporting"</span>, <span class="seriesInfo">RFC 6651</span>, <span class="seriesInfo">DOI 10.17487/RFC6651</span>, <time datetime="2012-06" class="refDate">June 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6651">https://www.rfc-editor.org/info/rfc6651</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6652">[RFC6652]</dt>
        <dd>
<span class="refAuthor">Kitterman, S.</span>, <span class="refTitle">"Sender Policy Framework (SPF) Authentication Failure Reporting Using the Abuse Reporting Format"</span>, <span class="seriesInfo">RFC 6652</span>, <span class="seriesInfo">DOI 10.17487/RFC6652</span>, <time datetime="2012-06" class="refDate">June 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6652">https://www.rfc-editor.org/info/rfc6652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7208">[RFC7208]</dt>
        <dd>
<span class="refAuthor">Kitterman, S.</span>, <span class="refTitle">"Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, Version 1"</span>, <span class="seriesInfo">RFC 7208</span>, <span class="seriesInfo">DOI 10.17487/RFC7208</span>, <time datetime="2014-04" class="refDate">April 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7208">https://www.rfc-editor.org/info/rfc7208</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7405">[RFC7405]</dt>
        <dd>
<span class="refAuthor">Kyzivat, P.</span>, <span class="refTitle">"Case-Sensitive String Support in ABNF"</span>, <span class="seriesInfo">RFC 7405</span>, <span class="seriesInfo">DOI 10.17487/RFC7405</span>, <time datetime="2014-12" class="refDate">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7405">https://www.rfc-editor.org/info/rfc7405</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7489">[RFC7489]</dt>
        <dd>
<span class="refAuthor">Kucherawy, M., Ed.</span> and <span class="refAuthor">E. Zwicky, Ed.</span>, <span class="refTitle">"Domain-based Message Authentication, Reporting, and Conformance (DMARC)"</span>, <span class="seriesInfo">RFC 7489</span>, <span class="seriesInfo">DOI 10.17487/RFC7489</span>, <time datetime="2015-03" class="refDate">March 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7489">https://www.rfc-editor.org/info/rfc7489</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7960">[RFC7960]</dt>
        <dd>
<span class="refAuthor">Martin, F., Ed.</span>, <span class="refAuthor">Lear, E., Ed.</span>, <span class="refAuthor">Draegen, T., Ed.</span>, <span class="refAuthor">Zwicky, E., Ed.</span>, and <span class="refAuthor">K. Andersen, Ed.</span>, <span class="refTitle">"Interoperability Issues between Domain-based Message Authentication, Reporting, and Conformance (DMARC) and Indirect Email Flows"</span>, <span class="seriesInfo">RFC 7960</span>, <span class="seriesInfo">DOI 10.17487/RFC7960</span>, <time datetime="2016-09" class="refDate">September 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7960">https://www.rfc-editor.org/info/rfc7960</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8552">[RFC8552]</dt>
        <dd>
<span class="refAuthor">Crocker, D.</span>, <span class="refTitle">"Scoped Interpretation of DNS Resource Records through "Underscored" Naming of Attribute Leaves"</span>, <span class="seriesInfo">BCP 222</span>, <span class="seriesInfo">RFC 8552</span>, <span class="seriesInfo">DOI 10.17487/RFC8552</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8552">https://www.rfc-editor.org/info/rfc8552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8601">[RFC8601]</dt>
      <dd>
<span class="refAuthor">Kucherawy, M.</span>, <span class="refTitle">"Message Header Field for Indicating Message Authentication Status"</span>, <span class="seriesInfo">RFC 8601</span>, <span class="seriesInfo">DOI 10.17487/RFC8601</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8601">https://www.rfc-editor.org/info/rfc8601</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="M3AUTH">[M3AUTH]</dt>
        <dd>
<span class="refTitle">"M3AAWG Email Authentication Recommended Best Practices"</span>, <span>&lt;<a href="https://www.m3aawg.org/sites/default/files/m3aawg-email-authentication-recommended-best-practices-09-2020.pdf">https://www.m3aawg.org/sites/default/files/m3aawg-email-authentication-recommended-best-practices-09-2020.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="M3SPF">[M3SPF]</dt>
        <dd>
<span class="refTitle">"M3AAWG Best Practices for Managing SPF Records"</span>, <span>&lt;<a href="https://www.m3aawg.org/Managing-SPF-Records">https://www.m3aawg.org/Managing-SPF-Records</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2142">[RFC2142]</dt>
        <dd>
<span class="refAuthor">Crocker, D.</span>, <span class="refTitle">"Mailbox Names for Common Services, Roles and Functions"</span>, <span class="seriesInfo">RFC 2142</span>, <span class="seriesInfo">DOI 10.17487/RFC2142</span>, <time datetime="1997-05" class="refDate">May 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2142">https://www.rfc-editor.org/info/rfc2142</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2308">[RFC2308]</dt>
        <dd>
<span class="refAuthor">Andrews, M.</span>, <span class="refTitle">"Negative Caching of DNS Queries (DNS NCACHE)"</span>, <span class="seriesInfo">RFC 2308</span>, <span class="seriesInfo">DOI 10.17487/RFC2308</span>, <time datetime="1998-03" class="refDate">March 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2308">https://www.rfc-editor.org/info/rfc2308</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3464">[RFC3464]</dt>
        <dd>
<span class="refAuthor">Moore, K.</span> and <span class="refAuthor">G. Vaudreuil</span>, <span class="refTitle">"An Extensible Message Format for Delivery Status Notifications"</span>, <span class="seriesInfo">RFC 3464</span>, <span class="seriesInfo">DOI 10.17487/RFC3464</span>, <time datetime="2003-01" class="refDate">January 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3464">https://www.rfc-editor.org/info/rfc3464</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4033">[RFC4033]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span>, <span class="refAuthor">Austein, R.</span>, <span class="refAuthor">Larson, M.</span>, <span class="refAuthor">Massey, D.</span>, and <span class="refAuthor">S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4033">https://www.rfc-editor.org/info/rfc4033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4870">[RFC4870]</dt>
        <dd>
<span class="refAuthor">Delany, M.</span>, <span class="refTitle">"Domain-Based Email Authentication Using Public Keys Advertised in the DNS (DomainKeys)"</span>, <span class="seriesInfo">RFC 4870</span>, <span class="seriesInfo">DOI 10.17487/RFC4870</span>, <time datetime="2007-05" class="refDate">May 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4870">https://www.rfc-editor.org/info/rfc4870</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5598">[RFC5598]</dt>
        <dd>
<span class="refAuthor">Crocker, D.</span>, <span class="refTitle">"Internet Mail Architecture"</span>, <span class="seriesInfo">RFC 5598</span>, <span class="seriesInfo">DOI 10.17487/RFC5598</span>, <time datetime="2009-07" class="refDate">July 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5598">https://www.rfc-editor.org/info/rfc5598</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span>, <span class="refAuthor">Zhu, L.</span>, <span class="refAuthor">Heidemann, J.</span>, <span class="refAuthor">Mankin, A.</span>, <span class="refAuthor">Wessels, D.</span>, and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8020">[RFC8020]</dt>
        <dd>
<span class="refAuthor">Bortzmeyer, S.</span> and <span class="refAuthor">S. Huque</span>, <span class="refTitle">"NXDOMAIN: There Really Is Nothing Underneath"</span>, <span class="seriesInfo">RFC 8020</span>, <span class="seriesInfo">DOI 10.17487/RFC8020</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8020">https://www.rfc-editor.org/info/rfc8020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Ramsdell, B.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8551">https://www.rfc-editor.org/info/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8617">[RFC8617]</dt>
        <dd>
<span class="refAuthor">Andersen, K.</span>, <span class="refAuthor">Long, B., Ed.</span>, <span class="refAuthor">Blank, S., Ed.</span>, and <span class="refAuthor">M. Kucherawy, Ed.</span>, <span class="refTitle">"The Authenticated Received Chain (ARC) Protocol"</span>, <span class="seriesInfo">RFC 8617</span>, <span class="seriesInfo">DOI 10.17487/RFC8617</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8617">https://www.rfc-editor.org/info/rfc8617</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9091">[RFC9091]</dt>
      <dd>
<span class="refAuthor">Kitterman, S.</span> and <span class="refAuthor">T. Wicinski, Ed.</span>, <span class="refTitle">"Experimental Domain-Based Message Authentication, Reporting, and Conformance (DMARC) Extension for Public Suffix Domains"</span>, <span class="seriesInfo">RFC 9091</span>, <span class="seriesInfo">DOI 10.17487/RFC9091</span>, <time datetime="2021-07" class="refDate">July 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9091">https://www.rfc-editor.org/info/rfc9091</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="technology-considerations">
<section id="appendix-A">
      <h2 id="name-technology-considerations">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-technology-considerations" class="section-name selfRef">Technology Considerations</a>
      </h2>
<p id="appendix-A-1">This section documents some design decisions made in the
development of DMARC. Specifically addressed here are some
suggestions that were considered but not included in the design,
with explanatory text regarding the decision.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="s-mime">
<section id="appendix-A.1">
        <h3 id="name-s-mime">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-s-mime" class="section-name selfRef">S/MIME</a>
        </h3>
<p id="appendix-A.1-1">S/MIME, or Secure Multipurpose Internet Mail Extensions <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span>,
is a standard for encrypting and signing MIME data in a message. This
was suggested and considered as a third security protocol for
authenticating the source of a message.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">DMARC is focused on authentication at the domain level (i.e., the
Domain Owner taking responsibility for the message), while S/MIME is
really intended for user-to-user authentication and encryption. This
alone appears to make it a bad fit for DMARC's goals.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">S/MIME also suffers from the heavyweight problem of Public Key
Infrastructure, which means that distribution of keys used to validate
signatures needs to be incorporated. In many instances, this alone
is a showstopper. There have been consistent promises that PKI
usability and deployment will improve, but these have yet to
materialize. DMARC can revisit this choice after those barriers are
addressed.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1-4">S/MIME has extensive deployment in specific market segments
(government, for example) but does not enjoy similar widespread
deployment over the general Internet, and this shows no signs of
changing. DKIM and SPF are both deployed widely over the general
Internet, and their adoption rates continue to be positive.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<p id="appendix-A.1-5">Finally, experiments have shown that including S/MIME support in the
initial version of DMARC would neither cause nor enable a substantial
increase in the accuracy of the overall mechanism.<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="method-exclusion">
<section id="appendix-A.2">
        <h3 id="name-method-exclusion">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-method-exclusion" class="section-name selfRef">Method Exclusion</a>
        </h3>
<p id="appendix-A.2-1">It was suggested that DMARC include a mechanism by which a Domain
Owner could instruct Mail Receivers not to attempt validation by one
of the supported methods (e.g., "check DKIM, but not SPF").<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">Specifically, consider a Domain Owner that has deployed one of the
technologies and that technology fails for some messages, but such
failures don't cause enforcement action. Deploying DMARC would cause
enforcement action for policies other than "none", which would appear
to exclude participation by that Domain Owner.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-3">The DMARC development team evaluated the idea of policy exception
mechanisms on several occasions and invariably concluded that there
was not a strong enough use case to include them. The target audience
for DMARC does not appear to have concerns about the failure modes of
one or the other being a barrier to DMARC's adoption.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4">In the scenario described above, the Domain Owner has a few options:<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.2-5">
<li id="appendix-A.2-5.1">
            <p id="appendix-A.2-5.1.1">Tighten up its infrastructure to minimize the failure modes of
the single deployed technology.<a href="#appendix-A.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.2-5.2">
            <p id="appendix-A.2-5.2.1">Deploy the other supported authentication mechanism, to offset
the failure modes of the first.<a href="#appendix-A.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.2-5.3">
            <p id="appendix-A.2-5.3.1">Deploy DMARC in a reporting-only mode.<a href="#appendix-A.2-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="sender-header-field">
<section id="appendix-A.3">
        <h3 id="name-sender-header-field">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-sender-header-field" class="section-name selfRef">Sender Header Field</a>
        </h3>
<p id="appendix-A.3-1">It has been suggested in several message authentication efforts that
the Sender header field be checked for an identifier of interest, as
the standards indicate this as the proper way to indicate a
re-mailing of content such as through a mailing list. Most recently,
it was a protocol-level option for DomainKeys <span>[<a href="#RFC4870" class="cite xref">RFC4870</a>]</span>, but on evolution to
DKIM, this property was removed.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2">The DMARC development team considered this and decided not to include
support for doing so for the following reasons:<a href="#appendix-A.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.3-3">
<li id="appendix-A.3-3.1">
            <p id="appendix-A.3-3.1.1">The main user protection approach is to be concerned with what
the user sees when a message is rendered. There is no consistent
behavior among MUAs regarding what to do with the content of the
Sender field, if present. Accordingly, supporting the checking of
the Sender identifier would mean applying policy to an identifier
the end user might never actually see, which can create a vector
for attack against end users by simply forging a Sender field
containing some identifier that DMARC will like.<a href="#appendix-A.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.3-3.2">
            <p id="appendix-A.3-3.2.1">Although it is certainly true that this is what the Sender field
is for, its use in this way is also unreliable, making it a poor
candidate for inclusion in the DMARC evaluation algorithm.<a href="#appendix-A.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-A.3-3.3">
            <p id="appendix-A.3-3.3.1">Allowing multiple ways to discover policy introduces unacceptable
ambiguity into the DMARC validation algorithm in terms of which
policy is to be applied and when.<a href="#appendix-A.3-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="domain-existence-test">
<section id="appendix-A.4">
        <h3 id="name-domain-existence-test">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-domain-existence-test" class="section-name selfRef">Domain Existence Test</a>
        </h3>
<p id="appendix-A.4-1">The presence of the "np" tag in this specification seemingly implies that
there would be an agreed-upon standard for determining a domain's existence.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-2">Since the DMARC mechanism is focused on email, one might think that the
definition of "resolvable" in <span>[<a href="#RFC5321" class="cite xref">RFC5321</a>]</span> applies. Using that definition, only
names that resolve to MX Resource Records (RRs), A RRs, or AAAA RRs are deemed
to be resolvable and to exist in the DNS. This is a common practice among Mail
Receivers to determine whether or not to accept a mail message before performing
other more expensive processing.<a href="#appendix-A.4-2" class="pilcrow">¶</a></p>
<p id="appendix-A.4-3">The DMARC mechanism makes no such requirement for the existence of specific DNS
RRs in order for a domain to exist; instead, if any RR exists for a domain, then
the domain exists. To use the terminology from <span>[<a href="#RFC2308" class="cite xref">RFC2308</a>]</span>, an "NXDOMAIN" response
(rcode "Name Error") to a DNS query means that the domain name does not exist,
while a "NODATA" response (rcode "NOERROR") means that the given resource record
type queried for does not exist, but the domain name does.<a href="#appendix-A.4-3" class="pilcrow">¶</a></p>
<p id="appendix-A.4-4">Furthermore, in keeping with <span>[<a href="#RFC8020" class="cite xref">RFC8020</a>]</span>, if a query for a name returns NXDOMAIN,
then not only does the name not exist, every name below it in the DNS hierarchy
also does not exist.<a href="#appendix-A.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="organizational-domain-discovery-issues">
<section id="appendix-A.5">
        <h3 id="name-organizational-domain-disco">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-organizational-domain-disco" class="section-name selfRef">Organizational Domain Discovery Issues</a>
        </h3>
<p id="appendix-A.5-1">An earlier informational version of the DMARC mechanism <span>[<a href="#RFC7489" class="cite xref">RFC7489</a>]</span>
noted that the DNS does not provide a method by which the "domain of record",
or the domain that was actually registered with a domain registrar, can
be determined given an arbitrary domain name. That version further mentioned
suggestions that have been made that attempt to glean such information from
SOA or NS resource records, but these too are not fully reliable, as the
partitioning of the DNS is not always done at administrative boundaries.<a href="#appendix-A.5-1" class="pilcrow">¶</a></p>
<p id="appendix-A.5-2">That previous version posited that one could "climb the tree" to find the
Organizational Domain, but expressed concern that an attacker could exploit
this for a denial-of-service attack through sending a high number of messages
each with a relatively large number of nonsense labels, causing a Mail Receiver
to perform a large number of DNS queries in search of a DMARC Policy Record. This
version defines a method for performing a <a href="#dns-tree-walk">DNS Tree Walk</a>,
and further mitigates the risk of the denial-of-service attack by expressly limiting
the number of DNS queries to execute regardless of the number of labels in the domain
name.<a href="#appendix-A.5-2" class="pilcrow">¶</a></p>
<p id="appendix-A.5-3">Readers curious about the previous method for Organizational Domain Discovery are
directed to <span><a href="https://rfc-editor.org/rfc/rfc7489#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7489" class="cite xref">RFC7489</a>]</span>.<a href="#appendix-A.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="removal-of-the-pct-tag">
<section id="appendix-A.6">
        <h3 id="name-removal-of-the-pct-tag">
<a href="#appendix-A.6" class="section-number selfRef">A.6. </a><a href="#name-removal-of-the-pct-tag" class="section-name selfRef">Removal of the "pct" Tag</a>
        </h3>
<p id="appendix-A.6-1">An earlier informational version of the DMARC mechanism <span>[<a href="#RFC7489" class="cite xref">RFC7489</a>]</span>
included a "pct" tag and specified all integers from 0 to 100 inclusive
as valid values for the tag. The intent of the tag was to provide domain
owners with a method to gradually change their preferred Domain Owner Assessment
Policy (the "p" tag) from "none" to "quarantine" or from "quarantine" to "reject"
by requesting the stricter treatment for just a percentage of messages
that produced DMARC results of "fail".<a href="#appendix-A.6-1" class="pilcrow">¶</a></p>
<p id="appendix-A.6-2">Operational experience showed that the pct tag was usually not accurately
applied, unless the value specified was either 0 or 100 (the default),
and the inaccuracies with other values varied widely from one implementation to
another. The default value was easily implemented, as it required no
special processing on the part of the Mail Receiver, while the value
of 0 took on unintended significance as a value used by some intermediaries
and mailbox providers as an indicator to deviate from standard handling of
the message, usually by rewriting the RFC5322.From header field in an effort to
avoid DMARC failures downstream.<a href="#appendix-A.6-2" class="pilcrow">¶</a></p>
<p id="appendix-A.6-3">These custom actions when the "pct" tag was set to 0 proved valuable to the
email community. In particular, header field rewriting by an intermediary meant
that a Domain Owner's aggregate reports could reveal to the Domain Owner
how much of its traffic was routing through intermediaries that don't rewrite
the RFC5322.From header field. Such information wasn't explicit in the aggregate
reports received; rather, sussing it out required work on the part of the Domain
Owner to compare aggregate reports from before and after the "p" value was changed
and "pct=0" was included in the DMARC Policy Record, but the data was there.
Consequently, knowing how much mail was subject to possible DMARC failure due to
a lack of RFC5322.From header field rewriting by intermediaries could assist the
Domain Owner in choosing whether to move from <a href="#monitoring-mode">Monitoring Mode</a>
to <a href="#enforcement">Enforcement</a>.  Armed with this knowledge, the Domain Owner could
make an informed decision regarding subjecting its mail traffic to possible DMARC
failures based on the Domain Owner's tolerance for such things.<a href="#appendix-A.6-3" class="pilcrow">¶</a></p>
<p id="appendix-A.6-4">Because of the value provided by "pct=0" to Domain Owners, it was logical
to keep this functionality in the protocol; at the same time, it didn't make
sense to support a tag named "pct" that had only two valid values. This version
of the DMARC mechanism, therefore, introduces the "t" tag as shorthand for "testing",
with the valid values of "y" and "n", which are meant to be analogous in their
application by mailbox providers and intermediaries to the "pct" tag values
"0" and "100", respectively.<a href="#appendix-A.6-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="appendix-B">
      <h2 id="name-examples">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-B-1">This section illustrates both the Domain Owner side and the Mail
Receiver side of a DMARC exchange.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="identifier-alignment-examples">
<section id="appendix-B.1">
        <h3 id="name-identifier-alignment-exampl">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-identifier-alignment-exampl" class="section-name selfRef">Identifier Alignment Examples</a>
        </h3>
<p id="appendix-B.1-1">The following examples illustrate the DMARC mechanism's use of
Identifier Alignment. For brevity's sake, only message header fields and
relevant SMTP commands are shown, as message bodies are not considered
when conducting DMARC checks.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<div id="spf">
<section id="appendix-B.1.1">
          <h4 id="name-spf">
<a href="#appendix-B.1.1" class="section-number selfRef">B.1.1. </a><a href="#name-spf" class="section-name selfRef">SPF</a>
          </h4>
<p id="appendix-B.1.1-1">The following SPF examples assume that SPF produces a passing result.
Alignment cannot exist if SPF does not produce a passing result.<a href="#appendix-B.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1.1-2">Example 1: SPF in Strict Alignment:<a href="#appendix-B.1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.1-3">
<pre>     MAIL FROM: &lt;sender@example.com&gt;

     From: sender@example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#appendix-B.1.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1.1-4">In this case, the RFC5321.MailFrom domain and the Author Domain are identical.
Thus, the identifiers are in Strict Alignment.<a href="#appendix-B.1.1-4" class="pilcrow">¶</a></p>
<p id="appendix-B.1.1-5">Example 2: SPF in Relaxed Alignment:<a href="#appendix-B.1.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.1-6">
<pre>     MAIL FROM: &lt;sender@child.example.com&gt;

     From: sender@example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#appendix-B.1.1-6" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1.1-7">In this case, the Author Domain (example.com) is a parent of the
RFC5321.MailFrom domain. Thus, the identifiers are in relaxed alignment
because they both have the same Organizational Domain (example.com).<a href="#appendix-B.1.1-7" class="pilcrow">¶</a></p>
<p id="appendix-B.1.1-8">Example 3: No SPF Identifier Alignment:<a href="#appendix-B.1.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.1-9">
<pre>     MAIL FROM: &lt;sender@example.net&gt;

     From: sender@child.example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#appendix-B.1.1-9" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1.1-10">In this case, the RFC5321.MailFrom domain that is neither the same as,
a parent of, nor a child of the Author Domain. Thus, the identifiers
are not in alignment.<a href="#appendix-B.1.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dkim">
<section id="appendix-B.1.2">
          <h4 id="name-dkim">
<a href="#appendix-B.1.2" class="section-number selfRef">B.1.2. </a><a href="#name-dkim" class="section-name selfRef">DKIM</a>
          </h4>
<p id="appendix-B.1.2-1">The examples below assume that the DKIM signatures pass validation.
Alignment cannot exist with a DKIM signature that does not validate.<a href="#appendix-B.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1.2-2">Example 1: DKIM in Strict Alignment:<a href="#appendix-B.1.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.2-3">
<pre>     DKIM-Signature: v=1; ...; d=example.com; ...
     From: sender@example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#appendix-B.1.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1.2-4">In this case, the DKIM "d" tag and the Author Domain have
identical DNS domains. Thus, the identifiers are in Strict Alignment.<a href="#appendix-B.1.2-4" class="pilcrow">¶</a></p>
<p id="appendix-B.1.2-5">Example 2: DKIM in Relaxed Alignment:<a href="#appendix-B.1.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.2-6">
<pre>     DKIM-Signature: v=1; ...; d=example.com; ...
     From: sender@child.example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#appendix-B.1.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1.2-7">In this case, the DKIM signature's "d" tag includes a DNS
domain that is a parent of the Author Domain. Thus, the
identifiers are in relaxed alignment, as they have the same
Organizational Domain (example.com).<a href="#appendix-B.1.2-7" class="pilcrow">¶</a></p>
<p id="appendix-B.1.2-8">Example 3: No DKIM Identifier Alignment:<a href="#appendix-B.1.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1.2-9">
<pre>     DKIM-Signature: v=1; ...; d=example.net; ...
     From: sender@child.example.com
     Date: Fri, Feb 15 2002 16:54:30 -0800
     To: receiver@example.org
     Subject: here's a sample
</pre><a href="#appendix-B.1.2-9" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1.2-10">In this case, the DKIM signature's "d" tag includes a DNS
domain that is neither the same as, a parent of, nor a child of the
Author Domain. Thus, the identifiers are not in alignment.<a href="#appendix-B.1.2-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="domain-owner-example">
<section id="appendix-B.2">
        <h3 id="name-domain-owner-example">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-domain-owner-example" class="section-name selfRef">Domain Owner Example</a>
        </h3>
<p id="appendix-B.2-1">A Domain Owner that wants to use DMARC should have already deployed
and tested SPF and DKIM. The next step is to publish a DMARC Policy
Record for the Domain Owner's Organizational Domain.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<div id="entire-domain-monitoring-mode">
<section id="appendix-B.2.1">
          <h4 id="name-entire-domain-monitoring-mo">
<a href="#appendix-B.2.1" class="section-number selfRef">B.2.1. </a><a href="#name-entire-domain-monitoring-mo" class="section-name selfRef">Entire Domain, Monitoring Mode</a>
          </h4>
<p id="appendix-B.2.1-1">The Domain Owner for "example.com" has deployed SPF and DKIM on
its messaging infrastructure. The Domain Owner wishes to begin using DMARC
with a policy that will solicit aggregate feedback from Mail Receivers
without affecting how the messages are processed in order to:<a href="#appendix-B.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2.1-2.1">
              <p id="appendix-B.2.1-2.1.1">Confirm that its legitimate messages are authenticating correctly<a href="#appendix-B.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.2.1-2.2">
              <p id="appendix-B.2.1-2.2.1">Validate that all authorized message sources have implemented
authentication measures<a href="#appendix-B.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.2.1-2.3">
              <p id="appendix-B.2.1-2.3.1">Determine how many messages from other sources would be affected
by publishing a Domain Owner Assessment Policy at Enforcement<a href="#appendix-B.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.2.1-3">The Domain Owner accomplishes this by constructing a DMARC Policy Record
indicating that:<a href="#appendix-B.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2.1-4.1">
              <p id="appendix-B.2.1-4.1.1">The version of DMARC being used is "DMARC1" ("v=DMARC1;")<a href="#appendix-B.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.2.1-4.2">
              <p id="appendix-B.2.1-4.2.1">Mail Receivers should not alter how they treat these messages because
of this DMARC Policy Record ("p=none")<a href="#appendix-B.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.2.1-4.3">
              <p id="appendix-B.2.1-4.3.1">Aggregate feedback reports are sent via email to the address
"dmarc-feedback@example.com"
<code>("rua=mailto:dmarc-feedback@example.com")</code><a href="#appendix-B.2.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.2.1-4.4">
              <p id="appendix-B.2.1-4.4.1">All messages from this Organizational Domain are subject to this
policy (no "t" tag present, so the default of "n" applies).<a href="#appendix-B.2.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.2.1-5">To publish such a record, the DNS administrator for the Domain Owner
creates an entry like the following in the appropriate zone file
(following the conventional zone file format):<a href="#appendix-B.2.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.1-6">
<pre>  ; DMARC Policy Record for the domain example.com
  _dmarc  IN TXT ( "v=DMARC1; p=none; "
                   "rua=mailto:dmarc-feedback@example.com" )
</pre><a href="#appendix-B.2.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="entire-domain-monitoring-mode-per-message-failure-reports">
<section id="appendix-B.2.2">
          <h4 id="name-entire-domain-monitoring-mod">
<a href="#appendix-B.2.2" class="section-number selfRef">B.2.2. </a><a href="#name-entire-domain-monitoring-mod" class="section-name selfRef">Entire Domain, Monitoring Mode, Per-Message Failure Reports</a>
          </h4>
<p id="appendix-B.2.2-1">The Domain Owner from the previous example has used the aggregate
reporting to discover some messaging systems that had not yet
implemented DKIM correctly, but they are still seeing periodic
authentication failures. To diagnose these intermittent
problems, they wish to request per-message failure reports when
authentication failures occur.<a href="#appendix-B.2.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.2-2">Not all Mail Receivers will honor such a request, but the Domain Owner
feels that any reports it does receive will be helpful enough to
justify publishing this record. The default per-message failure report
format (<span>[<a href="#RFC6591" class="cite xref">RFC6591</a>]</span>) meets the Domain Owner's needs in this scenario.<a href="#appendix-B.2.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2.2-3">The Domain Owner accomplishes this by adding the following to its
DMARC Policy Record from <a href="#entire-domain-monitoring-mode" class="auto internal xref">Appendix B.2.1</a>:<a href="#appendix-B.2.2-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.2.2-4.1">Per-message failure reports are sent via email to the
address "auth-reports@example.com"
<code>("ruf=mailto:auth-reports@example.com")</code><a href="#appendix-B.2.2-4.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-B.2.2-5">To publish such a record, the DNS administrator for the Domain Owner
might create an entry like the following in the appropriate zone file
(following the conventional zone file format):<a href="#appendix-B.2.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.2-6">
<pre>  ; DMARC Policy Record for the domain example.com
  _dmarc  IN TXT ( "v=DMARC1; p=none; "
                   "rua=mailto:dmarc-feedback@example.com; "
                   "ruf=mailto:auth-reports@example.com" )
</pre><a href="#appendix-B.2.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="per-message-failure-reports-directed-to-third-party">
<section id="appendix-B.2.3">
          <h4 id="name-per-message-failure-reports">
<a href="#appendix-B.2.3" class="section-number selfRef">B.2.3. </a><a href="#name-per-message-failure-reports" class="section-name selfRef">Per-Message Failure Reports Directed to Third Party</a>
          </h4>
<p id="appendix-B.2.3-1">The Domain Owner from the previous example is maintaining the same
policy but now wishes to have a third party serve as a Report Consumer.
Again, not all Mail Receivers will honor this request, but those that
do <span class="bcp14">MUST</span> implement additional checks to validate that the third party
authorizes reception of failure reports on behalf of this domain.<a href="#appendix-B.2.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3-2">The Domain Owner needs to alter its DMARC Policy Record from <a href="#entire-domain-monitoring-mode-per-message-failure-reports" class="auto internal xref">Appendix B.2.2</a>
as follows:<a href="#appendix-B.2.3-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.2.3-3.1">Per-message failure reports are sent via email to the
address "auth-reports@thirdparty.example.net"
<code>("ruf=mailto:auth-reports@thirdparty.example.net")</code><a href="#appendix-B.2.3-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-B.2.3-4">To publish such a record, the DNS administrator for the Domain Owner
might create an entry like the following in the appropriate zone file
(following the conventional zone file format):<a href="#appendix-B.2.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.3-5">
<pre>  ; DMARC Policy Record for the domain example.com
  _dmarc IN TXT ( "v=DMARC1; p=none; "
                  "rua=mailto:dmarc-feedback@example.com; "
                  "ruf=mailto:auth-reports@thirdparty.example.net" )
</pre><a href="#appendix-B.2.3-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.3-6">Because the address used in the "ruf" tag is outside the Organizational Domain
in which this record is published, conforming Mail Receivers <span class="bcp14">MUST</span> implement
additional checks as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-dmarc-aggregate-reporting-24#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.
To pass these additional checks, the Report Consumer's Domain Owner will need to
publish an additional DMARC Policy Record as follows:<a href="#appendix-B.2.3-6" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.2.3-7.1">Given the DMARC Policy Record published by the Domain Owner at
"_dmarc.example.com", the DNS administrator for the Report Consumer
will need to publish a TXT resource record at
"example.com._report._dmarc.thirdparty.example.net" with the value
"v=DMARC1;" to authorize receipt of the reports.<a href="#appendix-B.2.3-7.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-B.2.3-8">To publish such a record, the DNS administrator for example.net might
create an entry like the following in the appropriate zone file
(following the conventional zone file format):<a href="#appendix-B.2.3-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.3-9">
<pre>  ; zone file for thirdparty.example.net
  ; Accept DMARC reports on behalf of example.com
  example.com._report._dmarc   IN   TXT    "v=DMARC1;"
</pre><a href="#appendix-B.2.3-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="overriding-destination-addresses">
<section id="appendix-B.2.4">
          <h4 id="name-overriding-destination-addr">
<a href="#appendix-B.2.4" class="section-number selfRef">B.2.4. </a><a href="#name-overriding-destination-addr" class="section-name selfRef">Overriding destination addresses</a>
          </h4>
<p id="appendix-B.2.4-1">The third party Report Consumer can also publish "rua" and "ruf" tags in order
to override the specific address published by example.com with a different
address in the same third party domain. This may be necessary if the third
party Report Consumer has changed its email address, or want to guard against
typos in the DMARC Policy Record of the Author Domain. Intermediaries and other
third parties should refer to <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-dmarc-aggregate-reporting-24#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>
for the full details of this mechanism.<a href="#appendix-B.2.4-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.4-2">The third party Report Consumer accomplishes this by adding the following to its
DMARC Policy Record from <a href="#per-message-failure-reports-directed-to-third-party" class="auto internal xref">Appendix B.2.3</a>:<a href="#appendix-B.2.4-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.2.4-3.1">The override address for aggregate reports is
"aggregate-reports@thirdparty.example.net"
<code>("rua=mailto:aggregate-reports@thirdparty.example.net")</code><a href="#appendix-B.2.4-3.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-B.2.4-3.2">The override address for failure reports is
"failure-reports@thirdparty.example.net"
<code>("ruf=mailto:failure-reports@thirdparty.example.net")</code><a href="#appendix-B.2.4-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-B.2.4-4">To publish such a record, the DNS administrator for example.net might
create an entry like the following in the appropriate zone file
(following the conventional zone file format):<a href="#appendix-B.2.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.4-5">
<pre>  ; zone file for thirdparty.example.net
  ; Accept DMARC reports on behalf of example.com
  ; Override destination mailboxes
  example.com._report._dmarc   IN   TXT    (
          "v=DMARC1; "
          "rua=mailto:aggregate-reports@thirdparty.example.net; "
          "ruf=mailto:failure-reports@thirdparty.example.net" )
</pre><a href="#appendix-B.2.4-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.4-6">In this case only the "ruf" tag is actually overridden, because, in the
previous example, failure reporting is the only reporting type that was
directed to the third party Report Consumer.<a href="#appendix-B.2.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subdomain-sampling-and-multiple-aggregate-report-uris">
<section id="appendix-B.2.5">
          <h4 id="name-subdomain-testing-and-multi">
<a href="#appendix-B.2.5" class="section-number selfRef">B.2.5. </a><a href="#name-subdomain-testing-and-multi" class="section-name selfRef">Subdomain, Testing, and Multiple Aggregate Report URIs</a>
          </h4>
<p id="appendix-B.2.5-1">The Domain Owner has implemented SPF and DKIM in a subdomain used for
pre-production testing of messaging services.  It now wishes to express
a handling preference for messages from this subdomain that fail DMARC validation
to indicate to participating Mail Receivers that use of this domain is not valid.<a href="#appendix-B.2.5-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.5-2">As a first step, it will express that it considers messages using this
subdomain that fail DMARC validation to be suspicious. The goal here
will be to enable examination of messages sent to mailboxes hosted by
participating Mail Receivers as a method for troubleshooting any existing
authentication issues. Aggregate feedback reports will be sent to
a mailbox within the Organizational Domain, and to a mailbox at a Report
Consumer selected and authorized to receive them by the Domain Owner.<a href="#appendix-B.2.5-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2.5-3">The Domain Owner will accomplish this by constructing a DMARC Policy Record
indicating that:<a href="#appendix-B.2.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2.5-4.1">
              <p id="appendix-B.2.5-4.1.1">The version of DMARC being used is "DMARC1" ("v=DMARC1;")<a href="#appendix-B.2.5-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.2.5-4.2">
              <p id="appendix-B.2.5-4.2.1">It is applied only to this subdomain (the DMARC Policy Record is published at
"_dmarc.test.example.com" and not "_dmarc.example.com")<a href="#appendix-B.2.5-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.2.5-4.3">
              <p id="appendix-B.2.5-4.3.1">Mail Receivers are advised that the Domain Owner considers messages
that fail to authenticate to be suspicious ("p=quarantine")<a href="#appendix-B.2.5-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.2.5-4.4">
              <p id="appendix-B.2.5-4.4.1">Aggregate feedback reports are sent via email to the
addresses "dmarc-feedback@example.com" and
"example-tld-test@thirdparty.example.net"
<code>("rua=mailto:dmarc-feedback@example.com,
 mailto:example-tld-test@thirdparty.example.net")</code><a href="#appendix-B.2.5-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.2.5-4.5">
              <p id="appendix-B.2.5-4.5.1">The Domain Owner desires only that an actor performing a DMARC
validation check apply any special handling rules it might have
in place, such as rewriting the RFC53322.From header field; the Domain
Owner is testing its setup at this point and so does not want
the handling policy to be applied. ("t=y")<a href="#appendix-B.2.5-4.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.2.5-5">To publish such a record, the DNS administrator for the Domain Owner
might create an entry like the following in the appropriate zone
file (following the conventional zone file format):<a href="#appendix-B.2.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.5-6">
<pre>  ; DMARC Policy Record for the domain test.example.com
  _dmarc IN  TXT  ( "v=DMARC1; p=quarantine; "
                    "rua=mailto:dmarc-feedback@example.com,"
                    "mailto:tld-test@thirdparty.example.net; "
                    "t=y" )
</pre><a href="#appendix-B.2.5-6" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2.5-7">Once enough time has passed to allow for collecting enough reports to
give the Domain Owner confidence that all authorized email sent using
the subdomain is properly authenticating and passing DMARC validation checks,
then the Domain Owner can update the DMARC Policy Record to indicate that it considers
validation failures to be a clear indication that use of the subdomain
is not valid. It would do this by altering the record to advise Mail Receivers
of its position on such messages ("p=reject") and removing the testing flag ("t=y").<a href="#appendix-B.2.5-7" class="pilcrow">¶</a></p>
<p id="appendix-B.2.5-8">To publish such a record, the DNS administrator for the Domain Owner
might create an entry like the following in the appropriate zone
file (following the conventional zone file format):<a href="#appendix-B.2.5-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2.5-9">
<pre>  ; DMARC Policy Record for the domain test.example.com
  _dmarc IN  TXT  ( "v=DMARC1; p=reject; "
                    "rua=mailto:dmarc-feedback@example.com,"
                    "mailto:tld-test@thirdparty.example.net" )
</pre><a href="#appendix-B.2.5-9" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="mail-receiver-example">
<section id="appendix-B.3">
        <h3 id="name-mail-receiver-example">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-mail-receiver-example" class="section-name selfRef">Mail Receiver Example</a>
        </h3>
<p id="appendix-B.3-1">A Mail Receiver that wants to participate in DMARC should already be checking
SPF and DKIM, and possess the ability to collect relevant information
from various email-processing stages to provide feedback to Domain
Owners (possibly via Report Consumers).<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<div id="smtp-session-example">
<section id="appendix-B.3.1">
          <h4 id="name-smtp-session-example">
<a href="#appendix-B.3.1" class="section-number selfRef">B.3.1. </a><a href="#name-smtp-session-example" class="section-name selfRef">SMTP Session Example</a>
          </h4>
<p id="appendix-B.3.1-1">An optimal DMARC-enabled Mail Receiver performs validation and
Identifier Alignment checking during the SMTP <span>[<a href="#RFC5321" class="cite xref">RFC5321</a>]</span> conversation.<a href="#appendix-B.3.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-2">Before returning a final reply to the DATA command, the Mail
Receiver's MTA has performed:<a href="#appendix-B.3.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B.3.1-3">
<li id="appendix-B.3.1-3.1">
              <p id="appendix-B.3.1-3.1.1">An SPF check to determine an SPF-Authenticated Identifier.<a href="#appendix-B.3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-B.3.1-3.2">
              <p id="appendix-B.3.1-3.2.1">DKIM checks that yield one or more DKIM-Authenticated
Identifiers.<a href="#appendix-B.3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-B.3.1-3.3">
              <p id="appendix-B.3.1-3.3.1">A DMARC Policy Record lookup.<a href="#appendix-B.3.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="appendix-B.3.1-4">The presence of an Author Domain DMARC Policy Record indicates that the Mail
Receiver should continue with DMARC-specific processing before returning a
reply to the DATA command.<a href="#appendix-B.3.1-4" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-5">Given a DMARC Policy Record and the set of Authenticated Identifiers, the
Mail Receiver checks to see if the Authenticated Identifiers align
with the Author Domain (taking into consideration any strict versus
relaxed options found in the DMARC Policy Record).<a href="#appendix-B.3.1-5" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-6">For example, the following sample data is considered to be from a
piece of email originating from the Domain Owner of "example.com":<a href="#appendix-B.3.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.3.1-7">
<pre>  Author Domain: example.com
  SPF-authenticated Identifier: mail.example.com
  DKIM-authenticated Identifier: example.com
  DMARC Policy Record:
    "v=DMARC1; p=reject; aspf=r;
     rua=mailto:dmarc-feedback@example.com"
</pre><a href="#appendix-B.3.1-7" class="pilcrow">¶</a>
</div>
<p id="appendix-B.3.1-8">In the above sample, the SPF-Authenticated Identifier and the
DKIM-Authenticated Identifier both align with the Author Domain. The
Mail Receiver considers the above email to pass the DMARC check, avoiding
the "reject" policy that is requested to be applied to email that fails
the DMARC validation check.<a href="#appendix-B.3.1-8" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-9">If no Authenticated Identifiers align with the Author Domain, then
the Mail Receiver applies the Domain Owner Assessment Policy. However,
before this action is taken, the Mail Receiver can consult external
information to override the Domain Owner Assessment Policy. For example,
if the Mail Receiver knows that this particular email came
from a known and trusted forwarder (that happens to break both SPF
and DKIM), then the Mail Receiver may choose to ignore the Domain
Owner Assessment Policy.<a href="#appendix-B.3.1-9" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-10">The Mail Receiver is now ready to reply to the DATA command. If the
DMARC check yields that the message is to be rejected, then the Mail
Receiver replies with a 5xy code to inform the sender of failure. If
the DMARC check cannot be resolved due to transient network errors,
then the Mail Receiver replies with a 4xy code to inform the sender
as to the need to reattempt delivery later. If the DMARC check
yields a passing message, then the Mail Receiver continues with
email processing, perhaps using the result of the DMARC check as an
input to additional processing modules such as a domain reputation
query.<a href="#appendix-B.3.1-10" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-11">Before exiting DMARC-specific processing, the Mail Receiver checks to
see if the Author Domain DMARC Policy Record requests AFRF-based reporting.
If so, then the Mail Receiver can emit an AFRF to the reporting
address supplied in the DMARC Policy Record.<a href="#appendix-B.3.1-11" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-12">At the exit of DMARC-specific processing, the Mail Receiver captures
(through logging or direct insertion into a data store) the result of
DMARC processing. Captured information is used to build feedback for
Domain Owner consumption. This is unnecessary if the Domain Owner
has not requested aggregate reports, i.e., no "rua" tag was found in
the policy record.<a href="#appendix-B.3.1-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="treewalk-example">
<section id="appendix-B.4">
        <h3 id="name-organizational-and-policy-d">
<a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-organizational-and-policy-d" class="section-name selfRef">Organizational and Policy Domain Tree Walk Examples</a>
        </h3>
<p id="appendix-B.4-1">If an Author Domain has no DMARC Policy Record, a Mail Receiver uses a tree walk
to find the DMARC Policy.<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
<p id="appendix-B.4-2">If the DMARC Policy Record allows relaxed alignment and the SPF- or DKIM-Authenticated
Identifiers are different from the Author Domain, a Mail Receiver uses a tree walk to
discover the respective Organizational Domains to determine Identifier Alignment.<a href="#appendix-B.4-2" class="pilcrow">¶</a></p>
<div id="simple-organizational-and-policy-example">
<section id="appendix-B.4.1">
          <h4 id="name-simple-organizational-and-p">
<a href="#appendix-B.4.1" class="section-number selfRef">B.4.1. </a><a href="#name-simple-organizational-and-p" class="section-name selfRef">Simple Organizational and Policy Example</a>
          </h4>
<p id="appendix-B.4.1-1">A Mail Receiver receives an email with:<a href="#appendix-B.4.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.4.1-2.1">Author Domain: example.com<a href="#appendix-B.4.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-B.4.1-2.2">RFC5321.MailFrom Domain: example.com<a href="#appendix-B.4.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-B.4.1-2.3">DKIM-Authenticated Identifier: signing.example.com<a href="#appendix-B.4.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-B.4.1-3">In this example, "_dmarc.example.com" and "_dmarc.signing.example.com" both
have DMARC Policy Records while "_dmarc.com" does not. If SPF or DKIM yield pass
results, they still have to be aligned to support a DMARC pass. Since
not all domains are the same, if the alignment is relaxed then the tree
walk is performed to determine the Organizational Domain for each.<a href="#appendix-B.4.1-3" class="pilcrow">¶</a></p>
<p id="appendix-B.4.1-4">To determine the Organizational Domain for the Author Domain,
query "_dmarc.example.com" and "_dmarc.com"; "example.com" is the last
element of the DNS tree with a DMARC Policy Record, so it is the Organizational
Domain for "example.com".<a href="#appendix-B.4.1-4" class="pilcrow">¶</a></p>
<p id="appendix-B.4.1-5">For the RFC5321.MailFrom domain, the Organizational Domain already found for
"example.com" is "example.com", so SPF is aligned.<a href="#appendix-B.4.1-5" class="pilcrow">¶</a></p>
<p id="appendix-B.4.1-6">To determine the Organizational Domain for the DKIM-Authenticated Identifier,
query "_dmarc.signing.example.com", "_dmarc.example.com", and "_dmarc.com".
Both "signing.example.com" and "example.com" have DMARC Policy Records,
but "example.com" is the highest element in the tree with a DMARC Policy Record
(it has the fewest labels), so "example.com" is the Organizational Domain. Since
this is also the Organizational Domain for the Author Domain, DKIM is aligned
for relaxed alignment.<a href="#appendix-B.4.1-6" class="pilcrow">¶</a></p>
<p id="appendix-B.4.1-7">Since both SPF and DKIM are aligned, they can be used to determine if the
message has a DMARC pass result. If the result is not pass, then the policy
domain's DMARC Policy Record is used to determine the appropriate policy. In this
case, since the RFC5322.From domain has a DMARC Policy Record, that is the policy
domain.<a href="#appendix-B.4.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deep-tree-walk-example">
<section id="appendix-B.4.2">
          <h4 id="name-deep-tree-walk-example">
<a href="#appendix-B.4.2" class="section-number selfRef">B.4.2. </a><a href="#name-deep-tree-walk-example" class="section-name selfRef">Deep Tree Walk Example</a>
          </h4>
<p id="appendix-B.4.2-1">A Mail Receiver receives an email with:<a href="#appendix-B.4.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.4.2-2.1">Author Domain: a.b.c.d.e.f.g.h.i.j.k.example.com<a href="#appendix-B.4.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-B.4.2-2.2">RFC5321.MailFrom Domain: example.com<a href="#appendix-B.4.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-B.4.2-2.3">DKIM-Authenticated Identifier: signing.example.com<a href="#appendix-B.4.2-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-B.4.2-3">Both "_dmarc.example.com" and "_dmarc.signing.example.com" have DMARC Policy Records,
while "_dmarc.com" does not. If SPF or DKIM yield pass results, they still have
to be aligned to support a DMARC pass. Since not all domains are the same, if
the alignment is relaxed then the tree walk is performed to determine the Organizational
Domain for each.<a href="#appendix-B.4.2-3" class="pilcrow">¶</a></p>
<p id="appendix-B.4.2-4">To determine the Organizational Domain For the Author Domain, query
"_dmarc.a.b.c.d.e.f.g.h.i.j.k.example.com", then query "_dmarc.g.h.i.j.k.example.com" (skipping
the intermediate names), then query "_dmarc.h.i.j.k.example.com",
"_dmarc.i.j.k.example.com", "_dmarc.j.k.example.com", "_dmarc.k.example.com",
"_dmarc.example.com", and "_dmarc.com". None of
"a.b.c.d.e.f.g.h.i.j.k.example.com", "g.h.i.j.k.example.com", "h.i.j.k.example.com",
"i.j.k.example.com", "j.k.example.com", or "k.example.com" have a DMARC Policy Record.<a href="#appendix-B.4.2-4" class="pilcrow">¶</a></p>
<p id="appendix-B.4.2-5">Since "example.com" is the last element of the DNS tree with a DMARC Policy Record,
it is the Organizational Domain for "a.b.c.d.e.f.g.h.i.j.k.example.com".<a href="#appendix-B.4.2-5" class="pilcrow">¶</a></p>
<p id="appendix-B.4.2-6">For the RFC5321.MailFrom domain, the Organizational domain already found
for "example.com" is "example.com". SPF is aligned.<a href="#appendix-B.4.2-6" class="pilcrow">¶</a></p>
<p id="appendix-B.4.2-7">For the DKIM-Authenticated Identifier, query "_dmarc.signing.example.com", "_dmarc.example.com",
and "_dmarc.com". Both "signing.example.com" and "example.com" have DMARC Policy Records,
but "example.com" is the highest element in the tree with a DMARC Policy Record, so
"example.com" is the Organizational Domain. Since this is also the Organizational Domain
for the Author Domain, DKIM is aligned for relaxed alignment.<a href="#appendix-B.4.2-7" class="pilcrow">¶</a></p>
<p id="appendix-B.4.2-8">Since both SPF and DKIM are aligned, they can be used to determine if the
message has a DMARC pass result. If the results for both are not pass, then
the policy domain's DMARC Policy Record is used to determine the appropriate policy.
In this case, the Author Domain does not have a DMARC Policy Record, so the
policy domain is the highest element in the DNS tree with a DMARC Policy Record,
example.com.<a href="#appendix-B.4.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-with-a-psd-dmarc-policy-record">
<section id="appendix-B.4.3">
          <h4 id="name-example-with-a-psd-dmarc-po">
<a href="#appendix-B.4.3" class="section-number selfRef">B.4.3. </a><a href="#name-example-with-a-psd-dmarc-po" class="section-name selfRef">Example with a PSD DMARC Policy Record</a>
          </h4>
<p id="appendix-B.4.3-1">In rare cases, a PSD publishes a DMARC Policy Record with a psd tag, which the tree
walk must take into account.<a href="#appendix-B.4.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.4.3-2">A Mail Receiver receives an email with:<a href="#appendix-B.4.3-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.4.3-3.1">Author Domain: giant.bank.example<a href="#appendix-B.4.3-3.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-B.4.3-3.2">RFC5321.MailFrom Domain: mail.giant.bank.example<a href="#appendix-B.4.3-3.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-B.4.3-3.3">DKIM-Authenticated Identifier: mail.mega.bank.example<a href="#appendix-B.4.3-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-B.4.3-4">In this case, "_dmarc.bank.example" has a DMARC Policy Record which includes the
"psd=y" tag, and "_dmarc.example" does not have a DMARC Policy Record.
While "_dmarc.giant.bank.example" has a DMARC Policy Record without a "psd" tag,
"_dmarc.mega.bank.example" and "_dmarc.mail.mega.bank.example" have no DMARC Policy Records.<a href="#appendix-B.4.3-4" class="pilcrow">¶</a></p>
<p id="appendix-B.4.3-5">Since the three domains are all different, tree walks find their Organizational Domains
to see which are aligned.<a href="#appendix-B.4.3-5" class="pilcrow">¶</a></p>
<p id="appendix-B.4.3-6">For the Author Domain "giant.bank.example", the tree walk finds the DMARC Policy Record
at "_dmarc.giant.bank.example", then the DMARC Policy Record at "_dmarc.bank.example", and
stops because of the "psd=y" flag.  The Organizational Domain is "giant.bank.example" because
it is the domain directly below the one with "psd=y".  Since the Organizational Domain has a
DMARC Policy Record, it is also the policy domain.<a href="#appendix-B.4.3-6" class="pilcrow">¶</a></p>
<p id="appendix-B.4.3-7">For the RFC5321.MailFrom domain "mail.giant.bank.example", the tree walk finds no DMARC Policy
Record at "_dmarc.mail.giant.bank.example", but does find both the DMARC Policy Record at
"_dmarc.giant.bank.example" and then the DMARC Policy Record at "_dmarc.bank.example", and
stops because of the "psd=y" flag.  Again the Organizational Domain is "giant.bank.example" because
it is the domain directly below the one with "psd=y".  Since this is the same Organizational Domain
as the Author Domain, SPF is aligned.<a href="#appendix-B.4.3-7" class="pilcrow">¶</a></p>
<p id="appendix-B.4.3-8">For the DKIM-Authenticated Identifier "mail.mega.bank.example", the tree walk finds no DMARC Policy
Records at "_dmarc.mail.mega.bank.example" or "_dmarc.mega.bank.example", then finds the DMARC
Policy Record at "_dmarc.bank.example" and stops because of the "psd=y" flag.
The Organizational Domain is "mega.bank.example", so DKIM is not aligned.<a href="#appendix-B.4.3-8" class="pilcrow">¶</a></p>
<p id="appendix-B.4.3-9">Since SPF is aligned, it can be used to determine if the message has a DMARC pass result.  If the
result is not pass, then the policy domain's DMARC Policy Record is used to determine the appropriate
policy.<a href="#appendix-B.4.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="utilization-of-aggregate-feedback-example">
<section id="appendix-B.5">
        <h3 id="name-utilization-of-aggregate-fe">
<a href="#appendix-B.5" class="section-number selfRef">B.5. </a><a href="#name-utilization-of-aggregate-fe" class="section-name selfRef">Utilization of Aggregate Feedback: Example</a>
        </h3>
<p id="appendix-B.5-1">Aggregate feedback is consumed by Domain Owners to enable their
understanding of how a given domain is being processed by the Mail
Receiver. Aggregate reporting data on emails that pass all underlying
authentication checks is used by Domain Owners to validate that their
authentication practices remain accurate. For example, if a third party
is sending on behalf of a Domain Owner, the Domain Owner can use aggregate
report data to validate ongoing authentication practices of the third party.<a href="#appendix-B.5-1" class="pilcrow">¶</a></p>
<p id="appendix-B.5-2">Data on email that only partially passes underlying authentication
checks provides visibility into problems that need to be addressed by
the Domain Owner. For example, if either SPF or DKIM fails to produce
an Authenticated Identifier, the Domain Owner is provided with enough
information to either directly correct the problem or understand where
authentication-breaking changes are being introduced in the email
transmission path.  If authentication-breaking changes due to email
transmission path cannot be directly corrected, then the Domain Owner at least
maintains an understanding of the effect of DMARC-based policies upon
the Domain Owner's email.<a href="#appendix-B.5-2" class="pilcrow">¶</a></p>
<p id="appendix-B.5-3">Data on email that fails all underlying authentication checks
provides baseline visibility on how the Domain Owner's domain is
being received at the Mail Receiver. Based on this visibility, the
Domain Owner can begin deployment of authentication technologies
across uncovered email sources, if the mail that is failing the checks
was generated by or on behalf of the Domain Owner. Data regarding
failing authentication checks can also allow the Domain Owner to
come to an understanding of how its domain is being misused.<a href="#appendix-B.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="rfc7849-changes">
<section id="appendix-C">
      <h2 id="name-changes-from-rfc-7489">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-changes-from-rfc-7489" class="section-name selfRef">Changes from RFC 7489</a>
      </h2>
<p id="appendix-C-1">This document is intended to render <span>[<a href="#RFC7489" class="cite xref">RFC7489</a>]</span> obsolete. As one might guess,
that means there are significant differences between RFC 7489 and this
document. This section will summarize those changes.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="informational-vs-standards-track">
<section id="appendix-C.1">
        <h3 id="name-informational-vs-standards-">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-informational-vs-standards-" class="section-name selfRef">Informational vs. Standards Track</a>
        </h3>
<p id="appendix-C.1-1">RFC 7489 was not the product of any IETF work stream, but was instead published into
the RFC series by the Independent Submissions Editor and is classified as an Informational
RFC.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-2">This document, by contrast, is intended to be Internet Standards Track.<a href="#appendix-C.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-to-terminology-and-definitions">
<section id="appendix-C.2">
        <h3 id="name-changes-to-terminology-and-">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-changes-to-terminology-and-" class="section-name selfRef">Changes to Terminology and Definitions</a>
        </h3>
<p id="appendix-C.2-1">The following changes were made to the Terminology and Definitions section.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<div id="terms-added">
<section id="appendix-C.2.1">
          <h4 id="name-terms-added">
<a href="#appendix-C.2.1" class="section-number selfRef">C.2.1. </a><a href="#name-terms-added" class="section-name selfRef">Terms Added</a>
          </h4>
<p id="appendix-C.2.1-1">These terms were added:<a href="#appendix-C.2.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C.2.1-2.1">Domain Owner Assessment Policy<a href="#appendix-C.2.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-C.2.1-2.2">Enforcement<a href="#appendix-C.2.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-C.2.1-2.3">Monitoring Mode<a href="#appendix-C.2.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-C.2.1-2.4">Non-existent Domains<a href="#appendix-C.2.1-2.4" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-C.2.1-2.5">Public Suffix Domain (PSD)<a href="#appendix-C.2.1-2.5" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-C.2.1-2.6">Public Suffix Operator (PSO)<a href="#appendix-C.2.1-2.6" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-C.2.1-2.7">PSO Controlled Domain Names<a href="#appendix-C.2.1-2.7" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="definitions-updated">
<section id="appendix-C.2.2">
          <h4 id="name-definitions-updated">
<a href="#appendix-C.2.2" class="section-number selfRef">C.2.2. </a><a href="#name-definitions-updated" class="section-name selfRef">Definitions Updated</a>
          </h4>
<p id="appendix-C.2.2-1">These definitions were updated:<a href="#appendix-C.2.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-C.2.2-2.1">Organizational Domain<a href="#appendix-C.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-C.2.2-2.2">Report Receiver (renamed to Report Consumer)<a href="#appendix-C.2.2-2.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="policy-determination">
<section id="appendix-C.3">
        <h3 id="name-policy-discovery-and-organi">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-policy-discovery-and-organi" class="section-name selfRef">Policy Discovery and Organizational Domain Determination</a>
        </h3>
<p id="appendix-C.3-1">The algorithms for DMARC policy discovery and for determining the Organizational Domain
have been changed. Specifically, reliance on a Public Suffix List (PSL) has been replaced
by a technique called a "DNS Tree Walk", and the methodology for the DNS Tree Walk is explained
in detail in this document.<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
<p id="appendix-C.3-2">The DNS Tree Walk also incorporates PSD policy discovery, which was introduced in
<span>[<a href="#RFC9091" class="cite xref">RFC9091</a>]</span>. That RFC was an Experimental RFC, and the results of that experiment were
that the RFC was not implemented as written. Instead, this document redefines the
algorithm for PSD policy discovery, and thus obsoletes <span>[<a href="#RFC9091" class="cite xref">RFC9091</a>]</span>. Specifically, the
DNS Tree Walk defined in this document obviates the need for a PSD DMARC registry,
and that PSD DMARC registry is what made RFC 9091 an Experimental RFC.<a href="#appendix-C.3-2" class="pilcrow">¶</a></p>
<p id="appendix-C.3-3">These algorithm changes introduce the possibility of interoperability issues where a
Domain Owner expects a DMARC Policy Record or an Organizational Domain to be identified by
the Tree Walk process, but a Mail Receiver using an RFC 7489-based implementation of
DMARC and relying on a PSL might arrive at a different answer.<a href="#appendix-C.3-3" class="pilcrow">¶</a></p>
<p id="appendix-C.3-4">This issue is entirely avoided by the use of Strict Alignment and publishing explicit
DMARC Policy Records for all Author Domains used in an organization's email.<a href="#appendix-C.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reporting">
<section id="appendix-C.4">
        <h3 id="name-reporting">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-reporting" class="section-name selfRef">Reporting</a>
        </h3>
<p id="appendix-C.4-1">Discussion of both aggregate and failure reporting have been moved to separate documents
dedicated to the topics.<a href="#appendix-C.4-1" class="pilcrow">¶</a></p>
<p id="appendix-C.4-2">In addition, the ability to specify a maximum report size in the DMARC URI has been removed.<a href="#appendix-C.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tags">
<section id="appendix-C.5">
        <h3 id="name-tags">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-tags" class="section-name selfRef">Tags</a>
        </h3>
<p id="appendix-C.5-1">Several tags have been added to the "DMARC Policy Record Format" section of this document since
RFC 7489 was published, and at the same time, several others were removed.<a href="#appendix-C.5-1" class="pilcrow">¶</a></p>
<div id="tags-added">
<section id="appendix-C.5.1">
          <h4 id="name-tags-added">
<a href="#appendix-C.5.1" class="section-number selfRef">C.5.1. </a><a href="#name-tags-added" class="section-name selfRef">Tags Added</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-C.5.1-1.1">np - Policy for non-existent domains (Imported from <span>[<a href="#RFC9091" class="cite xref">RFC9091</a>]</span>)<a href="#appendix-C.5.1-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-C.5.1-1.2">psd - Flag indicating whether a domain is a Public Suffix Domain<a href="#appendix-C.5.1-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-C.5.1-1.3">t - Replacement for some pct tag functionality. See <a href="#removal-of-the-pct-tag" class="auto internal xref">Appendix A.6</a> for further discussion<a href="#appendix-C.5.1-1.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="tags-removed">
<section id="appendix-C.5.2">
          <h4 id="name-tags-removed">
<a href="#appendix-C.5.2" class="section-number selfRef">C.5.2. </a><a href="#name-tags-removed" class="section-name selfRef">Tags Removed</a>
          </h4>
<ul class="compact">
<li class="compact" id="appendix-C.5.2-1.1">pct - Tag requesting application of DMARC policy to only a percentage of messages. See <a href="#removal-of-the-pct-tag" class="auto internal xref">Appendix A.6</a> for discussion<a href="#appendix-C.5.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-C.5.2-1.2">rf - Tag specifying requested format of failure reports<a href="#appendix-C.5.2-1.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="appendix-C.5.2-1.3">ri - Tag specifying requested interval between aggregate reports<a href="#appendix-C.5.2-1.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="expansion-of-domain-owner-actions-section">
<section id="appendix-C.6">
        <h3 id="name-expansion-of-domain-owner-a">
<a href="#appendix-C.6" class="section-number selfRef">C.6. </a><a href="#name-expansion-of-domain-owner-a" class="section-name selfRef">Expansion of Domain Owner Actions Section</a>
        </h3>
<p id="appendix-C.6-1">RFC 7489 had just two paragraphs in its Domain Owner Actions section, and while
the content of those paragraphs was correct, it was minimalist in its approach to
providing guidance to domain owners on just how to implement DMARC.<a href="#appendix-C.6-1" class="pilcrow">¶</a></p>
<p id="appendix-C.6-2">This document provides much more detail and explanatory text to a Domain Owner,
focusing not just on what to do to implement DMARC, but also on the reasons for
each step and the repercussions of each decision.<a href="#appendix-C.6-2" class="pilcrow">¶</a></p>
<p id="appendix-C.6-3">In particular, this document makes explicit that domains for general-purpose
email <span class="bcp14">SHOULD NOT</span> deploy a DMARC policy of p=reject. See <a href="#interoperability-considerations" class="auto internal xref">Section 7.4</a>
for further discussion of this topic.<a href="#appendix-C.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="report-generator-recommendations">
<section id="appendix-C.7">
        <h3 id="name-report-generator-recommenda">
<a href="#appendix-C.7" class="section-number selfRef">C.7. </a><a href="#name-report-generator-recommenda" class="section-name selfRef">Report Generator Recommendations</a>
        </h3>
<p id="appendix-C.7-1">In the cases where a DMARC Policy Record specifies multiple destinations for either aggregate
reports or failure reports, RFC 7489 stated:<a href="#appendix-C.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.7-2">
<pre>  Receivers **MAY** impose a limit on the number of URIs to which they
  will send reports but **MUST** support the ability to send to at least
  two.
</pre><a href="#appendix-C.7-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.7-3">This document in <a href="#dmarc-uris" class="auto internal xref">Section 4.6</a> says:<a href="#appendix-C.7-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.7-4">
<pre>  A report **SHOULD** be sent to each listed URI provided in the DMARC
  Policy Record.
</pre><a href="#appendix-C.7-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="removal-of-rfc-7489-appendix-a-5">
<section id="appendix-C.8">
        <h3 id="name-removal-of-rfc-7489-appendi">
<a href="#appendix-C.8" class="section-number selfRef">C.8. </a><a href="#name-removal-of-rfc-7489-appendi" class="section-name selfRef">Removal of RFC 7489 Appendix A.5</a>
        </h3>
<p id="appendix-C.8-1">One of the appendices in RFC 7489, specifically <a href="https://rfc-editor.org/rfc/rfc7489#appendix-Appendix%20A.5" class="relref">Appendix A.5</a>,
has been removed from the text with this update. The appendix was titled
"Issues with ADSP in Operation" and it contained a list of issues associated
with ADSP that influenced the direction of DMARC. The ADSP protocol was moved
to "Historic" status in 2013 and working group consensus was that such a
discussion of ADSP's influence on DMARC was no longer relevant.<a href="#appendix-C.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-7489-errata-summary">
<section id="appendix-C.9">
        <h3 id="name-rfc-7489-errata-summary">
<a href="#appendix-C.9" class="section-number selfRef">C.9. </a><a href="#name-rfc-7489-errata-summary" class="section-name selfRef">RFC 7489 Errata Summary</a>
        </h3>
<p id="appendix-C.9-1">This document and its companion documents (<span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>
and <span>[<a href="#I-D.ietf-dmarc-failure-reporting" class="cite xref">I-D.ietf-dmarc-failure-reporting</a>]</span>) address the following errata
filed against <span>[<a href="#RFC7489" class="cite xref">RFC7489</a>]</span> since that document's publication in March,
2015.  More details on each of these can be found at
<a href="https://www.rfc-editor.org/errata_search.php?rfc=7489">https://www.rfc-editor.org/errata_search.php?rfc=7489</a><a href="#appendix-C.9-1" class="pilcrow">¶</a></p>
<div id="rfc-errata-erratum-id-5365-rfc-7489-section-7-2-1-1-https-www-rfc-editor-org-errata-eid5365">
<section id="appendix-C.9.1">
          <h4 id="name-rfc-errata-erratum-id-5365-">
<a href="#appendix-C.9.1" class="section-number selfRef">C.9.1. </a><a href="#name-rfc-errata-erratum-id-5365-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid5365">RFC Errata, Erratum ID 5365, RFC 7489, Section 7.2.1.1</a></a>
          </h4>
<p id="appendix-C.9.1-1">Addressed in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#appendix-C.9.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-5371-rfc-7489-section-7-2-1-1-https-www-rfc-editor-org-errata-eid5371">
<section id="appendix-C.9.2">
          <h4 id="name-rfc-errata-erratum-id-5371-">
<a href="#appendix-C.9.2" class="section-number selfRef">C.9.2. </a><a href="#name-rfc-errata-erratum-id-5371-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid5371">RFC Errata, Erratum ID 5371, RFC 7489, Section 7.2.1.1</a></a>
          </h4>
<p id="appendix-C.9.2-1">Addressed in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#appendix-C.9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-5440-rfc-7489-sections-7-1-b-2-1-b-2-3-and-b-2-4-https-www-rfc-editor-org-errata-eid5440">
<section id="appendix-C.9.3">
          <h4 id="name-rfc-errata-erratum-id-5440-">
<a href="#appendix-C.9.3" class="section-number selfRef">C.9.3. </a><a href="#name-rfc-errata-erratum-id-5440-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid5440">RFC Errata, Erratum ID 5440, RFC 7489, Sections 7.1, B.2.1, B.2.3, and B.2.4</a></a>
          </h4>
<p id="appendix-C.9.3-1">This erratum references several mentions in RFC 7489 of the "v=" tag from the Domain Owner Assessment
Policy and/or its value, specifically mentions that were not, but should have been, "v=DMARC1;". Some
of those mentions are preserved in this document and those mentions have been addressed as per the
erratum. The rest have moved to <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span> and are addressed there.<a href="#appendix-C.9.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-6439-rfc-7489-section-7-1-https-www-rfc-editor-org-errata-eid6439">
<section id="appendix-C.9.4">
          <h4 id="name-rfc-errata-erratum-id-6439-">
<a href="#appendix-C.9.4" class="section-number selfRef">C.9.4. </a><a href="#name-rfc-errata-erratum-id-6439-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid6439">RFC Errata, Erratum ID 6439, RFC 7489, Section 7.1</a></a>
          </h4>
<p id="appendix-C.9.4-1">Addressed in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#appendix-C.9.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-5221-rfc-7489-appendix-c-https-www-rfc-editor-org-errata-eid5221">
<section id="appendix-C.9.5">
          <h4 id="name-rfc-errata-erratum-id-5221-">
<a href="#appendix-C.9.5" class="section-number selfRef">C.9.5. </a><a href="#name-rfc-errata-erratum-id-5221-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid5221">RFC Errata, Erratum ID 5221, RFC 7489, Appendix C</a></a>
          </h4>
<p id="appendix-C.9.5-1">The regular expression pattern for IP addresses has been removed from this document and from
<span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#appendix-C.9.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-5229-rfc-7489-appendix-c-https-www-rfc-editor-org-errata-eid5229">
<section id="appendix-C.9.6">
          <h4 id="name-rfc-errata-erratum-id-5229-">
<a href="#appendix-C.9.6" class="section-number selfRef">C.9.6. </a><a href="#name-rfc-errata-erratum-id-5229-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid5229">RFC Errata, Erratum ID 5229, RFC 7489, Appendix C</a></a>
          </h4>
<p id="appendix-C.9.6-1">Addressed in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#appendix-C.9.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-5495-rfc-7489-section-6-6-3-https-www-rfc-editor-org-errata-eid5495">
<section id="appendix-C.9.7">
          <h4 id="name-rfc-errata-erratum-5495-rfc">
<a href="#appendix-C.9.7" class="section-number selfRef">C.9.7. </a><a href="#name-rfc-errata-erratum-5495-rfc" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid5495">RFC Errata, Erratum 5495, RFC 7489, Section 6.6.3</a></a>
          </h4>
<p id="appendix-C.9.7-1">This erratum is in reference to the description of the process documented
in RFC 7489 for the applicable DMARC policy for an email message. The process
for doing this has drastically changed in DMARCbis, and so the text identified in
this erratum no longer exists.<a href="#appendix-C.9.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-6485-rfc-7489-section-7-2-1-1-https-www-rfc-editor-org-errata-eid6485">
<section id="appendix-C.9.8">
          <h4 id="name-rfc-errata-erratum-id-6485-">
<a href="#appendix-C.9.8" class="section-number selfRef">C.9.8. </a><a href="#name-rfc-errata-erratum-id-6485-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid6485">RFC Errata, Erratum ID 6485, RFC 7489, Section 7.2.1.1</a></a>
          </h4>
<p id="appendix-C.9.8-1">Addressed in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#appendix-C.9.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-6729-rfc-7489-section-3-2-https-www-rfc-editor-org-errata-eid6729">
<section id="appendix-C.9.9">
          <h4 id="name-rfc-errata-erratum-id-6729-">
<a href="#appendix-C.9.9" class="section-number selfRef">C.9.9. </a><a href="#name-rfc-errata-erratum-id-6729-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid6729">RFC Errata, Erratum ID 6729, RFC 7489, Section 3.2</a></a>
          </h4>
<p id="appendix-C.9.9-1">This erratum is in reference to a search of the Public Suffix List (PSL) as part of finding a DMARC
Policy Record (a.k.a., Domain Owner Assessment Policy). The PSL is no longer relied upon for this
practice, and the text at issue has been removed from this document.<a href="#appendix-C.9.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-7099-rfc-7489-section-7-2-1-1-https-www-rfc-editor-org-errata-eid7099">
<section id="appendix-C.9.10">
          <h4 id="name-rfc-errata-erratum-id-7099-">
<a href="#appendix-C.9.10" class="section-number selfRef">C.9.10. </a><a href="#name-rfc-errata-erratum-id-7099-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid7099">RFC Errata, Erratum ID 7099, RFC 7489, Section 7.2.1.1</a></a>
          </h4>
<p id="appendix-C.9.10-1">Addressed in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#appendix-C.9.10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-7100-rfc-7489-section-7-2-1-1-https-www-rfc-editor-org-errata-eid7100">
<section id="appendix-C.9.11">
          <h4 id="name-rfc-errata-erratum-id-7100-">
<a href="#appendix-C.9.11" class="section-number selfRef">C.9.11. </a><a href="#name-rfc-errata-erratum-id-7100-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid7100">RFC Errata, Erratum ID 7100, RFC 7489, Section 7.2.1.1</a></a>
          </h4>
<p id="appendix-C.9.11-1">Addressed in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#appendix-C.9.11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-7835-rfc-7489-section-6-6-3-https-www-rfc-editor-org-errata-eid7835">
<section id="appendix-C.9.12">
          <h4 id="name-rfc-errata-erratum-id-7835-">
<a href="#appendix-C.9.12" class="section-number selfRef">C.9.12. </a><a href="#name-rfc-errata-erratum-id-7835-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid7835">RFC Errata, Erratum ID 7835, RFC 7489, Section 6.6.3</a></a>
          </h4>
<p id="appendix-C.9.12-1">This erratum is in reference to the description of the process documented
in RFC 7489 for the applicable DMARC policy for an email message. The process
for doing this has drastically changed in DMARCbis, and so the text identified in
this erratum no longer exists.<a href="#appendix-C.9.12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-7865-rfc-7489-appendix-c-https-www-rfc-editor-org-errata-eid7865">
<section id="appendix-C.9.13">
          <h4 id="name-rfc-errata-erratum-id-7865-">
<a href="#appendix-C.9.13" class="section-number selfRef">C.9.13. </a><a href="#name-rfc-errata-erratum-id-7865-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid7865">RFC Errata, Erratum ID 7865, RFC 7489, Appendix C</a></a>
          </h4>
<p id="appendix-C.9.13-1">The regular expression pattern for IP addresses has been removed from this document and from
<span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#appendix-C.9.13-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-5151-rfc-7489-section-1-https-www-rfc-editor-org-errata-eid5151">
<section id="appendix-C.9.14">
          <h4 id="name-rfc-errata-erratum-id-5151-">
<a href="#appendix-C.9.14" class="section-number selfRef">C.9.14. </a><a href="#name-rfc-errata-erratum-id-5151-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid5151">RFC Errata, Erratum ID 5151, RFC 7489, Section 1</a></a>
          </h4>
<p id="appendix-C.9.14-1">This erratum is in reference to the Introduction section of RFC 7489.
That section has been substantially rewritten in DMARCbis, and the text
at issue for this erratum no longer exists.<a href="#appendix-C.9.14-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-errata-erratum-id-5774-rfc-7489-appendix-c-https-www-rfc-editor-org-errata-eid5774">
<section id="appendix-C.9.15">
          <h4 id="name-rfc-errata-erratum-id-5774-">
<a href="#appendix-C.9.15" class="section-number selfRef">C.9.15. </a><a href="#name-rfc-errata-erratum-id-5774-" class="section-name selfRef"><a href="https://www.rfc-editor.org/errata/eid5774">RFC Errata, Erratum ID 5774, RFC 7489, Appendix C</a></a>
          </h4>
<p id="appendix-C.9.15-1">Addressed in <span>[<a href="#I-D.ietf-dmarc-aggregate-reporting" class="cite xref">I-D.ietf-dmarc-aggregate-reporting</a>]</span>.<a href="#appendix-C.9.15-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="general-editing-and-formatting">
<section id="appendix-C.10">
        <h3 id="name-general-editing-and-formatt">
<a href="#appendix-C.10" class="section-number selfRef">C.10. </a><a href="#name-general-editing-and-formatt" class="section-name selfRef">General Editing and Formatting</a>
        </h3>
<p id="appendix-C.10-1">A great deal of the content from RFC 7489 was preserved in this document, but much
of it was subject to either minor editing, re-ordering of sections, and/or both.<a href="#appendix-C.10-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-D">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-D-1">This reworking of the DMARC mechanism specified in <span>[<a href="#RFC7489" class="cite xref">RFC7489</a>]</span> is the
result of contributions from many participants in the IETF Working Group
dedicated to this effort. Although the contributors are too numerous to
mention, significant contributions were made by Kurt Andersen, Laura Atkins,
Seth Blank, Alex Brotman, Dave Crocker, Douglas E. Foster, Ned Freed,
Mike Hammer, Steven M. Jones, Scott Kitterman, Murray S. Kucherawy,
Barry Leiba, Alessandro Vesely, and Tim Wicinski.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">The authors and contributors also recognize that this document would not
have been possible without the work done by those who had a hand in producing
<span>[<a href="#RFC7489" class="cite xref">RFC7489</a>]</span>. The Acknowledgements section from that document is preserved
in full below.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements-rfc7489">
<section id="appendix-E">
      <h2 id="name-acknowledgements-rfc-7489">
<a href="#name-acknowledgements-rfc-7489" class="section-name selfRef">Acknowledgements - RFC 7489</a>
      </h2>
<p id="appendix-E-1">DMARC and the draft version of this document submitted to the
Independent Submission Editor were the result of lengthy efforts by
an informal industry consortium: DMARC.org (see <a href="https://dmarc.org">https://dmarc.org</a>).
Participating companies included Agari, American Greetings, AOL, Bank
of America, Cloudmark, Comcast, Facebook, Fidelity Investments,
Google, JPMorgan Chase &amp; Company, LinkedIn, Microsoft, Netease,
PayPal, ReturnPath, The Trusted Domain Project, and Yahoo!.  Although
the contributors and supporters are too numerous to mention, notable
individual contributions were made by J. Trent Adams, Michael Adkins,
Monica Chew, Dave Crocker, Tim Draegen, Steve Jones, Franck Martin,
Brett McDowell, and Paul Midgen. The contributors would also like to
recognize the invaluable input and guidance that was provided early
on by J.D. Falk.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">Additional contributions within the IETF context were made by Kurt
Andersen, Michael Jack Assels, Les Barstow, Anne Bennett, Jim Fenton,
J. Gomez, Mike Jones, Scott Kitterman, Eliot Lear, John Levine,
S. Moonesamy, Rolf Sonneveld, Henry Timmes, and Stephen J. Turnbull.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-F">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Todd M. Herr</span></div>
<div dir="auto" class="left"><span class="org">Valimail</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:todd@someguyinva.com" class="email">todd@someguyinva.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Levine</span></div>
<div dir="auto" class="left"><span class="org">Standcore LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:standards@standcore.com" class="email">standards@standcore.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
